[0m10:58:20.912166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57EF5E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57EF5E1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57EF5DBE0>]}


============================== 10:58:20.928303 | 8fc9274d-3ed0-4501-bb67-8633ac6069f8 ==============================
[0m10:58:20.928303 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:58:20.944119 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:58:20.944119 [info ] [MainThread]: dbt version: 1.7.4
[0m10:58:20.944119 [info ] [MainThread]: python version: 3.12.9
[0m10:58:20.944119 [info ] [MainThread]: python path: c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Scripts\python.exe
[0m10:58:20.944119 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:58:25.264468 [info ] [MainThread]: Using profiles dir at C:\Users\ChandravelMK\.dbt
[0m10:58:25.264468 [info ] [MainThread]: Using profiles.yml file at C:\Users\ChandravelMK\.dbt\profiles.yml
[0m10:58:25.264468 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\ChandravelMK\Desktop\dbt_training\data_engineering_project\dbt_project.yml
[0m10:58:25.274359 [info ] [MainThread]: adapter type: snowflake
[0m10:58:25.274359 [info ] [MainThread]: adapter version: 1.7.1
[0m10:58:25.426463 [info ] [MainThread]: Configuration:
[0m10:58:25.428237 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:58:25.428237 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:58:25.428237 [info ] [MainThread]: Required dependencies:
[0m10:58:25.428237 [debug] [MainThread]: Executing "git --help"
[0m10:58:25.531731 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:58:25.532730 [debug] [MainThread]: STDERR: "b''"
[0m10:58:25.533731 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:58:25.533731 [info ] [MainThread]: Connection:
[0m10:58:25.535824 [info ] [MainThread]:   account: LLGSNOX-MQ85624
[0m10:58:25.537061 [info ] [MainThread]:   user: chandrustart
[0m10:58:25.539060 [info ] [MainThread]:   database: NEWDB
[0m10:58:25.542060 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:58:25.544577 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:58:25.545587 [info ] [MainThread]:   schema: DESCHEMA
[0m10:58:25.546586 [info ] [MainThread]:   authenticator: None
[0m10:58:25.547588 [info ] [MainThread]:   private_key_path: None
[0m10:58:25.548587 [info ] [MainThread]:   token: None
[0m10:58:25.549589 [info ] [MainThread]:   oauth_client_id: None
[0m10:58:25.549892 [info ] [MainThread]:   query_tag: None
[0m10:58:25.551618 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:58:25.552459 [info ] [MainThread]:   host: None
[0m10:58:25.553470 [info ] [MainThread]:   port: None
[0m10:58:25.558024 [info ] [MainThread]:   proxy_host: None
[0m10:58:25.559019 [info ] [MainThread]:   proxy_port: None
[0m10:58:25.560013 [info ] [MainThread]:   protocol: None
[0m10:58:25.561014 [info ] [MainThread]:   connect_retries: 1
[0m10:58:25.562018 [info ] [MainThread]:   connect_timeout: None
[0m10:58:25.563013 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:58:25.564524 [info ] [MainThread]:   retry_all: False
[0m10:58:25.568548 [info ] [MainThread]:   insecure_mode: False
[0m10:58:25.570547 [info ] [MainThread]:   reuse_connections: None
[0m10:58:25.574780 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:58:25.576789 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:58:25.578798 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:58:25.578798 [debug] [MainThread]: On debug: select 1 as id
[0m10:58:25.579798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:28.306611 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:58:28.308403 [debug] [MainThread]: On debug: Close
[0m10:58:28.401416 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:58:28.402382 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:58:28.404382 [debug] [MainThread]: Command `dbt debug` succeeded at 10:58:28.403382 after 7.58 seconds
[0m10:58:28.404890 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:58:28.404890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57E906AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57F7C9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57F8935C0>]}
[0m10:58:28.405899 [debug] [MainThread]: Flushing usage events
[0m12:13:09.336492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3CEF6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3CEF7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3CEF5430>]}


============================== 12:13:09.352358 | 87fb2448-5ed8-4908-aaf2-9aa252d1bbd5 ==============================
[0m12:13:09.352358 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:13:09.352358 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:13:13.282935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3E721FA0>]}
[0m12:13:13.399403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3CBD1EE0>]}
[0m12:13:13.401152 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:13:13.438169 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:13:13.440155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:13:13.440155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3E795190>]}
[0m12:13:16.206605 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\schema.yml'
[0m12:13:16.206605 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\schema.yml'
[0m12:13:16.438941 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.unique_my_first_dbt_model_id.16e066b321' (models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m12:13:16.438941 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.not_null_my_first_dbt_model_id.5fb22c2710' (models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m12:13:16.438941 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.unique_my_second_dbt_model_id.57a0f8c493' (models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m12:13:16.438941 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.not_null_my_second_dbt_model_id.151b76d778' (models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m12:13:16.484623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3CEF4560>]}
[0m12:13:16.531230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3EA50110>]}
[0m12:13:16.532233 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:13:16.533194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3EA28FB0>]}
[0m12:13:16.535237 [info ] [MainThread]: 
[0m12:13:16.536231 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:16.538240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:13:16.549743 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:13:16.549743 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:13:16.549743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:17.606095 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:13:17.622034 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:13:17.716105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NEWDB, now create_NEWDB_DESCHEMA_staging)
[0m12:13:17.718129 [debug] [ThreadPool]: Creating schema "database: "NEWDB"
schema: "DESCHEMA_staging"
"
[0m12:13:17.734007 [debug] [ThreadPool]: Using snowflake connection "create_NEWDB_DESCHEMA_staging"
[0m12:13:17.734007 [debug] [ThreadPool]: On create_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "create_NEWDB_DESCHEMA_staging"} */
create schema if not exists NEWDB.DESCHEMA_staging
[0m12:13:17.734007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:18.041862 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:13:18.045179 [debug] [ThreadPool]: On create_NEWDB_DESCHEMA_staging: Close
[0m12:13:18.128602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:13:18.147292 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:13:18.147292 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:13:18.147292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:18.451153 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:13:18.453691 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:13:18.547246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3EA50D10>]}
[0m12:13:18.547246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:18.547246 [info ] [MainThread]: 
[0m12:13:18.589696 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:13:18.590694 [info ] [Thread-1 (]: 1 of 1 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:13:18.591694 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:13:18.592695 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:13:18.613225 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:13:18.619200 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:13:18.596697 => 12:13:18.618197
[0m12:13:18.619200 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:13:18.667221 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:13:18.671220 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:13:18.672220 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select 
    customer_id::INTEGER as customer_id,
    customer_name::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
)
select * from customer
  );
[0m12:13:18.673220 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:19.310898 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff33-0001-429e-0008-4d960001af8e
[0m12:13:19.310898 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'CUSTOMER_NAME'
[0m12:13:19.310898 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:13:18.620195 => 12:13:19.310898
[0m12:13:19.310898 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:13:19.402250 [debug] [Thread-1 (]: Database Error in model stg_cust (models\staging\stg_cust.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled Code at target\run\data_engineering_project\models\staging\stg_cust.sql
[0m12:13:19.402250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87fb2448-5ed8-4908-aaf2-9aa252d1bbd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3EE5D5B0>]}
[0m12:13:19.404257 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DESCHEMA_staging.stg_cust ................. [[31mERROR[0m in 0.81s]
[0m12:13:19.404257 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:13:19.408850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:19.408850 [debug] [MainThread]: Connection 'create_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:13:19.408850 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:13:19.408850 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:13:19.410860 [info ] [MainThread]: 
[0m12:13:19.410860 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m12:13:19.412958 [debug] [MainThread]: Command end result
[0m12:13:19.428691 [info ] [MainThread]: 
[0m12:13:19.430706 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:19.432691 [info ] [MainThread]: 
[0m12:13:19.433702 [error] [MainThread]:   Database Error in model stg_cust (models\staging\stg_cust.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled Code at target\run\data_engineering_project\models\staging\stg_cust.sql
[0m12:13:19.434701 [info ] [MainThread]: 
[0m12:13:19.434701 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:13:19.436702 [debug] [MainThread]: Command `dbt run` failed at 12:13:19.436702 after 10.22 seconds
[0m12:13:19.438056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3CD97C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3BBB5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3C6EAB40>]}
[0m12:13:19.438056 [debug] [MainThread]: Flushing usage events
[0m12:14:31.766849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31FE5DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31FE5DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31FE5D7F0>]}


============================== 12:14:31.766849 | a84d042f-5711-47b7-b37f-1717307b922b ==============================
[0m12:14:31.766849 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:14:31.766849 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:14:32.300548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31F865F10>]}
[0m12:14:32.411783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C320456060>]}
[0m12:14:32.411783 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:14:32.427801 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:14:32.574444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:32.575449 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_cust.sql
[0m12:14:32.758082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C320652480>]}
[0m12:14:32.772633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3207C0830>]}
[0m12:14:32.773668 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:14:32.774632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C32093FB00>]}
[0m12:14:32.776634 [info ] [MainThread]: 
[0m12:14:32.777525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:32.779534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:14:32.797020 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:14:32.798021 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:14:32.798021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:33.690359 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:14:33.690359 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:14:33.794602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:14:33.823131 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:14:33.823131 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:14:33.824131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:34.249249 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:14:34.249249 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:14:34.356134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C320AC4E90>]}
[0m12:14:34.360061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:34.361076 [info ] [MainThread]: 
[0m12:14:34.367613 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:14:34.367613 [info ] [Thread-1 (]: 1 of 1 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:14:34.369586 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:14:34.370337 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:14:34.379433 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:14:34.381400 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:14:34.370337 => 12:14:34.381400
[0m12:14:34.382400 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:14:34.422107 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:14:34.422107 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:14:34.422107 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select 
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
)
select * from customer
  );
[0m12:14:34.422107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:14:34.844487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:14:34.877214 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:14:34.382400 => 12:14:34.877214
[0m12:14:34.877214 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:14:34.963725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84d042f-5711-47b7-b37f-1717307b922b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C320B5C620>]}
[0m12:14:34.963725 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.59s]
[0m12:14:34.965731 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:14:34.965731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:34.965731 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:14:34.969083 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:14:34.969083 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:14:34.969083 [info ] [MainThread]: 
[0m12:14:34.969083 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m12:14:34.972596 [debug] [MainThread]: Command end result
[0m12:14:34.987426 [info ] [MainThread]: 
[0m12:14:34.989462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:34.990426 [info ] [MainThread]: 
[0m12:14:34.991426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:34.992425 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:34.992425 after 3.30 seconds
[0m12:14:34.993935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31FBE6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31FE5EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31FE5DC40>]}
[0m12:14:34.993935 [debug] [MainThread]: Flushing usage events
[0m12:18:58.433645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A483E651C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A483E65490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A483E66C60>]}


============================== 12:18:58.443756 | aaa75ef7-2537-4c4f-8ecf-231aa5604c30 ==============================
[0m12:18:58.443756 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:18:58.447156 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:18:59.204517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4844E66F0>]}
[0m12:18:59.317566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4844A7440>]}
[0m12:18:59.317566 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:18:59.335855 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:18:59.497153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:59.497153 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_cust.sql
[0m12:18:59.695760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4846C8500>]}
[0m12:18:59.705392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A484777E30>]}
[0m12:18:59.705392 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:18:59.705392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4848F9F70>]}
[0m12:18:59.705392 [info ] [MainThread]: 
[0m12:18:59.719334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:59.719334 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:18:59.740114 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:18:59.740114 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:18:59.741169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:00.704062 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:19:00.709092 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:19:00.807213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:19:00.810789 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:19:00.810789 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:19:00.810789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:01.337502 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:01.337502 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:19:01.425941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A483E9AFC0>]}
[0m12:19:01.425941 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:01.425941 [info ] [MainThread]: 
[0m12:19:01.441639 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:19:01.454615 [info ] [Thread-1 (]: 1 of 1 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:19:01.457529 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:19:01.459547 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:19:01.471360 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:19:01.473372 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:19:01.459547 => 12:19:01.471360
[0m12:19:01.473372 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:19:01.508518 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:19:01.523387 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:19:01.523387 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
)
select * from customer
  );
[0m12:19:01.523387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:01.925872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:19:01.957297 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:19:01.475384 => 12:19:01.957297
[0m12:19:01.957297 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:19:02.074517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa75ef7-2537-4c4f-8ecf-231aa5604c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A484B9FE30>]}
[0m12:19:02.074517 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.62s]
[0m12:19:02.074517 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:19:02.096441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:02.098451 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:19:02.098451 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:19:02.098451 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:19:02.098451 [info ] [MainThread]: 
[0m12:19:02.100202 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m12:19:02.100202 [debug] [MainThread]: Command end result
[0m12:19:02.123788 [info ] [MainThread]: 
[0m12:19:02.128157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:02.131859 [info ] [MainThread]: 
[0m12:19:02.133868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:19:02.133868 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:02.133868 after 3.79 seconds
[0m12:19:02.133868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4848C2DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A484BBFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4848F8980>]}
[0m12:19:02.138096 [debug] [MainThread]: Flushing usage events
[0m12:22:27.015582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD8A96060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD8A95760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD8A947D0>]}


============================== 12:22:27.021618 | c20da148-4334-4bf8-8104-fcb7ee04694a ==============================
[0m12:22:27.021618 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:22:27.022584 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:22:27.576695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD9181AC0>]}
[0m12:22:27.691653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD90E6E10>]}
[0m12:22:27.691653 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:22:27.708477 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:22:27.863483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:27.863483 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_cust.sql
[0m12:22:28.034348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD95D9D00>]}
[0m12:22:28.060520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD936FD70>]}
[0m12:22:28.061539 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:22:28.062506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD9516690>]}
[0m12:22:28.064513 [info ] [MainThread]: 
[0m12:22:28.065513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:22:28.067203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:22:28.081901 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:22:28.081901 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:22:28.081901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:29.079705 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:22:29.079705 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:22:29.176123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:22:29.179885 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:22:29.179885 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:22:29.179885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:29.636603 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:22:29.636603 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:22:29.756160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD95DEFC0>]}
[0m12:22:29.756160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:22:29.756160 [info ] [MainThread]: 
[0m12:22:29.756160 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:22:29.756160 [info ] [Thread-1 (]: 1 of 1 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:22:29.756160 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:22:29.756160 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:22:29.781095 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:22:29.784313 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:22:29.756160 => 12:22:29.783305
[0m12:22:29.784313 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:22:29.827565 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:22:29.827565 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:22:29.827565 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:22:29.827565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:22:30.240451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:22:30.272401 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:22:29.785349 => 12:22:30.272401
[0m12:22:30.281119 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:22:30.361158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20da148-4334-4bf8-8104-fcb7ee04694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD979DD90>]}
[0m12:22:30.376302 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.60s]
[0m12:22:30.377967 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:22:30.381423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:30.381423 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:22:30.381423 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:22:30.381423 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:22:30.381423 [info ] [MainThread]: 
[0m12:22:30.381423 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m12:22:30.387440 [debug] [MainThread]: Command end result
[0m12:22:30.405503 [info ] [MainThread]: 
[0m12:22:30.408915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:30.409910 [info ] [MainThread]: 
[0m12:22:30.411618 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:22:30.414629 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:30.414629 after 3.48 seconds
[0m12:22:30.415619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD88CEBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD8A5E9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD871F320>]}
[0m12:22:30.416616 [debug] [MainThread]: Flushing usage events
[0m12:31:53.532020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7BD5D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7BD5D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7BD5FB00>]}


============================== 12:31:53.554467 | 6afb25d0-eed1-4128-bf0f-c578267d1fc1 ==============================
[0m12:31:53.554467 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:31:53.554467 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:31:57.155409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7C4820C0>]}
[0m12:31:57.266104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7C42FA70>]}
[0m12:31:57.281951 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:31:57.311231 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:31:58.821236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:58.821236 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_prod.sql
[0m12:31:59.017843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7C8EDAC0>]}
[0m12:31:59.043257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7C677830>]}
[0m12:31:59.043257 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:31:59.043257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7C83B590>]}
[0m12:31:59.043257 [info ] [MainThread]: 
[0m12:31:59.043257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:59.043257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:31:59.072930 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:31:59.072930 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:31:59.072930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:00.230379 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:32:00.237381 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:32:00.382313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:32:00.410046 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:32:00.411043 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:32:00.411043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:00.907949 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:32:00.907949 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:32:01.003896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B61AC00>]}
[0m12:32:01.003896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:01.003896 [info ] [MainThread]: 
[0m12:32:01.019622 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:32:01.019622 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_prod
[0m12:32:01.019622 [info ] [Thread-1 (]: 1 of 2 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:32:01.019622 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:32:01.019622 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:32:01.040406 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:32:01.019622 [info ] [Thread-2 (]: 2 of 2 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m12:32:01.043268 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m12:32:01.043268 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_prod
[0m12:32:01.049279 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m12:32:01.050278 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:32:01.029512 => 12:32:01.049279
[0m12:32:01.051313 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:32:01.086242 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:32:01.095478 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_prod (compile): 12:32:01.044311 => 12:32:01.095478
[0m12:32:01.096488 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_prod
[0m12:32:01.097488 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m12:32:01.097488 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:32:01.097488 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:32:01.097488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:01.097488 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m12:32:01.097488 [debug] [Thread-2 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m12:32:01.097488 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:32:01.679853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:01.721269 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:32:01.051313 => 12:32:01.721269
[0m12:32:01.721269 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:32:01.725284 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:01.729988 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_prod (execute): 12:32:01.096488 => 12:32:01.729988
[0m12:32:01.729988 [debug] [Thread-2 (]: On model.data_engineering_project.stg_prod: Close
[0m12:32:01.813387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7CA5FDD0>]}
[0m12:32:01.813387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afb25d0-eed1-4128-bf0f-c578267d1fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7CA8D040>]}
[0m12:32:01.813387 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.79s]
[0m12:32:01.813387 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:32:01.813387 [info ] [Thread-2 (]: 2 of 2 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m12:32:01.813387 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_prod
[0m12:32:01.828552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:01.829352 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:32:01.830366 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:32:01.830366 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:32:01.831395 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m12:32:01.831395 [info ] [MainThread]: 
[0m12:32:01.832394 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m12:32:01.834395 [debug] [MainThread]: Command end result
[0m12:32:01.929943 [info ] [MainThread]: 
[0m12:32:01.930977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:01.931976 [info ] [MainThread]: 
[0m12:32:01.932990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:32:01.934941 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:01.933942 after 8.51 seconds
[0m12:32:01.934941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B153770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7BB019D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B9D8A10>]}
[0m12:32:01.935940 [debug] [MainThread]: Flushing usage events
[0m12:42:10.653689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2065400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2065520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2065370>]}


============================== 12:42:10.665793 | 0bda5cf2-53bd-45cb-a07c-02750c9c9cdc ==============================
[0m12:42:10.665793 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:42:10.665793 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:42:14.371139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E25BC260>]}
[0m12:42:14.482505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2468EC0>]}
[0m12:42:14.506625 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:42:14.531351 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:42:16.233029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:16.233029 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_hotelbook.sql
[0m12:42:16.435667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2782570>]}
[0m12:42:16.466141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2977E00>]}
[0m12:42:16.467142 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:42:16.468177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2B19F70>]}
[0m12:42:16.470176 [info ] [MainThread]: 
[0m12:42:16.472175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:16.474174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:42:16.495010 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:42:16.497025 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:42:16.497025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:17.672342 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:42:17.674342 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:42:17.763402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:42:17.771459 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:42:17.771459 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:42:17.771459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:18.215561 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:42:18.231636 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:42:18.310496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2AF9610>]}
[0m12:42:18.326413 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:18.326413 [info ] [MainThread]: 
[0m12:42:18.326413 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:42:18.326413 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m12:42:18.326413 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_prod
[0m12:42:18.326413 [info ] [Thread-1 (]: 1 of 3 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:42:18.326413 [info ] [Thread-2 (]: 2 of 3 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m12:42:18.339927 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:42:18.326413 [info ] [Thread-3 (]: 3 of 3 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m12:42:18.341938 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m12:42:18.341938 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:42:18.341938 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m12:42:18.344833 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m12:42:18.357663 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_prod
[0m12:42:18.344833 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:42:18.364240 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m12:42:18.368262 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m12:42:18.370273 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 12:42:18.357663 => 12:42:18.370273
[0m12:42:18.372954 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m12:42:18.372954 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (compile): 12:42:18.364240 => 12:42:18.372954
[0m12:42:18.374962 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:42:18.344833 => 12:42:18.374962
[0m12:42:18.411555 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_prod
[0m12:42:18.424583 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m12:42:18.425550 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:42:18.427313 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m12:42:18.427313 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:42:18.427313 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m12:42:18.427313 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id
)
select * from hotelbook
  );
[0m12:42:18.427313 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:18.427313 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:42:18.427313 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:42:18.443405 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m12:42:18.427313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:18.444606 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m12:42:18.446604 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:18.944122 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:42:18.978436 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (execute): 12:42:18.425550 => 12:42:18.978436
[0m12:42:18.978436 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: Close
[0m12:42:18.997532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:42:19.001519 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:42:18.427313 => 12:42:19.000531
[0m12:42:19.001519 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:42:19.074280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2DC3CB0>]}
[0m12:42:19.074280 [info ] [Thread-3 (]: 3 of 3 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m12:42:19.074280 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_prod
[0m12:42:19.090042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2DC3CB0>]}
[0m12:42:19.090042 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m12:42:19.095532 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:42:19.121879 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:42:19.128889 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 12:42:18.374962 => 12:42:19.128889
[0m12:42:19.128889 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m12:42:19.211089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bda5cf2-53bd-45cb-a07c-02750c9c9cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2D92FF0>]}
[0m12:42:19.211089 [info ] [Thread-2 (]: 2 of 3 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.87s]
[0m12:42:19.211089 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m12:42:19.211089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:19.211089 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:42:19.211089 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:42:19.211089 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:42:19.211089 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m12:42:19.211089 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m12:42:19.211089 [info ] [MainThread]: 
[0m12:42:19.211089 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m12:42:19.211089 [debug] [MainThread]: Command end result
[0m12:42:19.291706 [info ] [MainThread]: 
[0m12:42:19.291706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:19.291706 [info ] [MainThread]: 
[0m12:42:19.291706 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:42:19.291706 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:19.291706 after 8.76 seconds
[0m12:42:19.291706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2ADB0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E2095EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243E0D06330>]}
[0m12:42:19.291706 [debug] [MainThread]: Flushing usage events
[0m12:43:52.300619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9BC94590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9BC94F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9BC94890>]}


============================== 12:43:52.306642 | f735fd50-981f-4d30-a092-57e191ccf1f5 ==============================
[0m12:43:52.306642 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:43:52.306642 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:43:52.838058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C99E24B00>]}
[0m12:43:52.966698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C1BD580>]}
[0m12:43:52.968705 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:43:52.971307 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:43:53.120470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:53.121110 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_hotelbook.sql
[0m12:43:53.304959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C3BF830>]}
[0m12:43:53.321035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C573EF0>]}
[0m12:43:53.321035 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:43:53.321035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C6C3DD0>]}
[0m12:43:53.321035 [info ] [MainThread]: 
[0m12:43:53.321035 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:53.321035 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:43:53.347843 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:43:53.348806 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:43:53.348806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:54.205821 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:43:54.222080 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:43:54.308023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:43:54.321564 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:43:54.323053 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:43:54.323053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:54.722627 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:43:54.734464 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:43:54.832674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C85FBC0>]}
[0m12:43:54.832674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:54.832674 [info ] [MainThread]: 
[0m12:43:54.849115 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:43:54.849637 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m12:43:54.850646 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_prod
[0m12:43:54.850646 [info ] [Thread-1 (]: 1 of 3 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:43:54.851888 [info ] [Thread-2 (]: 2 of 3 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m12:43:54.856282 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:43:54.858322 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m12:43:54.853885 [info ] [Thread-3 (]: 3 of 3 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m12:43:54.859318 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:43:54.860287 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m12:43:54.862382 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m12:43:54.873282 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:43:54.879297 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m12:43:54.881295 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_prod
[0m12:43:54.886293 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m12:43:54.887293 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 12:43:54.874286 => 12:43:54.887293
[0m12:43:54.888296 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m12:43:54.896264 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (compile): 12:43:54.882296 => 12:43:54.896264
[0m12:43:54.905949 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_prod
[0m12:43:54.921500 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:43:54.863342 => 12:43:54.921500
[0m12:43:54.939407 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:43:54.940423 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m12:43:54.957083 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m12:43:54.958121 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:43:54.960139 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m12:43:54.960139 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month
)
select * from hotelbook
  );
[0m12:43:54.960139 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:54.960139 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m12:43:54.960139 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m12:43:54.960139 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:54.960139 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:43:54.960139 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:43:54.960139 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:55.407962 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:55.440576 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (execute): 12:43:54.921500 => 12:43:55.440576
[0m12:43:55.440576 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: Close
[0m12:43:55.505868 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:43:55.507257 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 12:43:54.888296 => 12:43:55.507257
[0m12:43:55.507257 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m12:43:55.523979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:43:55.523979 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:43:54.940423 => 12:43:55.523979
[0m12:43:55.523979 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:43:55.540548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C9D1340>]}
[0m12:43:55.540548 [info ] [Thread-3 (]: 3 of 3 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m12:43:55.540548 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_prod
[0m12:43:55.592179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C9D2F30>]}
[0m12:43:55.592179 [info ] [Thread-2 (]: 2 of 3 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.73s]
[0m12:43:55.592179 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m12:43:55.629465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f735fd50-981f-4d30-a092-57e191ccf1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9C9D06B0>]}
[0m12:43:55.631052 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m12:43:55.631052 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:43:55.631052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:55.631052 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:43:55.631052 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:43:55.631052 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:43:55.631052 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m12:43:55.631052 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m12:43:55.631052 [info ] [MainThread]: 
[0m12:43:55.631052 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m12:43:55.640925 [debug] [MainThread]: Command end result
[0m12:43:55.719909 [info ] [MainThread]: 
[0m12:43:55.720696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:55.721705 [info ] [MainThread]: 
[0m12:43:55.722706 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:43:55.724856 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:55.723708 after 3.50 seconds
[0m12:43:55.724856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9B767320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9BACD580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9BACECC0>]}
[0m12:43:55.725856 [debug] [MainThread]: Flushing usage events
[0m12:45:38.226930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39385DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39385DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39385D8B0>]}


============================== 12:45:38.232931 | edd4465b-fb9d-4e25-92f3-69f3aa059f89 ==============================
[0m12:45:38.232931 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:45:38.233933 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:45:39.002285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3933FCB00>]}
[0m12:45:39.164885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E393F2F200>]}
[0m12:45:39.164885 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:45:39.182761 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:45:39.361827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:39.362939 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_hotelbook.sql
[0m12:45:39.578881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3943ED8E0>]}
[0m12:45:39.598173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E394177B00>]}
[0m12:45:39.600805 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:45:39.601813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3939F1B20>]}
[0m12:45:39.604043 [info ] [MainThread]: 
[0m12:45:39.605042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:39.607043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:45:39.638316 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:45:39.638316 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:45:39.640327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:40.661862 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:45:40.661862 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:45:40.763202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:45:40.775831 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:45:40.776828 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:45:40.776828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:41.311195 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:45:41.315375 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:45:41.475569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E394463140>]}
[0m12:45:41.475569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:41.475569 [info ] [MainThread]: 
[0m12:45:41.485497 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:45:41.485497 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m12:45:41.485497 [info ] [Thread-1 (]: 1 of 3 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:45:41.485497 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_prod
[0m12:45:41.491315 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:45:41.491315 [info ] [Thread-2 (]: 2 of 3 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m12:45:41.491315 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:45:41.491315 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m12:45:41.491315 [info ] [Thread-3 (]: 3 of 3 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m12:45:41.507228 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m12:45:41.507228 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:45:41.507228 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m12:45:41.514998 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m12:45:41.517008 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_prod
[0m12:45:41.517008 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m12:45:41.517008 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:45:41.491315 => 12:45:41.517008
[0m12:45:41.524967 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:45:41.554416 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 12:45:41.507228 => 12:45:41.554416
[0m12:45:41.570135 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:45:41.570135 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m12:45:41.570135 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (compile): 12:45:41.517008 => 12:45:41.570135
[0m12:45:41.579059 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m12:45:41.579059 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_prod
[0m12:45:41.579059 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:45:41.586145 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m12:45:41.586145 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:45:41.586145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:41.589559 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m12:45:41.591568 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m12:45:41.591568 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:45:41.594875 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m12:45:41.594875 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m12:45:41.596885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:42.197674 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:42.312168 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 12:45:41.570135 => 12:45:42.312168
[0m12:45:42.314176 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m12:45:42.314176 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:42.314176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:42.314176 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (execute): 12:45:41.579059 => 12:45:42.314176
[0m12:45:42.325924 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:45:41.524967 => 12:45:42.325924
[0m12:45:42.325924 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: Close
[0m12:45:42.325924 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:45:42.414563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3945907D0>]}
[0m12:45:42.414563 [info ] [Thread-2 (]: 2 of 3 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.92s]
[0m12:45:42.420576 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m12:45:42.420576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E394238D10>]}
[0m12:45:42.424105 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m12:45:42.426114 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:45:42.432141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd4465b-fb9d-4e25-92f3-69f3aa059f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E394239D00>]}
[0m12:45:42.432141 [info ] [Thread-3 (]: 3 of 3 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m12:45:42.434148 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_prod
[0m12:45:42.441034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:42.443058 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:45:42.443058 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:45:42.445087 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:45:42.450087 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m12:45:42.451078 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m12:45:42.452076 [info ] [MainThread]: 
[0m12:45:42.456603 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m12:45:42.458603 [debug] [MainThread]: Command end result
[0m12:45:42.488128 [info ] [MainThread]: 
[0m12:45:42.492146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:42.492146 [info ] [MainThread]: 
[0m12:45:42.494153 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:45:42.497917 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:42.497917 after 4.36 seconds
[0m12:45:42.497917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E393773AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3933C24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E391ADAE40>]}
[0m12:45:42.497917 [debug] [MainThread]: Flushing usage events
[0m12:47:22.235806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1DC5DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1DC5DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1DC5D4F0>]}


============================== 12:47:22.241810 | faaf83f6-c025-4377-ad64-bf20e2e12cfa ==============================
[0m12:47:22.241810 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:47:22.243772 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:47:23.014870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E382390>]}
[0m12:47:23.133278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E27CE00>]}
[0m12:47:23.148830 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:47:23.159863 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:47:23.319822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:23.320823 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_hotelbook.sql
[0m12:47:23.547636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E7ED9A0>]}
[0m12:47:23.565202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E5779B0>]}
[0m12:47:23.565202 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:47:23.567979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E73B7D0>]}
[0m12:47:23.567979 [info ] [MainThread]: 
[0m12:47:23.567979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:23.567979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:47:23.599664 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:47:23.600657 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:47:23.600657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:24.684876 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:47:24.684876 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:47:24.791351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:47:24.802812 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:47:24.803847 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:47:24.803847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:25.244938 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:47:25.247936 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:47:25.351112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E73B710>]}
[0m12:47:25.352115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:25.352115 [info ] [MainThread]: 
[0m12:47:25.356638 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_cust
[0m12:47:25.356638 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m12:47:25.356638 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_prod
[0m12:47:25.356638 [info ] [Thread-1 (]: 1 of 3 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:47:25.356638 [info ] [Thread-2 (]: 2 of 3 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m12:47:25.367766 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:47:25.369732 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m12:47:25.365589 [info ] [Thread-3 (]: 3 of 3 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m12:47:25.370731 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:47:25.370731 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m12:47:25.372735 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m12:47:25.378764 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m12:47:25.390671 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:47:25.391636 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_prod
[0m12:47:25.395671 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m12:47:25.396670 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:47:25.373731 => 12:47:25.396670
[0m12:47:25.397634 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:47:25.398635 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 12:47:25.374764 => 12:47:25.398635
[0m12:47:25.432042 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m12:47:25.432042 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m12:47:25.448028 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:47:25.448028 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (compile): 12:47:25.392636 => 12:47:25.448028
[0m12:47:25.450319 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_prod
[0m12:47:25.454625 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m12:47:25.456623 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:47:25.457349 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m12:47:25.458636 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:47:25.459600 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m12:47:25.459600 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:25.460599 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m12:47:25.461634 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:47:25.462597 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m12:47:25.465652 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:47:25.934812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:26.019496 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:47:25.399637 => 12:47:26.019496
[0m12:47:26.019496 [debug] [Thread-1 (]: On model.data_engineering_project.stg_cust: Close
[0m12:47:26.031156 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:47:26.038353 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_prod (execute): 12:47:25.450319 => 12:47:26.038353
[0m12:47:26.038353 [debug] [Thread-3 (]: On model.data_engineering_project.stg_prod: Close
[0m12:47:26.112994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E6381D0>]}
[0m12:47:26.113475 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m12:47:26.114613 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:47:26.124152 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E639AC0>]}
[0m12:47:26.125151 [info ] [Thread-3 (]: 3 of 3 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m12:47:26.126134 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_prod
[0m12:47:26.150908 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:47:26.162740 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 12:47:25.432042 => 12:47:26.160701
[0m12:47:26.162740 [debug] [Thread-2 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m12:47:26.275867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faaf83f6-c025-4377-ad64-bf20e2e12cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E639880>]}
[0m12:47:26.276867 [info ] [Thread-2 (]: 2 of 3 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.91s]
[0m12:47:26.277866 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m12:47:26.280868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:26.280868 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:47:26.281868 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:47:26.281868 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:47:26.282905 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m12:47:26.282905 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m12:47:26.283868 [info ] [MainThread]: 
[0m12:47:26.284899 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m12:47:26.286901 [debug] [MainThread]: Command end result
[0m12:47:26.301259 [info ] [MainThread]: 
[0m12:47:26.302077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:26.303297 [info ] [MainThread]: 
[0m12:47:26.304261 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:47:26.306295 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:26.306295 after 4.15 seconds
[0m12:47:26.307259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E380560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E2A7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1E27CE00>]}
[0m12:47:26.307259 [debug] [MainThread]: Flushing usage events
[0m12:52:50.035526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940665610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9406658B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9406666F0>]}


============================== 12:52:50.035526 | d6b06f59-962b-4093-8e17-7b6a68537b7f ==============================
[0m12:52:50.035526 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:52:50.035526 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:52:50.606123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940D3E690>]}
[0m12:52:50.729255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9406BE0F0>]}
[0m12:52:50.730255 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:52:50.742255 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:52:50.877197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:50.877197 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\staging\stg_country.sql
[0m12:52:51.077373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9411D9BB0>]}
[0m12:52:51.093182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940F70320>]}
[0m12:52:51.093182 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:52:51.093182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9407D9E80>]}
[0m12:52:51.093182 [info ] [MainThread]: 
[0m12:52:51.093182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:51.093182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m12:52:51.121049 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m12:52:51.121049 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m12:52:51.121049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:51.942023 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:52:51.942023 [debug] [ThreadPool]: On list_NEWDB: Close
[0m12:52:52.042114 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m12:52:52.057498 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m12:52:52.058334 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m12:52:52.059058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:52.510609 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:52:52.510609 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m12:52:52.610788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9410C3D10>]}
[0m12:52:52.610788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:52.610788 [info ] [MainThread]: 
[0m12:52:52.626340 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m12:52:52.626340 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m12:52:52.626340 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m12:52:52.626340 [info ] [Thread-1 (]: 1 of 4 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m12:52:52.626340 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m12:52:52.635041 [info ] [Thread-2 (]: 2 of 4 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m12:52:52.637049 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m12:52:52.635041 [info ] [Thread-3 (]: 3 of 4 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m12:52:52.639377 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m12:52:52.639377 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m12:52:52.637376 [info ] [Thread-4 (]: 4 of 4 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m12:52:52.643593 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m12:52:52.644636 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m12:52:52.654551 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m12:52:52.654551 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m12:52:52.654551 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m12:52:52.663308 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m12:52:52.663658 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m12:52:52.668188 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m12:52:52.672255 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m12:52:52.673297 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 12:52:52.644636 => 12:52:52.673297
[0m12:52:52.674885 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m12:52:52.710743 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 12:52:52.664719 => 12:52:52.709281
[0m12:52:52.710743 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m12:52:52.710743 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m12:52:52.710743 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 12:52:52.669292 => 12:52:52.710743
[0m12:52:52.725847 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m12:52:52.725847 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 12:52:52.654551 => 12:52:52.725847
[0m12:52:52.725847 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m12:52:52.725847 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m12:52:52.725847 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m12:52:52.725847 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m12:52:52.741830 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m12:52:52.742450 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m12:52:52.744509 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m12:52:52.745275 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m12:52:52.745275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:52:52.745275 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:52:52.745275 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m12:52:52.745275 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m12:52:52.745275 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m12:52:52.808095 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m12:52:52.810088 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:52:52.811090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:52:53.348390 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:53.387904 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 12:52:52.725847 => 12:52:53.387904
[0m12:52:53.387904 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m12:52:53.387904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:53.391670 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 12:52:52.675902 => 12:52:53.391670
[0m12:52:53.391670 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m12:52:53.391670 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:53.391670 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 12:52:52.725847 => 12:52:53.391670
[0m12:52:53.391670 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m12:52:53.437149 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:53.440860 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 12:52:52.710743 => 12:52:53.440860
[0m12:52:53.442288 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m12:52:53.476690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9413CD250>]}
[0m12:52:53.476690 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.84s]
[0m12:52:53.476690 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m12:52:53.492345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940FC23F0>]}
[0m12:52:53.493286 [info ] [Thread-4 (]: 4 of 4 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m12:52:53.497621 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m12:52:53.497621 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940FC37D0>]}
[0m12:52:53.497621 [info ] [Thread-2 (]: 2 of 4 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m12:52:53.497621 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m12:52:53.526520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b06f59-962b-4093-8e17-7b6a68537b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940FC1850>]}
[0m12:52:53.526520 [info ] [Thread-3 (]: 3 of 4 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.89s]
[0m12:52:53.526520 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m12:52:53.538670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:53.541524 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m12:52:53.543171 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m12:52:53.543171 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m12:52:53.543171 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m12:52:53.543171 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m12:52:53.543171 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m12:52:53.543171 [info ] [MainThread]: 
[0m12:52:53.543171 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m12:52:53.543171 [debug] [MainThread]: Command end result
[0m12:52:53.563943 [info ] [MainThread]: 
[0m12:52:53.567032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:53.567032 [info ] [MainThread]: 
[0m12:52:53.567032 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:52:53.567032 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:53.567032 after 3.61 seconds
[0m12:52:53.567032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9410FBC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940694440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94111AC00>]}
[0m12:52:53.573171 [debug] [MainThread]: Flushing usage events
[0m13:09:36.363377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB95A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB94D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB97EF0>]}


============================== 13:09:36.385309 | d9bf10c4-704b-400d-b589-a6c0e9501f94 ==============================
[0m13:09:36.385309 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:09:36.385309 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:09:40.018754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DA59C70>]}
[0m13:09:40.148012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB947D0>]}
[0m13:09:40.148012 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:09:40.177517 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:09:40.210111 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:09:40.210111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108E537320>]}
[0m13:09:43.158245 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\schema.yml'
[0m13:09:43.158245 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\schema.yml'
[0m13:09:43.414960 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.unique_my_first_dbt_model_id.16e066b321' (models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m13:09:43.414960 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.not_null_my_first_dbt_model_id.5fb22c2710' (models\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m13:09:43.414960 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.unique_my_second_dbt_model_id.57a0f8c493' (models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m13:09:43.414960 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_engineering_project.not_null_my_second_dbt_model_id.151b76d778' (models\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m13:09:43.459978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108E41A030>]}
[0m13:09:43.503552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108E51F2C0>]}
[0m13:09:43.503552 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:09:43.508837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108E6DE9C0>]}
[0m13:09:43.511012 [info ] [MainThread]: 
[0m13:09:43.516375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:09:43.519368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m13:09:43.531372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m13:09:43.539460 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m13:09:43.542452 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m13:09:43.543452 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m13:09:43.543452 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m13:09:43.544452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:43.544452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:44.599674 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:09:44.599674 [debug] [ThreadPool]: On list_NEWDB: Close
[0m13:09:44.599674 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:09:44.599674 [debug] [ThreadPool]: On list_NEWDB: Close
[0m13:09:44.694906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NEWDB, now create_NEWDB_DESCHEMA_reporting)
[0m13:09:44.711080 [debug] [ThreadPool]: Creating schema "database: "NEWDB"
schema: "DESCHEMA_reporting"
"
[0m13:09:44.725245 [debug] [ThreadPool]: Using snowflake connection "create_NEWDB_DESCHEMA_reporting"
[0m13:09:44.725245 [debug] [ThreadPool]: On create_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "create_NEWDB_DESCHEMA_reporting"} */
create schema if not exists NEWDB.DESCHEMA_reporting
[0m13:09:44.726997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:45.212111 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:09:45.212111 [debug] [ThreadPool]: On create_NEWDB_DESCHEMA_reporting: Close
[0m13:09:45.323612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m13:09:45.326220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m13:09:45.348953 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m13:09:45.348953 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m13:09:45.350959 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m13:09:45.350959 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m13:09:45.350959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:45.352965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:45.666875 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:09:45.669032 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m13:09:45.714418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:09:45.714418 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m13:09:45.810210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108E681220>]}
[0m13:09:45.810210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:09:45.810210 [info ] [MainThread]: 
[0m13:09:45.826005 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m13:09:45.826005 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_country
[0m13:09:45.826005 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_cust
[0m13:09:45.826005 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m13:09:45.826005 [info ] [Thread-1 (]: 1 of 5 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m13:09:45.826005 [info ] [Thread-2 (]: 2 of 5 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m13:09:45.833698 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.rpt_1'
[0m13:09:45.833698 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m13:09:45.833698 [info ] [Thread-3 (]: 3 of 5 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m13:09:45.833698 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m13:09:45.833698 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_country
[0m13:09:45.833698 [info ] [Thread-4 (]: 4 of 5 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m13:09:45.833698 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m13:09:45.841724 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m13:09:45.853007 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m13:09:45.853007 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m13:09:45.855016 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_cust
[0m13:09:45.855016 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m13:09:45.861069 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m13:09:45.861069 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m13:09:45.861069 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_country (compile): 13:09:45.841724 => 13:09:45.861069
[0m13:09:45.869565 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 13:09:45.833698 => 13:09:45.861069
[0m13:09:45.869565 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_country
[0m13:09:45.873148 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m13:09:45.888913 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_cust (compile): 13:09:45.855016 => 13:09:45.888913
[0m13:09:45.888913 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 13:09:45.861069 => 13:09:45.888913
[0m13:09:45.935994 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m13:09:45.935994 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_cust
[0m13:09:45.951784 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m13:09:45.953822 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m13:09:45.953822 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m13:09:45.953822 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m13:09:45.967910 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m13:09:45.971997 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m13:09:45.971997 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m13:09:45.971997 [debug] [Thread-2 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m13:09:45.971997 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM {ref(stg_hotelbook)}
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', transaction_date) AS month,
        customer_id
    FROM {ref(stg_hotelbook)}
    GROUP BY 1, 2
),
customer_status AS (
    SELECT
        mc.month,
        mc.customer_id,
        CASE
            WHEN ca.first_purchase_date = mc.month THEN 'New Customer'
            WHEN ca.last_purchase_date < mc.month - INTERVAL '1 month' THEN 'Churned Customer'
            ELSE 'Returning Customer'
        END AS customer_status
    FROM monthly_customers mc
    JOIN customer_activity ca ON mc.customer_id = ca.customer_id
)
SELECT
    month,
    SUM(CASE WHEN customer_status = 'New Customer' THEN 1 ELSE 0 END) AS new_customers,
    SUM(CASE WHEN customer_status = 'Churned Customer' THEN 1 ELSE 0 END) AS churned_customers
FROM customer_status
GROUP BY month
ORDER BY month;
[0m13:09:45.971997 [debug] [Thread-3 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m13:09:45.971997 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:45.971997 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m13:09:45.971997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:09:45.971997 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:09:45.971997 [debug] [Thread-4 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m13:09:45.971997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:09:46.502550 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:09:46.550324 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_cust (execute): 13:09:45.953822 => 13:09:46.550324
[0m13:09:46.550324 [debug] [Thread-3 (]: On model.data_engineering_project.stg_cust: Close
[0m13:09:46.550324 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:09:46.550324 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_country (execute): 13:09:45.875163 => 13:09:46.550324
[0m13:09:46.550324 [debug] [Thread-2 (]: On model.data_engineering_project.stg_country: Close
[0m13:09:46.569104 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:09:46.569104 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 13:09:45.953822 => 13:09:46.569104
[0m13:09:46.569104 [debug] [Thread-4 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m13:09:46.652294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108E9EEB10>]}
[0m13:09:46.652294 [info ] [Thread-2 (]: 2 of 5 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.82s]
[0m13:09:46.652294 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_country
[0m13:09:46.658673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108EADBEF0>]}
[0m13:09:46.658673 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_prod
[0m13:09:46.661299 [info ] [Thread-3 (]: 3 of 5 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m13:09:46.661299 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_cust
[0m13:09:46.661299 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108EB32C00>]}
[0m13:09:46.661299 [info ] [Thread-2 (]: 5 of 5 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m13:09:46.661299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.stg_prod)
[0m13:09:46.661299 [info ] [Thread-4 (]: 4 of 5 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.81s]
[0m13:09:46.661299 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_prod
[0m13:09:46.661299 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m13:09:46.678430 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m13:09:46.686686 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_prod (compile): 13:09:46.669433 => 13:09:46.681222
[0m13:09:46.687679 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_prod
[0m13:09:46.696675 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m13:09:46.701252 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m13:09:46.702440 [debug] [Thread-2 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m13:09:46.703443 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:09:46.716437 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff6b-0001-429b-0008-4d960001cf66
[0m13:09:46.716437 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 10 unexpected 'ref'.
syntax error line 16 at position 10 unexpected 'ref'.
syntax error line 37 at position 14 unexpected ';'.
[0m13:09:46.717476 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 13:09:45.888913 => 13:09:46.717476
[0m13:09:46.718440 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m13:09:46.829405 [debug] [Thread-1 (]: Database Error in model rpt_1 (models\reporting\rpt_1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 10 unexpected 'ref'.
  syntax error line 16 at position 10 unexpected 'ref'.
  syntax error line 37 at position 14 unexpected ';'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_1.sql
[0m13:09:46.829405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108EAFD4C0>]}
[0m13:09:46.829405 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model DESCHEMA_reporting.rpt_1 .................. [[31mERROR[0m in 1.00s]
[0m13:09:46.835684 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m13:09:47.114734 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:09:47.114734 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_prod (execute): 13:09:46.687679 => 13:09:47.114734
[0m13:09:47.114734 [debug] [Thread-2 (]: On model.data_engineering_project.stg_prod: Close
[0m13:09:47.214594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9bf10c4-704b-400d-b589-a6c0e9501f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108EAE9250>]}
[0m13:09:47.214594 [info ] [Thread-2 (]: 5 of 5 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.55s]
[0m13:09:47.220451 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_prod
[0m13:09:47.225510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:47.226510 [debug] [MainThread]: Connection 'create_NEWDB_DESCHEMA_reporting' was properly closed.
[0m13:09:47.228465 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m13:09:47.229467 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m13:09:47.230464 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m13:09:47.231466 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m13:09:47.232466 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m13:09:47.233466 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m13:09:47.233466 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m13:09:47.236398 [info ] [MainThread]: 
[0m13:09:47.237410 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m13:09:47.242455 [debug] [MainThread]: Command end result
[0m13:09:47.260608 [info ] [MainThread]: 
[0m13:09:47.260608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:09:47.262617 [info ] [MainThread]: 
[0m13:09:47.262617 [error] [MainThread]:   Database Error in model rpt_1 (models\reporting\rpt_1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 10 unexpected 'ref'.
  syntax error line 16 at position 10 unexpected 'ref'.
  syntax error line 37 at position 14 unexpected ';'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_1.sql
[0m13:09:47.264625 [info ] [MainThread]: 
[0m13:09:47.264625 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:09:47.266631 [debug] [MainThread]: Command `dbt run` failed at 13:09:47.266631 after 11.00 seconds
[0m13:09:47.266631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB65DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB65E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108DB65310>]}
[0m13:09:47.268380 [debug] [MainThread]: Flushing usage events
[0m13:11:31.226496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B593661670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B593661880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5936628D0>]}


============================== 13:11:31.248603 | bc2f9981-7f9f-4f1b-9164-c49304b0a937 ==============================
[0m13:11:31.248603 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:11:31.248603 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:11:34.874301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B593E219D0>]}
[0m13:11:34.986158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B593840560>]}
[0m13:11:35.001881 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:11:35.017958 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:11:36.712354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:36.728362 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_1.sql
[0m13:11:36.914184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5941DE180>]}
[0m13:11:36.945263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B593FBCB00>]}
[0m13:11:36.945263 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:11:36.946264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B594117020>]}
[0m13:11:36.949298 [info ] [MainThread]: 
[0m13:11:36.950468 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:11:36.952511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m13:11:36.961478 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m13:11:36.961478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m13:11:36.961478 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m13:11:36.961478 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m13:11:36.977297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:36.977297 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m13:11:36.979775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:38.007708 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:11:38.009708 [debug] [ThreadPool]: On list_NEWDB: Close
[0m13:11:38.017937 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:11:38.019936 [debug] [ThreadPool]: On list_NEWDB: Close
[0m13:11:38.093528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m13:11:38.093528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m13:11:38.111453 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m13:11:38.111453 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m13:11:38.111453 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m13:11:38.111453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:38.111453 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m13:11:38.111453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:38.540444 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:11:38.542443 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m13:11:38.549178 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:11:38.551177 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m13:11:38.645196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B593D826C0>]}
[0m13:11:38.650770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:38.650770 [info ] [MainThread]: 
[0m13:11:38.659165 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m13:11:38.659165 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m13:11:38.659165 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m13:11:38.659165 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m13:11:38.659165 [info ] [Thread-1 (]: 1 of 5 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m13:11:38.659165 [info ] [Thread-2 (]: 2 of 5 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m13:11:38.659165 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m13:11:38.659165 [info ] [Thread-3 (]: 3 of 5 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m13:11:38.659165 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m13:11:38.659165 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m13:11:38.659165 [info ] [Thread-4 (]: 4 of 5 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m13:11:38.659165 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m13:11:38.659165 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m13:11:38.659165 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m13:11:38.687945 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m13:11:38.687945 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m13:11:38.690966 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m13:11:38.690966 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m13:11:38.704898 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m13:11:38.708648 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m13:11:38.708648 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 13:11:38.659165 => 13:11:38.708648
[0m13:11:38.713549 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m13:11:38.738350 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 13:11:38.689957 => 13:11:38.738350
[0m13:11:38.753886 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m13:11:38.753886 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m13:11:38.769868 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 13:11:38.690966 => 13:11:38.769868
[0m13:11:38.817584 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m13:11:38.833237 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 13:11:38.706637 => 13:11:38.817584
[0m13:11:38.833237 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m13:11:38.833237 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m13:11:38.833237 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m13:11:38.833237 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m13:11:38.842997 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m13:11:38.845007 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m13:11:38.845007 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m13:11:38.845007 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m13:11:38.845007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:38.849070 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m13:11:38.849070 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:38.849070 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m13:11:38.852641 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m13:11:38.854149 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m13:11:38.858165 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:38.858165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:11:39.255261 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:11:39.271295 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:11:39.287016 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 13:11:38.833237 => 13:11:39.287016
[0m13:11:39.302724 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m13:11:39.304733 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 13:11:38.753886 => 13:11:39.304733
[0m13:11:39.304733 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m13:11:39.304733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:11:39.315220 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 13:11:38.713549 => 13:11:39.313211
[0m13:11:39.315220 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m13:11:39.383000 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:11:39.383000 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 13:11:38.833237 => 13:11:39.383000
[0m13:11:39.383000 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m13:11:39.383000 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5943CDE20>]}
[0m13:11:39.383000 [info ] [Thread-4 (]: 4 of 5 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m13:11:39.400817 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m13:11:39.400817 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5943A2240>]}
[0m13:11:39.400817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5943A2E40>]}
[0m13:11:39.400817 [info ] [Thread-2 (]: 2 of 5 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.74s]
[0m13:11:39.400817 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m13:11:39.400817 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.74s]
[0m13:11:39.400817 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m13:11:39.478298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5943A2BD0>]}
[0m13:11:39.478298 [info ] [Thread-3 (]: 3 of 5 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.82s]
[0m13:11:39.478298 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m13:11:39.478298 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m13:11:39.478298 [info ] [Thread-4 (]: 5 of 5 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m13:11:39.478298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m13:11:39.478298 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m13:11:39.493967 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m13:11:39.498269 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 13:11:39.492227 => 13:11:39.493967
[0m13:11:39.498269 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m13:11:39.500279 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m13:11:39.508137 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m13:11:39.508137 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', transaction_date) AS month,
        customer_id
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY 1, 2
),
customer_status AS (
    SELECT
        mc.month,
        mc.customer_id,
        CASE
            WHEN ca.first_purchase_date = mc.month THEN 'New Customer'
            WHEN ca.last_purchase_date < mc.month - INTERVAL '1 month' THEN 'Churned Customer'
            ELSE 'Returning Customer'
        END AS customer_status
    FROM monthly_customers mc
    JOIN customer_activity ca ON mc.customer_id = ca.customer_id
)
SELECT
    month,
    SUM(CASE WHEN customer_status = 'New Customer' THEN 1 ELSE 0 END) AS new_customers,
    SUM(CASE WHEN customer_status = 'Churned Customer' THEN 1 ELSE 0 END) AS churned_customers
FROM customer_status
GROUP BY month
ORDER BY month
  );
[0m13:11:39.508137 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:40.658116 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01baff6d-0001-429a-0008-4d960001dda6
[0m13:11:40.659116 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 12
invalid identifier 'TRANSACTION_DATE'
[0m13:11:40.660118 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 13:11:39.498269 => 13:11:40.660118
[0m13:11:40.660118 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m13:11:41.058837 [debug] [Thread-4 (]: Database Error in model rpt_1 (models\reporting\rpt_1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_1.sql
[0m13:11:41.058837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2f9981-7f9f-4f1b-9164-c49304b0a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B59423F230>]}
[0m13:11:41.060844 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model DESCHEMA_reporting.rpt_1 .................. [[31mERROR[0m in 1.58s]
[0m13:11:41.060844 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m13:11:41.065763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:41.066762 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m13:11:41.066762 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m13:11:41.067761 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m13:11:41.067761 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m13:11:41.067761 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m13:11:41.068761 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m13:11:41.068761 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m13:11:41.069761 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m13:11:41.069761 [info ] [MainThread]: 
[0m13:11:41.071018 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m13:11:41.074027 [debug] [MainThread]: Command end result
[0m13:11:41.093348 [info ] [MainThread]: 
[0m13:11:41.094349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:11:41.095350 [info ] [MainThread]: 
[0m13:11:41.095350 [error] [MainThread]:   Database Error in model rpt_1 (models\reporting\rpt_1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_1.sql
[0m13:11:41.096391 [info ] [MainThread]: 
[0m13:11:41.099466 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:11:41.101784 [debug] [MainThread]: Command `dbt run` failed at 13:11:41.101784 after 10.00 seconds
[0m13:11:41.101784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B59358DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5919F85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B591B18230>]}
[0m13:11:41.101784 [debug] [MainThread]: Flushing usage events
[0m13:14:01.597867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7795790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7796870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7795FD0>]}


============================== 13:14:01.597867 | 811c2f08-2ee7-460d-9ef0-ab18817aab75 ==============================
[0m13:14:01.597867 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:14:01.597867 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:14:02.149345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7E3E510>]}
[0m13:14:02.252709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B799A0F0>]}
[0m13:14:02.268445 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:14:02.279927 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:14:02.418992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:02.418992 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_1.sql
[0m13:14:02.609232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B82DDF40>]}
[0m13:14:02.616501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B806C290>]}
[0m13:14:02.616501 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:14:02.616501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B775D6A0>]}
[0m13:14:02.616501 [info ] [MainThread]: 
[0m13:14:02.616501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:14:02.630887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m13:14:02.639556 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m13:14:02.639556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m13:14:02.639556 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m13:14:02.639556 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m13:14:02.655807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:02.656579 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m13:14:02.657295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:03.514354 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:14:03.514354 [debug] [ThreadPool]: On list_NEWDB: Close
[0m13:14:03.514354 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:14:03.514354 [debug] [ThreadPool]: On list_NEWDB: Close
[0m13:14:03.623641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m13:14:03.627659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m13:14:03.640821 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m13:14:03.644744 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m13:14:03.644744 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m13:14:03.646926 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m13:14:03.646926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:03.646926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:03.945668 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:14:03.949460 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m13:14:03.965589 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m13:14:03.965589 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m13:14:04.060769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7F86960>]}
[0m13:14:04.060769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:04.060769 [info ] [MainThread]: 
[0m13:14:04.076808 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m13:14:04.076808 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m13:14:04.076808 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m13:14:04.076808 [info ] [Thread-1 (]: 1 of 5 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m13:14:04.076808 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m13:14:04.083544 [info ] [Thread-2 (]: 2 of 5 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m13:14:04.086081 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m13:14:04.084553 [info ] [Thread-3 (]: 3 of 5 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m13:14:04.088181 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m13:14:04.088181 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m13:14:04.086081 [info ] [Thread-4 (]: 4 of 5 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m13:14:04.090627 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m13:14:04.091633 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m13:14:04.094061 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m13:14:04.097825 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m13:14:04.097825 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m13:14:04.107995 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m13:14:04.110073 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m13:14:04.114115 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m13:14:04.116083 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m13:14:04.116083 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 13:14:04.092642 => 13:14:04.116083
[0m13:14:04.116083 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m13:14:04.125369 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 13:14:04.111124 => 13:14:04.124104
[0m13:14:04.126340 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m13:14:04.159004 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 13:14:04.097825 => 13:14:04.159004
[0m13:14:04.223380 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m13:14:04.223380 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m13:14:04.235676 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m13:14:04.235676 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 13:14:04.115116 => 13:14:04.235676
[0m13:14:04.241416 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m13:14:04.241416 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m13:14:04.241416 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m13:14:04.241416 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m13:14:04.241416 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m13:14:04.241416 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:04.241416 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m13:14:04.241416 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m13:14:04.241416 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:04.255078 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m13:14:04.255078 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m13:14:04.255078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:04.255078 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m13:14:04.255078 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m13:14:04.255078 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:14:04.673839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:14:04.689882 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 13:14:04.116083 => 13:14:04.689882
[0m13:14:04.689882 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m13:14:04.785489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B84D5AF0>]}
[0m13:14:04.785489 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:14:04.785489 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.70s]
[0m13:14:04.785489 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 13:14:04.127338 => 13:14:04.785489
[0m13:14:04.801277 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m13:14:04.803310 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m13:14:04.815380 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:14:04.819978 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 13:14:04.241416 => 13:14:04.819978
[0m13:14:04.820978 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m13:14:04.822978 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:14:04.827980 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 13:14:04.235676 => 13:14:04.826945
[0m13:14:04.827980 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m13:14:04.884838 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B8500920>]}
[0m13:14:04.884838 [info ] [Thread-3 (]: 3 of 5 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.80s]
[0m13:14:04.886848 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m13:14:04.886848 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m13:14:04.886848 [info ] [Thread-1 (]: 5 of 5 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m13:14:04.886848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m13:14:04.891618 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m13:14:04.891618 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m13:14:04.891618 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 13:14:04.891618 => 13:14:04.891618
[0m13:14:04.891618 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m13:14:04.891618 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m13:14:04.891618 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m13:14:04.907315 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(payment_month) AS first_purchase_date,
        MAX(payment_month) AS last_purchase_date
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', payment_month) AS month,
        customer_id
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY 1, 2
),
customer_status AS (
    SELECT
        mc.month,
        mc.customer_id,
        CASE
            WHEN ca.first_purchase_date = mc.month THEN 'New Customer'
            WHEN ca.last_purchase_date < mc.month - INTERVAL '1 month' THEN 'Churned Customer'
            ELSE 'Returning Customer'
        END AS customer_status
    FROM monthly_customers mc
    JOIN customer_activity ca ON mc.customer_id = ca.customer_id
)
SELECT
    month,
    SUM(CASE WHEN customer_status = 'New Customer' THEN 1 ELSE 0 END) AS new_customers,
    SUM(CASE WHEN customer_status = 'Churned Customer' THEN 1 ELSE 0 END) AS churned_customers
FROM customer_status
GROUP BY month
ORDER BY month
  );
[0m13:14:04.907315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:04.916524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B84C7DD0>]}
[0m13:14:04.918600 [info ] [Thread-4 (]: 4 of 5 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m13:14:04.919553 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m13:14:04.921551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B84C5FA0>]}
[0m13:14:04.921551 [info ] [Thread-2 (]: 2 of 5 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.83s]
[0m13:14:04.922550 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m13:14:05.351128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:14:05.354127 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 13:14:04.891618 => 13:14:05.354127
[0m13:14:05.355129 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m13:14:05.427697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '811c2f08-2ee7-460d-9ef0-ab18817aab75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B3819E50>]}
[0m13:14:05.427697 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.54s]
[0m13:14:05.427697 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m13:14:05.427697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:05.427697 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m13:14:05.427697 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m13:14:05.427697 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m13:14:05.438110 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m13:14:05.438110 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m13:14:05.439418 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m13:14:05.440428 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m13:14:05.440428 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m13:14:05.440428 [info ] [MainThread]: 
[0m13:14:05.442091 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m13:14:05.445168 [debug] [MainThread]: Command end result
[0m13:14:05.459172 [info ] [MainThread]: 
[0m13:14:05.461189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:05.463199 [info ] [MainThread]: 
[0m13:14:05.463199 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:14:05.463199 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:05.463199 after 3.94 seconds
[0m13:14:05.466901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7353290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7794FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0B7795FD0>]}
[0m13:14:05.466901 [debug] [MainThread]: Flushing usage events
[0m14:17:08.151495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44815D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44815DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44815DA90>]}


============================== 14:17:08.183031 | 155b15df-6214-486f-ace5-045d33bbac0c ==============================
[0m14:17:08.183031 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:17:08.183031 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:17:11.971695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4488F6D20>]}
[0m14:17:12.090937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4482F0260>]}
[0m14:17:12.094799 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:17:12.126417 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:17:13.847326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:17:13.847326 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:17:13.847326 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_1.sql
[0m14:17:14.053799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448C3FEF0>]}
[0m14:17:14.085601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448A73DD0>]}
[0m14:17:14.085601 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:17:14.085601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448BFDFA0>]}
[0m14:17:14.085601 [info ] [MainThread]: 
[0m14:17:14.101338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:14.103610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:17:14.117452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:17:14.117452 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:17:14.117452 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:17:14.117452 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:17:14.117452 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:17:14.133210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:14.133210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:15.400005 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:17:15.383936 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:17:15.400005 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:17:15.400005 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:17:15.513118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:17:15.513118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:17:15.528997 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:17:15.544712 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:17:15.544712 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:17:15.544712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:15.544712 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:17:15.544712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:15.968126 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:17:15.968126 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:17:16.224440 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:17:16.224440 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:17:16.321007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448CA02C0>]}
[0m14:17:16.336815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:16.336815 [info ] [MainThread]: 
[0m14:17:16.352943 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:17:16.352943 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:17:16.356148 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:17:16.356148 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:17:16.356148 [info ] [Thread-1 (]: 1 of 5 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:17:16.358158 [info ] [Thread-2 (]: 2 of 5 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:17:16.360167 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:17:16.358158 [info ] [Thread-3 (]: 3 of 5 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:17:16.360167 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:17:16.360167 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:17:16.358158 [info ] [Thread-4 (]: 4 of 5 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:17:16.360167 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:17:16.360167 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:17:16.370706 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:17:16.370706 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:17:16.370706 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:17:16.388428 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:17:16.390480 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:17:16.390480 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:17:16.390480 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:17:16.360167 => 14:17:16.390480
[0m14:17:16.401710 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:17:16.403861 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:17:16.406872 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:17:16.370706 => 14:17:16.405866
[0m14:17:16.418861 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:17:16.532290 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:17:16.390480 => 14:17:16.532290
[0m14:17:16.532290 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:17:16.532290 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:17:16.532290 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:17:16.390480 => 14:17:16.532290
[0m14:17:16.532290 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:17:16.548003 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:17:16.548003 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:17:16.558066 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:17:16.558066 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:17:16.558066 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:17:16.558066 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:16.558066 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:17:16.563715 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:17:16.563715 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:17:16.563715 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:17:16.563715 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:17:16.563715 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:17:16.563715 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:17:16.563715 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:17:16.563715 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:17:16.970097 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:17:16.986300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:17:17.010781 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:17:16.408872 => 14:17:17.010781
[0m14:17:17.017241 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:17:17.017241 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:17:17.017241 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:17:16.420085 => 14:17:17.017241
[0m14:17:17.027696 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:17:16.548003 => 14:17:17.027696
[0m14:17:17.027696 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:17:17.027696 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:17:17.096632 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:17:17.096632 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:17:16.532290 => 14:17:17.096632
[0m14:17:17.096632 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:17:17.112660 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448EE8B90>]}
[0m14:17:17.112660 [info ] [Thread-2 (]: 2 of 5 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m14:17:17.112660 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:17:17.741991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448EE8B30>]}
[0m14:17:17.748867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448EE92B0>]}
[0m14:17:17.741991 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 1.38s]
[0m14:17:17.748867 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:17:17.748867 [info ] [Thread-4 (]: 4 of 5 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 1.39s]
[0m14:17:17.748867 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:17:17.787204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448A1AC90>]}
[0m14:17:17.787204 [info ] [Thread-3 (]: 3 of 5 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 1.43s]
[0m14:17:17.789219 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:17:17.789219 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m14:17:17.789219 [info ] [Thread-2 (]: 5 of 5 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:17:17.789219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m14:17:17.789219 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:17:17.789219 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:17:17.813159 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:17:17.789219 => 14:17:17.809126
[0m14:17:17.813159 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:17:17.819188 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:17:17.826407 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:17:17.828425 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:17:17.828425 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:17:18.242977 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:17:18.242977 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:17:17.813159 => 14:17:18.242977
[0m14:17:18.242977 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m14:17:18.332995 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155b15df-6214-486f-ace5-045d33bbac0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E448EE8D10>]}
[0m14:17:18.332995 [info ] [Thread-2 (]: 5 of 5 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.54s]
[0m14:17:18.335003 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:17:18.336920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:17:18.338658 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m14:17:18.338658 [info ] [MainThread]: 
[0m14:17:18.338658 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m14:17:18.347182 [debug] [MainThread]: Command end result
[0m14:17:18.369984 [info ] [MainThread]: 
[0m14:17:18.378139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:18.380152 [info ] [MainThread]: 
[0m14:17:18.382162 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:17:18.387449 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:18.387449 after 10.35 seconds
[0m14:17:18.389460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4466C2B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44815F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E44815DBB0>]}
[0m14:17:18.393553 [debug] [MainThread]: Flushing usage events
[0m14:22:01.819352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629265C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629266CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629265790>]}


============================== 14:22:01.834297 | c203ff4c-a1e4-4958-8f23-a489a86a0c79 ==============================
[0m14:22:01.834297 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:22:01.834297 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:22:02.415074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629852270>]}
[0m14:22:02.543493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6272B8D40>]}
[0m14:22:02.543493 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:22:02.568214 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:22:02.727844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:02.728149 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:22:02.922024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629DDA5A0>]}
[0m14:22:02.940117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629B6FA10>]}
[0m14:22:02.940117 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:22:02.941118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629294830>]}
[0m14:22:02.943698 [info ] [MainThread]: 
[0m14:22:02.945741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:02.946741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:22:02.964865 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:22:02.966831 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:22:02.966831 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:22:02.969831 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:22:02.970865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:02.971865 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:22:02.971865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:04.072699 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:22:04.090523 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:22:04.090523 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:22:04.090523 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:22:04.172806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:22:04.189625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:22:04.205955 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:22:04.209951 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:22:04.209951 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:22:04.210983 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:22:04.211951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:04.211951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:04.491925 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:22:04.505786 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:22:04.521098 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:22:04.521098 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:22:04.625509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629E3B4A0>]}
[0m14:22:04.625509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:04.625509 [info ] [MainThread]: 
[0m14:22:04.625509 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:22:04.625509 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:22:04.636791 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:22:04.625509 [info ] [Thread-1 (]: 1 of 6 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:22:04.640505 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:22:04.642505 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:22:04.644668 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:22:04.636791 [info ] [Thread-2 (]: 2 of 6 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:22:04.652303 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:22:04.641504 [info ] [Thread-3 (]: 3 of 6 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:22:04.665306 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:22:04.669381 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:22:04.643669 [info ] [Thread-4 (]: 4 of 6 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:22:04.670380 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:22:04.676378 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:22:04.677379 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:22:04.678382 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:22:04.682590 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:22:04.644668 => 14:22:04.680568
[0m14:22:04.683581 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:22:04.685614 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:22:04.689637 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:22:04.671378 => 14:22:04.688626
[0m14:22:04.690639 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:22:04.695543 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:22:04.696058 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:22:04.810227 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:22:04.683581 => 14:22:04.810227
[0m14:22:04.810227 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:22:04.821053 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:22:04.821053 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:22:04.823131 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:22:04.823131 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:22:04.691639 => 14:22:04.823131
[0m14:22:04.823131 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:22:04.823131 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:22:04.823131 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:22:04.823131 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:22:04.823131 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:22:04.823131 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:22:04.838459 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:22:04.838459 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:04.840031 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:22:04.840031 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:22:04.840031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:22:04.840031 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:22:04.840031 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:22:04.848112 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:22:05.285918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:22:05.306698 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:22:04.697105 => 14:22:05.306698
[0m14:22:05.306698 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:22:05.306698 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:22:05.323260 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:22:04.743566 => 14:22:05.323260
[0m14:22:05.323260 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:22:05.410982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629FA4110>]}
[0m14:22:05.410982 [info ] [Thread-2 (]: 2 of 6 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m14:22:05.412990 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:22:05.428524 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:22:05.430525 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:22:04.823131 => 14:22:05.430525
[0m14:22:05.430525 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:22:05.430525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629FA5520>]}
[0m14:22:05.430525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:22:05.430525 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.79s]
[0m14:22:05.443414 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:22:04.822692 => 14:22:05.443414
[0m14:22:05.444414 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:22:05.445410 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:22:05.529436 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629FA4CB0>]}
[0m14:22:05.529436 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.85s]
[0m14:22:05.529436 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:22:05.578893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629FA41D0>]}
[0m14:22:05.579897 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.91s]
[0m14:22:05.581896 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:22:05.582895 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m14:22:05.584929 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_6
[0m14:22:05.583893 [info ] [Thread-2 (]: 5 of 6 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:22:05.587930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m14:22:05.587930 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:22:05.585895 [info ] [Thread-1 (]: 6 of 6 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:22:05.597609 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:22:05.598656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_6)
[0m14:22:05.599656 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:22:05.602617 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:22:05.602617 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:22:05.589897 => 14:22:05.602617
[0m14:22:05.608239 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:22:05.615272 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:22:05.615780 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:22:05.600620 => 14:22:05.615780
[0m14:22:05.617075 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:22:05.742513 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:22:05.746542 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:22:05.748554 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:22:05.748554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:05.750565 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:22:05.750565 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        p.product_family,
        p.product_sub_family,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    product_family,
    product_sub_family,
    total_revenue,
    RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM product_revenue
  );
[0m14:22:05.754589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:06.224179 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:22:06.224179 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:22:05.609257 => 14:22:06.224179
[0m14:22:06.231674 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m14:22:06.261304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:22:06.274203 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:22:05.617075 => 14:22:06.274203
[0m14:22:06.274203 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: Close
[0m14:22:06.322243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629FA5100>]}
[0m14:22:06.324706 [info ] [Thread-2 (]: 5 of 6 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.73s]
[0m14:22:06.326697 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:22:06.361689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c203ff4c-a1e4-4958-8f23-a489a86a0c79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F629FA4260>]}
[0m14:22:06.365823 [info ] [Thread-1 (]: 6 of 6 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.76s]
[0m14:22:06.367840 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:22:06.371862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:06.374337 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:22:06.376348 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:22:06.376348 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:22:06.378359 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:22:06.380372 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:22:06.380372 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:22:06.380372 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:22:06.380372 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m14:22:06.382382 [info ] [MainThread]: 
[0m14:22:06.382382 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m14:22:06.386402 [debug] [MainThread]: Command end result
[0m14:22:06.416447 [info ] [MainThread]: 
[0m14:22:06.418448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:06.419446 [info ] [MainThread]: 
[0m14:22:06.419446 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:22:06.419446 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:06.419446 after 4.68 seconds
[0m14:22:06.419446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F627EEB9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F627E336E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F627E33680>]}
[0m14:22:06.423678 [debug] [MainThread]: Flushing usage events
[0m14:25:04.781107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09095310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0713C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F090964E0>]}


============================== 14:25:04.781107 | b1462961-5deb-43be-8d73-3f9da3531b42 ==============================
[0m14:25:04.781107 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:25:04.781107 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:25:05.336185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09589640>]}
[0m14:25:05.474292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0938BEF0>]}
[0m14:25:05.474292 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:25:05.490286 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:25:05.631749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:05.631749 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:25:05.821350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09BD6600>]}
[0m14:25:05.837177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0996C050>]}
[0m14:25:05.841602 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:25:05.841602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09AC5100>]}
[0m14:25:05.841602 [info ] [MainThread]: 
[0m14:25:05.841602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:05.841602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:25:05.852933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:25:05.872079 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:25:05.873668 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:25:05.874667 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:25:05.874667 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:25:05.874667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:05.874667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:06.820746 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:25:06.820746 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:25:06.837380 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:25:06.837380 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:25:06.920488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:25:06.937203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:25:06.949845 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:25:06.952455 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:25:06.954222 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:25:06.954222 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:25:06.954222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:06.954222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:07.383952 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:25:07.385979 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:25:07.395130 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:25:07.395130 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:25:07.483942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F090616D0>]}
[0m14:25:07.483942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:07.483942 [info ] [MainThread]: 
[0m14:25:07.489296 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:25:07.489296 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:25:07.489296 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:25:07.489296 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:25:07.489296 [info ] [Thread-1 (]: 1 of 6 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:25:07.496289 [info ] [Thread-2 (]: 2 of 6 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:25:07.499292 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:25:07.496289 [info ] [Thread-3 (]: 3 of 6 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:25:07.500293 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:25:07.498014 [info ] [Thread-4 (]: 4 of 6 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:25:07.501679 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:25:07.501999 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:25:07.505448 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:25:07.511443 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:25:07.511443 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:25:07.511443 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:25:07.522302 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:25:07.528128 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:25:07.530125 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:25:07.532931 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:25:07.534942 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:25:07.507444 => 14:25:07.534942
[0m14:25:07.534942 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:25:07.571464 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:25:07.571464 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:25:07.530125 => 14:25:07.571464
[0m14:25:07.571464 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:25:07.511443 => 14:25:07.571464
[0m14:25:07.571464 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:25:07.525116 => 14:25:07.571464
[0m14:25:07.571464 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:25:07.571464 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:25:07.584290 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:25:07.584290 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:25:07.592449 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:25:07.648849 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:25:07.649845 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:25:07.654164 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:25:07.654164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:07.654164 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:25:07.654164 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:25:07.654164 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:25:07.654164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:07.654164 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:25:07.654164 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:25:07.654164 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:25:07.654164 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:07.654164 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:08.095317 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:25:08.129651 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:25:07.592449 => 14:25:08.129651
[0m14:25:08.131651 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:25:08.132650 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:25:08.136678 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:25:07.584290 => 14:25:08.136678
[0m14:25:08.138431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:25:08.138431 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:25:08.138431 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:25:07.537316 => 14:25:08.138431
[0m14:25:08.138431 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:25:08.220450 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:25:08.221726 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:25:07.649845 => 14:25:08.221726
[0m14:25:08.221726 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:25:08.221726 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09AB19A0>]}
[0m14:25:08.221726 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09AB32C0>]}
[0m14:25:08.221726 [info ] [Thread-2 (]: 2 of 6 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m14:25:08.232802 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:25:08.221726 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m14:25:08.232802 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:25:08.236983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09AB3E60>]}
[0m14:25:08.238034 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.74s]
[0m14:25:08.239044 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:25:08.321645 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09AB1850>]}
[0m14:25:08.321645 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.82s]
[0m14:25:08.321645 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:25:08.321645 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m14:25:08.321645 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m14:25:08.321645 [info ] [Thread-2 (]: 5 of 6 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:25:08.321645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m14:25:08.321645 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:25:08.335372 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:25:08.321645 [info ] [Thread-4 (]: 6 of 6 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:25:08.337340 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_6)
[0m14:25:08.338273 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:25:08.342552 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:25:08.344044 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:25:08.321645 => 14:25:08.343522
[0m14:25:08.344044 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:25:08.350575 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:25:08.350575 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:25:08.338273 => 14:25:08.350575
[0m14:25:08.350575 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:25:08.356870 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:25:08.358869 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:25:08.359869 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:25:08.360871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:25:08.360871 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:25:08.360871 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    product_family,
    product_sub_family,
    total_revenue,
    DENSE RANK OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM product_revenue
  );
[0m14:25:08.360871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:25:08.787003 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:25:08.787003 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:25:08.345567 => 14:25:08.787003
[0m14:25:08.787003 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m14:25:08.851337 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01baffb7-0001-429e-0008-4d960001f6e6
[0m14:25:08.851337 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 15 unexpected 'OVER'.
syntax error line 20 at position 48 unexpected ')'.
[0m14:25:08.853347 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:25:08.350575 => 14:25:08.851337
[0m14:25:08.853347 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m14:25:08.880253 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09AB3F50>]}
[0m14:25:08.880253 [info ] [Thread-2 (]: 5 of 6 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.54s]
[0m14:25:08.880253 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:25:08.943686 [debug] [Thread-4 (]: Database Error in model rpt_6 (models\reporting\rpt_6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 15 unexpected 'OVER'.
  syntax error line 20 at position 48 unexpected ')'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_6.sql
[0m14:25:08.943686 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1462961-5deb-43be-8d73-3f9da3531b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F09C61DC0>]}
[0m14:25:08.943686 [error] [Thread-4 (]: 6 of 6 ERROR creating sql view model DESCHEMA_reporting.rpt_6 .................. [[31mERROR[0m in 0.61s]
[0m14:25:08.943686 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:25:08.943686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:25:08.943686 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:25:08.943686 [info ] [MainThread]: 
[0m14:25:08.943686 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m14:25:08.957777 [debug] [MainThread]: Command end result
[0m14:25:08.979365 [info ] [MainThread]: 
[0m14:25:08.979365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:25:08.979365 [info ] [MainThread]: 
[0m14:25:08.979365 [error] [MainThread]:   Database Error in model rpt_6 (models\reporting\rpt_6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 15 unexpected 'OVER'.
  syntax error line 20 at position 48 unexpected ')'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_6.sql
[0m14:25:08.979365 [info ] [MainThread]: 
[0m14:25:08.979365 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:25:08.979365 [debug] [MainThread]: Command `dbt run` failed at 14:25:08.979365 after 4.28 seconds
[0m14:25:08.979365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F07E017C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0938BEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F07D91370>]}
[0m14:25:08.979365 [debug] [MainThread]: Flushing usage events
[0m14:26:43.917995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC970B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC95F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC951C0>]}


============================== 14:26:43.934759 | df32fec7-c520-4e17-a500-0ce570d5bd43 ==============================
[0m14:26:43.934759 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:26:43.934759 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:26:44.550998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC5FA40>]}
[0m14:26:44.678223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC94B00>]}
[0m14:26:44.679228 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:26:44.691224 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:26:44.921083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:44.922052 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:26:45.113706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE73C7A0>]}
[0m14:26:45.127711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE56C170>]}
[0m14:26:45.128712 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:26:45.129707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE33D0A0>]}
[0m14:26:45.132708 [info ] [MainThread]: 
[0m14:26:45.134709 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:26:45.136943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:26:45.155343 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:26:45.157343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:26:45.157343 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:26:45.160377 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:26:45.161376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:45.161376 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:26:45.162375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:46.701521 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m14:26:46.705513 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:26:46.714022 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m14:26:46.717023 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:26:46.837208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:26:46.841022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:26:46.841022 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:26:46.853211 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:26:46.853211 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:26:46.853211 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:26:46.853211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:46.853211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:47.336706 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:26:47.336706 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:26:47.336706 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:26:47.336706 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:26:47.440915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE6FB740>]}
[0m14:26:47.440915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:26:47.442923 [info ] [MainThread]: 
[0m14:26:47.716360 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:26:47.716360 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:26:47.718368 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:26:47.722127 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:26:47.720119 [info ] [Thread-1 (]: 1 of 6 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:26:47.726145 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:26:47.722127 [info ] [Thread-2 (]: 2 of 6 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:26:47.726145 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:26:47.728153 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:26:47.722127 [info ] [Thread-3 (]: 3 of 6 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:26:47.724135 [info ] [Thread-4 (]: 4 of 6 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:26:47.757819 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:26:47.761821 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:26:47.764819 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:26:47.765820 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:26:47.776820 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:26:47.776820 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:26:47.777817 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:26:47.784818 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:26:47.790799 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:26:47.792812 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:26:47.728895 => 14:26:47.792812
[0m14:26:47.794825 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:26:47.806860 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:26:47.778818 => 14:26:47.806860
[0m14:26:47.808370 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:26:47.809383 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:26:47.784818 => 14:26:47.808370
[0m14:26:47.810384 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:26:47.766820 => 14:26:47.809383
[0m14:26:47.921646 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:26:47.922026 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:26:47.922026 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:26:47.922026 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:26:47.938741 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:26:47.938741 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:26:47.938741 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:26:47.938741 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:26:47.938741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:26:47.938741 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:26:47.938741 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:26:47.938741 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:26:47.938741 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:26:47.938741 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:26:47.954136 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:26:47.955187 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:26:47.955187 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:26:47.962808 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:26:48.372419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:26:48.407425 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:26:47.794825 => 14:26:48.407425
[0m14:26:48.408931 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:26:48.410937 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:26:48.414936 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:26:47.938741 => 14:26:48.413936
[0m14:26:48.414936 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:26:48.483212 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:26:48.488366 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:26:47.810384 => 14:26:48.487968
[0m14:26:48.489374 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:26:48.498187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE6C0560>]}
[0m14:26:48.498555 [info ] [Thread-2 (]: 2 of 6 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m14:26:48.501859 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:26:48.796819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE6B3E60>]}
[0m14:26:48.796819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFEA25BB0>]}
[0m14:26:48.796819 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 1.03s]
[0m14:26:48.811315 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:26:48.807904 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 1.07s]
[0m14:26:48.815323 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m14:26:48.818373 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:26:48.820373 [info ] [Thread-2 (]: 5 of 6 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:26:48.826236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m14:26:48.828223 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:26:48.851243 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:26:48.865824 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:26:48.829228 => 14:26:48.859774
[0m14:26:48.867838 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:26:48.880792 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:26:48.884811 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:26:48.886821 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:26:48.888257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:48.904944 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:26:48.908862 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:26:47.922026 => 14:26:48.908862
[0m14:26:48.908862 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:26:48.986962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE51B920>]}
[0m14:26:48.986962 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 1.22s]
[0m14:26:48.986962 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:26:48.986962 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_6
[0m14:26:48.986962 [info ] [Thread-3 (]: 6 of 6 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:26:48.986962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_6)
[0m14:26:48.986962 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:26:48.995953 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:26:48.995953 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:26:48.986962 => 14:26:48.995953
[0m14:26:48.995953 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:26:49.006964 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:26:49.010091 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:26:49.010091 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    product_family,
    product_sub_family,
    total_revenue,
    DENSE_RANK OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM product_revenue
  );
[0m14:26:49.012197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:49.351096 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:26:49.358778 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:26:48.867838 => 14:26:49.357771
[0m14:26:49.359797 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m14:26:49.438587 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE423B60>]}
[0m14:26:49.438587 [info ] [Thread-2 (]: 5 of 6 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m14:26:49.438587 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:26:49.513767 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01baffb8-0001-429b-0008-4d96000202ee
[0m14:26:49.514766 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001005 (42P13): SQL compilation error:
invalid function 'DENSE_RANK'
[0m14:26:49.515768 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:26:48.995953 => 14:26:49.515768
[0m14:26:49.516765 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: Close
[0m14:26:49.616543 [debug] [Thread-3 (]: Database Error in model rpt_6 (models\reporting\rpt_6.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'DENSE_RANK'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_6.sql
[0m14:26:49.618550 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df32fec7-c520-4e17-a500-0ce570d5bd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFE967B60>]}
[0m14:26:49.620561 [error] [Thread-3 (]: 6 of 6 ERROR creating sql view model DESCHEMA_reporting.rpt_6 .................. [[31mERROR[0m in 0.63s]
[0m14:26:49.622415 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:26:49.669274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:49.670275 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:26:49.671270 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:26:49.682530 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:26:49.684539 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:26:49.684539 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m14:26:49.684539 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:26:49.686549 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:26:49.686549 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m14:26:49.686549 [info ] [MainThread]: 
[0m14:26:49.713335 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m14:26:49.725339 [debug] [MainThread]: Command end result
[0m14:26:49.772370 [info ] [MainThread]: 
[0m14:26:49.778503 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:26:49.780747 [info ] [MainThread]: 
[0m14:26:49.782762 [error] [MainThread]:   Database Error in model rpt_6 (models\reporting\rpt_6.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'DENSE_RANK'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_6.sql
[0m14:26:49.782762 [info ] [MainThread]: 
[0m14:26:49.784773 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:26:49.788498 [debug] [MainThread]: Command `dbt run` failed at 14:26:49.788498 after 5.95 seconds
[0m14:26:49.791509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC5DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC5D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFDC5C410>]}
[0m14:26:49.793502 [debug] [MainThread]: Flushing usage events
[0m14:28:25.991578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2561670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2561910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B25627E0>]}


============================== 14:28:25.995604 | dc4492dc-d7b8-4031-8b35-9398367a237d ==============================
[0m14:28:25.995604 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:28:25.995604 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:28:26.596564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2C81370>]}
[0m14:28:26.720721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2BA6ED0>]}
[0m14:28:26.720721 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:28:26.736851 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:28:26.919118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:26.919118 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:28:27.124498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2FC02F0>]}
[0m14:28:27.147107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2E6C050>]}
[0m14:28:27.149578 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:28:27.149578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B300EC30>]}
[0m14:28:27.152279 [info ] [MainThread]: 
[0m14:28:27.152279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:27.156008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:28:27.165281 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:28:27.165281 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:28:27.165281 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:28:27.181107 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:28:27.165281 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:28:27.181107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:27.181107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:28.073845 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:28:28.075859 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:28:28.137113 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:28:28.139155 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:28:28.233450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:28:28.237215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:28:28.262120 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:28:28.264126 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:28:28.264126 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:28:28.264126 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:28:28.266133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:28.266133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:28.582189 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:28:28.584188 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:28:28.591743 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:28:28.594419 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:28:28.683764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2DF1160>]}
[0m14:28:28.684763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:28.686764 [info ] [MainThread]: 
[0m14:28:28.695153 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:28:28.696156 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:28:28.698555 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:28:28.699558 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:28:28.697157 [info ] [Thread-1 (]: 1 of 6 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:28:28.708322 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:28:28.708322 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:28:28.701560 [info ] [Thread-2 (]: 2 of 6 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:28:28.715371 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:28:28.716373 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:28:28.702557 [info ] [Thread-3 (]: 3 of 6 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:28:28.726587 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:28:28.732237 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:28:28.733236 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:28:28.703555 [info ] [Thread-4 (]: 4 of 6 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:28:28.735237 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:28:28.736239 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:28:28.759886 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:28:28.749835 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:28:28.727585 => 14:28:28.747816
[0m14:28:28.757878 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:28:28.709332 => 14:28:28.755862
[0m14:28:28.747816 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:28:28.767570 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:28:28.769570 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:28:28.774372 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:28:28.783756 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:28:28.741566 => 14:28:28.783756
[0m14:28:28.786557 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:28:28.762575 => 14:28:28.783756
[0m14:28:28.822405 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:28:28.823640 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:28:29.132279 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:28:29.143254 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:28:29.146254 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:28:29.150254 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:28:29.153257 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:28:29.154254 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:28:29.154778 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:28:29.156941 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:28:29.158940 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:28:29.159939 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:28:29.161939 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:28:29.162943 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:28:29.163938 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:28:29.163938 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:28:29.165941 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:28:29.166495 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:29.602657 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:28:29.640186 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:28:29.146254 => 14:28:29.640186
[0m14:28:29.642198 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:28:29.732384 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2FC3110>]}
[0m14:28:29.732384 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m14:28:29.734400 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:28:29.745009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:29.747019 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:29.751041 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:28:28.815305 => 14:28:29.751041
[0m14:28:29.757709 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:28:29.138092 => 14:28:29.757709
[0m14:28:29.762720 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:28:29.763720 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:28:29.764903 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:28:29.770643 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:28:28.778344 => 14:28:29.770643
[0m14:28:29.775097 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:28:29.872682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B23CC9E0>]}
[0m14:28:29.873819 [info ] [Thread-2 (]: 2 of 6 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 1.16s]
[0m14:28:29.875828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B32FC3E0>]}
[0m14:28:29.875828 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:28:29.879199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B32C8D10>]}
[0m14:28:29.879199 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 1.17s]
[0m14:28:29.881207 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:28:29.881207 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 1.14s]
[0m14:28:29.883215 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:28:29.883215 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m14:28:29.885227 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m14:28:29.885227 [info ] [Thread-4 (]: 5 of 6 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:28:29.885227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m14:28:29.885227 [info ] [Thread-2 (]: 6 of 6 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:28:29.885227 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:28:29.890842 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_6)
[0m14:28:29.895446 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:28:29.895446 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:28:29.899422 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:28:29.901433 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:28:29.895446 => 14:28:29.901433
[0m14:28:29.901433 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:28:29.909927 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:28:29.909927 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:28:29.891194 => 14:28:29.909927
[0m14:28:29.909927 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:28:29.917252 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:28:29.919262 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:28:29.919262 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    product_family,
    product_sub_family,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM product_revenue
  );
[0m14:28:29.919262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:28:29.924424 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:28:29.926671 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:28:29.926671 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:28:30.384718 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:28:30.387718 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:28:29.909927 => 14:28:30.387718
[0m14:28:30.388717 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m14:28:30.411609 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:28:30.418650 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:28:29.904016 => 14:28:30.417654
[0m14:28:30.419357 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m14:28:30.482216 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B32CA0C0>]}
[0m14:28:30.484145 [info ] [Thread-4 (]: 5 of 6 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.60s]
[0m14:28:30.487508 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:28:30.508839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4492dc-d7b8-4031-8b35-9398367a237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2FC2060>]}
[0m14:28:30.510384 [info ] [Thread-2 (]: 6 of 6 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.62s]
[0m14:28:30.511392 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:28:30.513395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:30.514428 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:28:30.515392 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:28:30.515392 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:28:30.515392 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:28:30.516391 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m14:28:30.516391 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:28:30.517390 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:28:30.517390 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:28:30.518390 [info ] [MainThread]: 
[0m14:28:30.519391 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m14:28:30.521392 [debug] [MainThread]: Command end result
[0m14:28:30.536122 [info ] [MainThread]: 
[0m14:28:30.537153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:30.538620 [info ] [MainThread]: 
[0m14:28:30.539775 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:28:30.541467 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:30.541467 after 4.63 seconds
[0m14:28:30.541467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B2473770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223ACCEBCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223ACB89010>]}
[0m14:28:30.542465 [debug] [MainThread]: Flushing usage events
[0m14:31:38.998912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34A96180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34A955E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34A946E0>]}


============================== 14:31:39.018853 | d3c2eae9-1175-4fb9-a880-cea3e8eb6eff ==============================
[0m14:31:39.018853 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:31:39.018853 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:31:42.694855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34955F10>]}
[0m14:31:42.812151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34EC9C70>]}
[0m14:31:42.822987 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:31:42.846457 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:31:44.577657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:31:44.578656 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:31:44.768865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34AB9DC0>]}
[0m14:31:44.798210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D353739E0>]}
[0m14:31:44.799653 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:31:44.801105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3550B5C0>]}
[0m14:31:44.802075 [info ] [MainThread]: 
[0m14:31:44.802075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:31:44.802075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:31:44.820270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:31:44.826868 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:31:44.837868 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:31:44.837868 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:31:44.838868 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:31:44.838868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:44.839867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:45.851363 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:31:45.851363 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:31:45.851363 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:31:45.851363 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:31:45.951121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:31:45.951121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:31:45.951121 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:31:45.967159 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:31:45.967870 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:31:45.967870 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:31:45.967870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:45.967870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:46.271276 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:31:46.273604 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:31:46.278877 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:31:46.281660 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:31:46.372637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D35598DD0>]}
[0m14:31:46.373640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:46.374640 [info ] [MainThread]: 
[0m14:31:46.379621 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:31:46.380621 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:31:46.381622 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:31:46.382621 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:31:46.381622 [info ] [Thread-1 (]: 1 of 6 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:31:46.383619 [info ] [Thread-2 (]: 2 of 6 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:31:46.387622 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:31:46.384625 [info ] [Thread-3 (]: 3 of 6 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:31:46.388619 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:31:46.389622 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:31:46.385621 [info ] [Thread-4 (]: 4 of 6 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:31:46.391623 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:31:46.392623 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:31:46.405916 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:31:46.406913 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:31:46.407912 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:31:46.412784 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:31:46.413786 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:31:46.418810 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:31:46.425982 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:31:46.427140 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:31:46.393621 => 14:31:46.427140
[0m14:31:46.428139 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:31:46.457336 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:31:46.409669 => 14:31:46.457336
[0m14:31:46.458486 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:31:46.421089 => 14:31:46.458486
[0m14:31:46.459200 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:31:46.413786 => 14:31:46.459200
[0m14:31:46.473300 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:31:46.476480 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:31:46.477479 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:31:46.478445 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:31:46.539279 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:31:46.543279 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:31:46.548277 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:31:46.551281 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:31:46.552887 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:31:46.552887 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:31:46.553896 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:31:46.556900 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:31:46.557897 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:31:46.558895 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:31:46.560895 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:31:46.561895 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:31:46.562897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:31:46.563896 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:31:46.563896 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:31:46.969608 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:31:47.017140 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:31:46.540280 => 14:31:47.017140
[0m14:31:47.018335 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:31:47.125644 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:31:47.129639 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:31:46.478445 => 14:31:47.128639
[0m14:31:47.129639 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:31:47.132641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:31:47.137915 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:31:46.428139 => 14:31:47.137915
[0m14:31:47.137915 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:31:47.231125 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:31:47.240689 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:31:46.544278 => 14:31:47.240689
[0m14:31:47.244719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D354C2300>]}
[0m14:31:47.246729 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:31:47.253369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D354C3440>]}
[0m14:31:47.246729 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m14:31:47.262208 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:31:47.258171 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.87s]
[0m14:31:47.264219 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:31:47.264219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D354C3440>]}
[0m14:31:47.266228 [info ] [Thread-2 (]: 2 of 6 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m14:31:47.271620 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:31:47.358181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D354C2AB0>]}
[0m14:31:47.359181 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.97s]
[0m14:31:47.361187 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:31:47.363183 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m14:31:47.364188 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_6
[0m14:31:47.365185 [info ] [Thread-4 (]: 5 of 6 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:31:47.367185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m14:31:47.370715 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:31:47.378705 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:31:47.366184 [info ] [Thread-1 (]: 6 of 6 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:31:47.383138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_6)
[0m14:31:47.383138 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:31:47.371724 => 14:31:47.383138
[0m14:31:47.386816 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:31:47.384423 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:31:47.394931 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:31:47.396941 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:31:47.407678 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:31:47.409697 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:31:47.411707 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:31:47.413718 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:31:47.394931 => 14:31:47.411707
[0m14:31:47.413718 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:31:47.424196 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:31:47.428985 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:31:47.428985 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family,
    total_revenue
FROM product_revenue
  );
[0m14:31:47.428985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:47.871596 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:31:47.875595 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:31:47.388829 => 14:31:47.875595
[0m14:31:47.876596 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m14:31:47.950889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:31:47.956659 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:31:47.415727 => 14:31:47.955659
[0m14:31:47.956659 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: Close
[0m14:31:47.963657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D354C3680>]}
[0m14:31:47.964657 [info ] [Thread-4 (]: 5 of 6 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.60s]
[0m14:31:47.965657 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:31:48.048745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c2eae9-1175-4fb9-a880-cea3e8eb6eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D357978C0>]}
[0m14:31:48.049748 [info ] [Thread-1 (]: 6 of 6 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.67s]
[0m14:31:48.050748 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:31:48.056060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:48.056060 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:31:48.057056 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:31:48.057056 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:31:48.058059 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:31:48.058059 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:31:48.059058 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_cust' was properly closed.
[0m14:31:48.059058 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:31:48.060059 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:31:48.060059 [info ] [MainThread]: 
[0m14:31:48.061057 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m14:31:48.065056 [debug] [MainThread]: Command end result
[0m14:31:48.089363 [info ] [MainThread]: 
[0m14:31:48.092363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:48.094362 [info ] [MainThread]: 
[0m14:31:48.096360 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:31:48.098359 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:48.098359 after 9.21 seconds
[0m14:31:48.101359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34989BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D34BF1E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D32755100>]}
[0m14:31:48.101359 [debug] [MainThread]: Flushing usage events
[0m14:34:32.827012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88D95520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88D95490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88D942F0>]}


============================== 14:34:32.833963 | 947ba7bd-d864-4a5d-8bea-1a14b777f523 ==============================
[0m14:34:32.833963 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:34:32.835051 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:34:33.461476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88B02300>]}
[0m14:34:33.586191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F89188B00>]}
[0m14:34:33.587472 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:34:33.599363 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:34:33.747508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:33.748507 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_6.sql
[0m14:34:33.938216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F898E2660>]}
[0m14:34:33.952913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8966C2F0>]}
[0m14:34:33.952913 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:34:33.952913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F89481970>]}
[0m14:34:33.965298 [info ] [MainThread]: 
[0m14:34:33.965298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:33.970027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:34:33.990604 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:34:33.991604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:34:33.992570 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:34:33.995604 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:34:33.995604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:33.996603 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:34:33.997604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:34.954971 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:34:34.954971 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:34:34.969438 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:34:34.975225 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:34:35.086204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:34:35.086204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:34:35.102891 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:34:35.102891 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:34:35.102891 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:34:35.102891 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:34:35.102891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:35.102891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:35.521700 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:34:35.523700 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:34:35.526701 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:34:35.528701 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:34:35.626432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F898F7380>]}
[0m14:34:35.628629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:35.667736 [info ] [MainThread]: 
[0m14:34:35.684891 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:34:35.691290 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:34:35.692291 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:34:35.688309 [info ] [Thread-1 (]: 1 of 6 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:34:35.695309 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:34:35.697891 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:34:35.691290 [info ] [Thread-2 (]: 2 of 6 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:34:35.700008 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:34:35.693290 [info ] [Thread-3 (]: 3 of 6 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:34:35.702009 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:34:35.700008 [info ] [Thread-4 (]: 4 of 6 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:34:35.709011 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:34:35.727344 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:34:35.729348 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:34:35.734357 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:34:35.738558 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:34:35.748547 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:34:35.749551 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:34:35.759549 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:34:35.761548 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:34:35.705029 => 14:34:35.760548
[0m14:34:35.766559 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:34:35.767558 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:34:35.782508 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:34:35.743563 => 14:34:35.782508
[0m14:34:35.782508 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:34:35.762551 => 14:34:35.782508
[0m14:34:35.817144 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:34:35.750550 => 14:34:35.817144
[0m14:34:35.818144 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:34:35.833152 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:34:35.834155 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:34:35.835154 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:34:35.846389 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:34:35.940639 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:34:35.944640 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:34:35.946853 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:34:35.947856 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:34:35.948855 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:35.949857 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:34:35.950853 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:34:35.951854 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:34:35.955317 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:34:35.957316 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:34:35.958315 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:34:35.959316 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:34:35.959316 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:34:35.963282 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:34:36.392023 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:34:36.426063 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:34:35.835154 => 14:34:36.426063
[0m14:34:36.427059 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:34:36.524506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F89B04DD0>]}
[0m14:34:36.525506 [info ] [Thread-2 (]: 2 of 6 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m14:34:36.526473 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:34:36.617901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:36.624899 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:34:35.768557 => 14:34:36.624899
[0m14:34:36.625899 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:34:36.631896 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:36.635897 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:34:35.847391 => 14:34:36.635897
[0m14:34:36.637690 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:34:36.699060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:36.705291 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:34:35.941637 => 14:34:36.703061
[0m14:34:36.707028 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:34:36.741347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F897B3B00>]}
[0m14:34:36.749348 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F897B2E70>]}
[0m14:34:36.742347 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 1.04s]
[0m14:34:36.762392 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:34:36.750350 [info ] [Thread-4 (]: 4 of 6 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m14:34:36.763393 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:34:36.821028 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F897B2C00>]}
[0m14:34:36.822030 [info ] [Thread-3 (]: 3 of 6 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 1.11s]
[0m14:34:36.846036 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:34:36.851032 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m14:34:36.853030 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_6
[0m14:34:36.852028 [info ] [Thread-2 (]: 5 of 6 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:34:36.870043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m14:34:36.873236 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:34:36.916799 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:34:36.858034 [info ] [Thread-1 (]: 6 of 6 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:34:36.920797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_6)
[0m14:34:36.923021 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:34:36.944999 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:34:36.952006 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:34:36.929896 => 14:34:36.948017
[0m14:34:36.953009 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:34:36.967394 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:34:36.968967 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:34:36.887758 => 14:34:36.968394
[0m14:34:36.970139 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:34:36.979060 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:34:36.981569 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:34:36.982581 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m14:34:36.983581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:36.989794 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:34:36.992777 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:34:36.994777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:34:37.466060 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:34:37.477397 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:34:36.970139 => 14:34:37.475384
[0m14:34:37.477397 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m14:34:37.506166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:37.510173 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:34:36.958391 => 14:34:37.510173
[0m14:34:37.510173 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: Close
[0m14:34:37.558570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F897B3530>]}
[0m14:34:37.558570 [info ] [Thread-2 (]: 5 of 6 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.69s]
[0m14:34:37.573982 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:34:37.601471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947ba7bd-d864-4a5d-8bea-1a14b777f523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F83D9A8A0>]}
[0m14:34:37.603479 [info ] [Thread-1 (]: 6 of 6 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.68s]
[0m14:34:37.605848 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:34:37.609841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:37.609841 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:34:37.610839 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:34:37.610839 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:34:37.610839 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:34:37.611840 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:34:37.611840 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:34:37.612840 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:34:37.612840 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_prod' was properly closed.
[0m14:34:37.613630 [info ] [MainThread]: 
[0m14:34:37.616945 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m14:34:37.619905 [debug] [MainThread]: Command end result
[0m14:34:37.641254 [info ] [MainThread]: 
[0m14:34:37.642257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:37.643258 [info ] [MainThread]: 
[0m14:34:37.644255 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:34:37.648776 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:37.647789 after 4.90 seconds
[0m14:34:37.648776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88988E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88A1F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88C73B60>]}
[0m14:34:37.649777 [debug] [MainThread]: Flushing usage events
[0m14:42:17.377152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FE95430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FE956D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FE961E0>]}


============================== 14:42:17.384160 | e8a38c37-b5ef-4dc4-a34f-c484052b66f1 ==============================
[0m14:42:17.384160 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:42:17.385176 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:42:17.978493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FB30FB0>]}
[0m14:42:18.113953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FB30FB0>]}
[0m14:42:18.113953 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:42:18.132988 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:42:18.281035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:42:18.281035 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_5.sql
[0m14:42:18.482801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1A16840>]}
[0m14:42:18.499604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1877E30>]}
[0m14:42:18.499604 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:42:18.499604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1877B30>]}
[0m14:42:18.499604 [info ] [MainThread]: 
[0m14:42:18.499604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:18.506185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:42:18.520996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:42:18.530346 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:42:18.535354 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:42:18.536355 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:42:18.537354 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:42:18.537354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:18.538250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:19.528765 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:42:19.530766 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:42:19.550527 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:42:19.550527 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:42:19.634540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:42:19.648870 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:42:19.648870 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:42:19.648870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:42:19.648870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:19.662525 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:42:19.664264 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:42:19.665591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:19.953348 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:42:19.953348 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:42:20.116273 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:42:20.116273 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:42:20.204725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1B82510>]}
[0m14:42:20.214014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:20.214014 [info ] [MainThread]: 
[0m14:42:20.217483 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:42:20.217483 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:42:20.217483 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:42:20.228781 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:42:20.217483 [info ] [Thread-1 (]: 1 of 7 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:42:20.217483 [info ] [Thread-2 (]: 2 of 7 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:42:20.234791 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:42:20.229830 [info ] [Thread-3 (]: 3 of 7 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:42:20.236794 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:42:20.237793 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:42:20.231794 [info ] [Thread-4 (]: 4 of 7 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:42:20.239792 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:42:20.240790 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:42:20.241824 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:42:20.254588 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:42:20.254588 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:42:20.261057 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:42:20.262004 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:42:20.265457 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:42:20.270999 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:42:20.273418 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:42:20.240790 => 14:42:20.271998
[0m14:42:20.273418 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:42:20.273418 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:42:20.255587 => 14:42:20.273418
[0m14:42:20.317423 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:42:20.318419 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:42:20.266466 => 14:42:20.317423
[0m14:42:20.318726 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:42:20.369138 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:42:20.369138 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:42:20.369138 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:42:20.262004 => 14:42:20.369138
[0m14:42:20.384120 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:42:20.387957 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:42:20.391974 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:42:20.391974 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:42:20.391974 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:42:20.395658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:20.399978 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:42:20.401006 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:42:20.402972 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:42:20.403383 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:42:20.403383 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:42:20.403383 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:42:20.403383 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:20.403383 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:20.403383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:42:20.834908 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:20.866630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:20.866630 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:42:20.382248 => 14:42:20.866630
[0m14:42:20.870562 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:42:20.273418 => 14:42:20.870562
[0m14:42:20.870562 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:42:20.870562 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:42:20.883366 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:20.883366 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:42:20.318726 => 14:42:20.883366
[0m14:42:20.883366 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:42:20.954115 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:42:20.965525 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:42:20.387957 => 14:42:20.954115
[0m14:42:20.966770 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:42:20.968780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1CD6450>]}
[0m14:42:20.972832 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A18768A0>]}
[0m14:42:20.970826 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.74s]
[0m14:42:20.972832 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:42:20.972832 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m14:42:20.972832 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:42:21.008968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1CBAF30>]}
[0m14:42:21.009942 [info ] [Thread-2 (]: 2 of 7 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m14:42:21.012941 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:42:21.068030 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1CE6960>]}
[0m14:42:21.068342 [info ] [Thread-3 (]: 3 of 7 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.83s]
[0m14:42:21.068342 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:42:21.070791 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m14:42:21.070791 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_5
[0m14:42:21.070791 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m14:42:21.070791 [info ] [Thread-1 (]: 5 of 7 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:42:21.077757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m14:42:21.070791 [info ] [Thread-4 (]: 6 of 7 START sql view model DESCHEMA_reporting.rpt_5 ........................... [RUN]
[0m14:42:21.078792 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:42:21.079601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_5)
[0m14:42:21.070791 [info ] [Thread-2 (]: 7 of 7 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:42:21.085589 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:42:21.085589 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_5
[0m14:42:21.086592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_6)
[0m14:42:21.091630 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m14:42:21.092588 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:42:21.097622 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:42:21.098588 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:42:21.080580 => 14:42:21.098588
[0m14:42:21.099590 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:42:21.104588 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:42:21.106590 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 14:42:21.087588 => 14:42:21.105588
[0m14:42:21.106590 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_5
[0m14:42:21.113589 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m14:42:21.114588 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:42:21.093591 => 14:42:21.113589
[0m14:42:21.116624 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:42:21.116624 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:42:21.117595 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:42:21.123465 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:42:21.123465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:21.123465 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m14:42:21.123465 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue;
[0m14:42:21.123465 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:21.133044 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:42:21.135530 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m14:42:21.135530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:21.557694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:21.569930 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:42:21.100589 => 14:42:21.569930
[0m14:42:21.570931 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m14:42:21.600581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:21.607804 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:42:21.118591 => 14:42:21.605797
[0m14:42:21.607804 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m14:42:21.656582 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01baffc8-0001-429b-0008-4d960002054a
[0m14:42:21.657614 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 21 unexpected ';'.
[0m14:42:21.657614 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 14:42:21.107591 => 14:42:21.657614
[0m14:42:21.658620 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_5: Close
[0m14:42:21.662656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1B42690>]}
[0m14:42:21.663656 [info ] [Thread-1 (]: 5 of 7 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.59s]
[0m14:42:21.664655 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:42:21.690462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1C72780>]}
[0m14:42:21.690462 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.60s]
[0m14:42:21.692627 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:42:21.750281 [debug] [Thread-4 (]: Database Error in model rpt_5 (models\reporting\rpt_5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_5.sql
[0m14:42:21.751290 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a38c37-b5ef-4dc4-a34f-c484052b66f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258A1752FC0>]}
[0m14:42:21.752323 [error] [Thread-4 (]: 6 of 7 ERROR creating sql view model DESCHEMA_reporting.rpt_5 .................. [[31mERROR[0m in 0.67s]
[0m14:42:21.753292 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_5
[0m14:42:21.756323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:21.757330 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:42:21.757330 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:42:21.757330 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:42:21.758371 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:42:21.758371 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:42:21.759371 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:42:21.759371 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:42:21.759371 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m14:42:21.760372 [info ] [MainThread]: 
[0m14:42:21.761336 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m14:42:21.764385 [debug] [MainThread]: Command end result
[0m14:42:21.776322 [info ] [MainThread]: 
[0m14:42:21.776322 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:21.776322 [info ] [MainThread]: 
[0m14:42:21.776322 [error] [MainThread]:   Database Error in model rpt_5 (models\reporting\rpt_5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_5.sql
[0m14:42:21.776322 [info ] [MainThread]: 
[0m14:42:21.776322 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:42:21.785626 [debug] [MainThread]: Command `dbt run` failed at 14:42:21.784624 after 4.50 seconds
[0m14:42:21.785626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589F9F24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FB337D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589FC9AB40>]}
[0m14:42:21.786627 [debug] [MainThread]: Flushing usage events
[0m14:42:29.444210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04361940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04361B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04360290>]}


============================== 14:42:29.445651 | 7dcc0047-c9bc-448c-aba2-3c84bf5d2f63 ==============================
[0m14:42:29.445651 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:42:29.445651 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:42:30.009069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04361E20>]}
[0m14:42:30.148482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0488FEF0>]}
[0m14:42:30.150490 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:42:30.162666 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:42:30.307331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:30.307331 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_5.sql
[0m14:42:30.488298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE043BD760>]}
[0m14:42:30.502581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04C6F980>]}
[0m14:42:30.502581 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:42:30.502581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04C6FD40>]}
[0m14:42:30.512448 [info ] [MainThread]: 
[0m14:42:30.512448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:30.512448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:42:30.528606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:42:30.535199 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:42:30.544107 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:42:30.547890 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:42:30.547890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:30.548892 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:42:30.549892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:31.167649 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:42:31.169649 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:42:31.172649 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:42:31.174683 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:42:31.265036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:42:31.268044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:42:31.283992 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:42:31.287338 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:42:31.287338 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:42:31.288373 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:42:31.288373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:31.288373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:31.763602 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:42:31.765637 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:42:31.766941 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:42:31.769974 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:42:31.869567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04EB7A70>]}
[0m14:42:31.870597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:31.871567 [info ] [MainThread]: 
[0m14:42:31.877272 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:42:31.878274 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:42:31.879317 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:42:31.878274 [info ] [Thread-1 (]: 1 of 7 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:42:31.880284 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:42:31.881281 [info ] [Thread-2 (]: 2 of 7 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:42:31.883282 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:42:31.881281 [info ] [Thread-3 (]: 3 of 7 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:42:31.885282 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:42:31.885282 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:42:31.883282 [info ] [Thread-4 (]: 4 of 7 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:42:31.887282 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:42:31.887282 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:42:31.898830 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:42:31.899799 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:42:31.900796 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:42:31.905683 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:42:31.906682 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:42:31.911012 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:42:31.917945 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:42:31.918945 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:42:31.888282 => 14:42:31.918945
[0m14:42:31.919910 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:42:31.931288 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:42:31.906682 => 14:42:31.931288
[0m14:42:31.932301 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:42:31.901105 => 14:42:31.931288
[0m14:42:32.000717 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:42:32.009301 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:42:32.025299 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:42:32.030298 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:42:32.031333 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:42:31.912014 => 14:42:32.030298
[0m14:42:32.035298 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:42:32.036298 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:42:32.041299 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:42:32.042299 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:42:32.043300 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:42:32.044302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:42:32.045299 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:42:32.046332 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:42:32.047299 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:32.048299 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:42:32.050592 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:42:32.053887 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:42:32.054850 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:42:32.055851 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:32.056851 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:32.500944 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:32.533612 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:42:32.031333 => 14:42:32.533612
[0m14:42:32.534927 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:42:32.536928 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:32.541228 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:42:32.037298 => 14:42:32.540232
[0m14:42:32.541228 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:42:32.596327 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:42:32.600628 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:42:32.025299 => 14:42:32.600628
[0m14:42:32.601629 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:42:32.605855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:42:32.609150 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:42:31.920911 => 14:42:32.609150
[0m14:42:32.610152 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:42:32.625193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE060A5700>]}
[0m14:42:32.625193 [info ] [Thread-2 (]: 2 of 7 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.74s]
[0m14:42:32.627193 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:42:32.630843 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE060A46B0>]}
[0m14:42:32.631843 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m14:42:32.633272 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:42:32.699616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE060C93D0>]}
[0m14:42:32.700984 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE060A5520>]}
[0m14:42:32.701985 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.82s]
[0m14:42:32.702985 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:42:32.701985 [info ] [Thread-3 (]: 3 of 7 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.81s]
[0m14:42:32.703985 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:42:32.705293 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m14:42:32.707303 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_5
[0m14:42:32.706335 [info ] [Thread-2 (]: 5 of 7 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:42:32.708300 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_6
[0m14:42:32.709300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m14:42:32.707303 [info ] [Thread-4 (]: 6 of 7 START sql view model DESCHEMA_reporting.rpt_5 ........................... [RUN]
[0m14:42:32.711302 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:42:32.712303 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_5)
[0m14:42:32.710302 [info ] [Thread-1 (]: 7 of 7 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:42:32.717303 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:42:32.718312 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_5
[0m14:42:32.719303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_6)
[0m14:42:32.723739 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m14:42:32.723739 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:42:32.730648 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:42:32.733646 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 14:42:32.720300 => 14:42:32.732671
[0m14:42:32.735647 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_5
[0m14:42:32.742648 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:42:32.713301 => 14:42:32.741653
[0m14:42:32.745645 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m14:42:32.746680 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:42:32.753647 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:42:32.755645 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:42:32.724704 => 14:42:32.754645
[0m14:42:32.755645 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:42:32.757677 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m14:42:32.762644 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:42:32.763411 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m14:42:32.766418 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:42:32.766418 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:32.767873 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:42:32.768875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:32.770874 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:42:32.773285 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m14:42:32.774286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:33.238594 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:42:33.244587 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:42:32.747647 => 14:42:33.244587
[0m14:42:33.246553 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m14:42:33.279920 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:42:33.286933 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 14:42:32.735647 => 14:42:33.285931
[0m14:42:33.288975 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_5: Close
[0m14:42:33.292933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:42:33.298875 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:42:32.757677 => 14:42:33.298875
[0m14:42:33.301874 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: Close
[0m14:42:33.348701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE060A4C50>]}
[0m14:42:33.349700 [info ] [Thread-2 (]: 5 of 7 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m14:42:33.351003 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:42:33.389203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04EB5FD0>]}
[0m14:42:33.390248 [info ] [Thread-4 (]: 6 of 7 OK created sql view model DESCHEMA_reporting.rpt_5 ...................... [[32mSUCCESS 1[0m in 0.68s]
[0m14:42:33.392214 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_5
[0m14:42:33.395249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcc0047-c9bc-448c-aba2-3c84bf5d2f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE060A51F0>]}
[0m14:42:33.396258 [info ] [Thread-1 (]: 7 of 7 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.68s]
[0m14:42:33.400261 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:42:33.404258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:33.405258 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:42:33.405258 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:42:33.406258 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:42:33.406258 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:42:33.407258 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:42:33.407258 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:42:33.408260 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_hotelbook' was properly closed.
[0m14:42:33.408656 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m14:42:33.408656 [info ] [MainThread]: 
[0m14:42:33.409656 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m14:42:33.413679 [debug] [MainThread]: Command end result
[0m14:42:33.433651 [info ] [MainThread]: 
[0m14:42:33.436343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:33.437346 [info ] [MainThread]: 
[0m14:42:33.438342 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:42:33.440811 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:33.440811 after 4.12 seconds
[0m14:42:33.440811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE02FD8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04394BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE02DDA4B0>]}
[0m14:42:33.441808 [debug] [MainThread]: Flushing usage events
[0m14:50:22.874082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140865DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140865DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140865DA90>]}


============================== 14:50:22.891035 | f99e359e-060c-4098-9eca-33311020fff1 ==============================
[0m14:50:22.891035 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:50:22.892042 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:50:26.792470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408E23440>]}
[0m14:50:26.914742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408D2FCB0>]}
[0m14:50:26.927722 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:50:26.955089 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:50:28.713950 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:50:28.714986 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_7.sql
[0m14:50:28.714986 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_5.sql
[0m14:50:28.915746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021409114DA0>]}
[0m14:50:28.949019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408FB8AD0>]}
[0m14:50:28.950019 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:50:28.951019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408DBBA70>]}
[0m14:50:28.953456 [info ] [MainThread]: 
[0m14:50:28.955454 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:28.956775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:50:28.971488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m14:50:28.977489 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:50:28.980939 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m14:50:28.981941 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:50:28.981941 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m14:50:28.982941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:28.983284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:30.400006 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:50:30.410728 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:50:30.417252 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:50:30.422743 [debug] [ThreadPool]: On list_NEWDB: Close
[0m14:50:30.516637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m14:50:30.516637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m14:50:30.543909 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m14:50:30.543909 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m14:50:30.548126 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m14:50:30.548126 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m14:50:30.548126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:30.548126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:30.875770 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:50:30.876849 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m14:50:31.108567 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:50:31.110578 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m14:50:31.235619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214091A2870>]}
[0m14:50:31.235619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:31.251423 [info ] [MainThread]: 
[0m14:50:31.269571 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m14:50:31.269571 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m14:50:31.283213 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m14:50:31.269571 [info ] [Thread-1 (]: 1 of 7 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m14:50:31.269571 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m14:50:31.283213 [info ] [Thread-2 (]: 2 of 7 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m14:50:31.283213 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m14:50:31.283213 [info ] [Thread-4 (]: 4 of 7 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m14:50:31.283213 [info ] [Thread-3 (]: 3 of 7 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m14:50:31.299232 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m14:50:31.299232 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m14:50:31.306392 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m14:50:31.306392 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m14:50:31.306392 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m14:50:31.347004 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m14:50:31.348981 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m14:50:31.354472 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m14:50:31.354472 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m14:50:31.354472 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m14:50:31.369783 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m14:50:31.369783 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 14:50:31.315404 => 14:50:31.369783
[0m14:50:31.369783 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m14:50:31.483549 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m14:50:31.483549 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 14:50:31.351009 => 14:50:31.483549
[0m14:50:31.483549 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 14:50:31.354472 => 14:50:31.483549
[0m14:50:31.493086 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m14:50:31.493086 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 14:50:31.354472 => 14:50:31.493086
[0m14:50:31.495098 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m14:50:31.499113 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m14:50:31.499113 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m14:50:31.501123 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m14:50:31.505141 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m14:50:31.509157 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m14:50:31.511165 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m14:50:31.511165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:31.514924 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m14:50:31.515931 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m14:50:31.517940 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:31.517940 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m14:50:31.519947 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m14:50:31.519947 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m14:50:31.521955 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m14:50:31.523962 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:31.523962 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:50:32.013700 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:50:32.048501 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 14:50:31.505141 => 14:50:32.046492
[0m14:50:32.048501 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m14:50:32.122075 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:50:32.138164 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 14:50:31.501123 => 14:50:32.138164
[0m14:50:32.138164 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m14:50:32.292397 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214092421E0>]}
[0m14:50:32.293787 [info ] [Thread-3 (]: 3 of 7 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.99s]
[0m14:50:32.296000 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m14:50:32.296965 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_1
[0m14:50:32.297964 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214091A31D0>]}
[0m14:50:32.296965 [info ] [Thread-3 (]: 5 of 7 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m14:50:32.299997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_1)
[0m14:50:32.299000 [info ] [Thread-4 (]: 4 of 7 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m14:50:32.300966 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_1
[0m14:50:32.301714 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m14:50:32.305792 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m14:50:32.307148 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m14:50:32.307148 [info ] [Thread-4 (]: 6 of 7 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m14:50:32.309149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_6)
[0m14:50:32.309538 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m14:50:32.313689 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m14:50:32.314653 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 14:50:32.301714 => 14:50:32.314653
[0m14:50:32.315689 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_1
[0m14:50:32.320275 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m14:50:32.322028 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 14:50:32.309538 => 14:50:32.321275
[0m14:50:32.322796 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m14:50:32.324900 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m14:50:32.329768 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m14:50:32.330771 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m14:50:32.331765 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:50:32.333733 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m14:50:32.336730 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m14:50:32.336730 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:50:32.355475 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:50:32.355475 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 14:50:31.495098 => 14:50:32.355475
[0m14:50:32.355475 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m14:50:32.415852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:50:32.420167 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 14:50:31.369783 => 14:50:32.418848
[0m14:50:32.420167 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m14:50:32.454589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408F17620>]}
[0m14:50:32.454589 [info ] [Thread-2 (]: 2 of 7 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 1.17s]
[0m14:50:32.460208 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m14:50:32.460208 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_7
[0m14:50:32.460208 [info ] [Thread-2 (]: 7 of 7 START sql view model DESCHEMA_reporting.rpt_7 ........................... [RUN]
[0m14:50:32.460208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_7)
[0m14:50:32.460208 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_7
[0m14:50:32.467239 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m14:50:32.470260 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 14:50:32.465230 => 14:50:32.470260
[0m14:50:32.470260 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_7
[0m14:50:32.476303 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m14:50:32.478313 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m14:50:32.480322 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m14:50:32.480322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:32.523010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214093120F0>]}
[0m14:50:32.523010 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 1.24s]
[0m14:50:32.534258 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m14:50:32.808356 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:50:32.808356 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 14:50:32.315689 => 14:50:32.808356
[0m14:50:32.808356 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_1: Close
[0m14:50:32.856137 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:50:32.873959 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 14:50:32.324900 => 14:50:32.871869
[0m14:50:32.873959 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m14:50:32.906189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214091A2780>]}
[0m14:50:32.908228 [info ] [Thread-3 (]: 5 of 7 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m14:50:32.910207 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_1
[0m14:50:32.955940 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408FB8B30>]}
[0m14:50:32.955940 [info ] [Thread-4 (]: 6 of 7 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.65s]
[0m14:50:32.955940 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m14:50:33.003455 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:50:33.003455 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 14:50:32.472273 => 14:50:33.003455
[0m14:50:33.003455 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: Close
[0m14:50:33.096957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99e359e-060c-4098-9eca-33311020fff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408F16B70>]}
[0m14:50:33.098968 [info ] [Thread-2 (]: 7 of 7 OK created sql view model DESCHEMA_reporting.rpt_7 ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m14:50:33.100980 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_7
[0m14:50:33.102991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:33.102991 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:50:33.107768 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m14:50:33.109787 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m14:50:33.111802 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m14:50:33.111802 [debug] [MainThread]: Connection 'model.data_engineering_project.stg_country' was properly closed.
[0m14:50:33.111802 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m14:50:33.111802 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m14:50:33.113815 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m14:50:33.113815 [info ] [MainThread]: 
[0m14:50:33.115825 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m14:50:33.119347 [debug] [MainThread]: Command end result
[0m14:50:33.194959 [info ] [MainThread]: 
[0m14:50:33.196969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:33.198978 [info ] [MainThread]: 
[0m14:50:33.200988 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:50:33.200988 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:33.200988 after 10.45 seconds
[0m14:50:33.200988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021402E0BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214086BAF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021408D2C650>]}
[0m14:50:33.200988 [debug] [MainThread]: Flushing usage events
[0m15:40:13.358941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD25DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD172390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD25DF40>]}


============================== 15:40:13.380156 | d7f3d601-e6bf-4852-a42f-b3d96148e794 ==============================
[0m15:40:13.380156 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:40:13.383190 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:40:17.156067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD93D0A0>]}
[0m15:40:17.273533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD8E4890>]}
[0m15:40:17.285479 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:40:17.308976 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:40:19.023814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:40:19.023814 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_5.sql
[0m15:40:19.217101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDDE7260>]}
[0m15:40:19.256928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDB68080>]}
[0m15:40:19.257942 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:40:19.259936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDCF34A0>]}
[0m15:40:19.263328 [info ] [MainThread]: 
[0m15:40:19.264293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:19.266471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m15:40:19.286910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m15:40:19.297921 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m15:40:19.300918 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m15:40:19.301921 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m15:40:19.302918 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m15:40:19.302918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:19.303919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.549621 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:40:20.551043 [debug] [ThreadPool]: On list_NEWDB: Close
[0m15:40:20.556383 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:40:20.558719 [debug] [ThreadPool]: On list_NEWDB: Close
[0m15:40:20.679121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m15:40:20.690176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m15:40:20.713223 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m15:40:20.714223 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m15:40:20.715221 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m15:40:20.715221 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m15:40:20.716223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.717223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:21.003818 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m15:40:21.009489 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m15:40:21.155693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:40:21.158731 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m15:40:21.246678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDEB6B40>]}
[0m15:40:21.247687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:21.248726 [info ] [MainThread]: 
[0m15:40:21.257141 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m15:40:21.258141 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m15:40:21.259139 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m15:40:21.260141 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m15:40:21.259139 [info ] [Thread-1 (]: 1 of 8 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m15:40:21.261139 [info ] [Thread-2 (]: 2 of 8 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m15:40:21.264478 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m15:40:21.262140 [info ] [Thread-3 (]: 3 of 8 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m15:40:21.265591 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m15:40:21.266590 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m15:40:21.263142 [info ] [Thread-4 (]: 4 of 8 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m15:40:21.268588 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m15:40:21.269587 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m15:40:21.270588 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m15:40:21.282593 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m15:40:21.284638 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m15:40:21.289592 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m15:40:21.290593 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m15:40:21.295625 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m15:40:21.301191 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m15:40:21.303142 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 15:40:21.269587 => 15:40:21.303142
[0m15:40:21.304141 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m15:40:21.305143 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 15:40:21.295625 => 15:40:21.305143
[0m15:40:21.307675 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 15:40:21.290593 => 15:40:21.306689
[0m15:40:21.308691 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 15:40:21.285617 => 15:40:21.307675
[0m15:40:21.335027 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m15:40:21.353061 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m15:40:21.354061 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m15:40:21.355062 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m15:40:21.416169 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m15:40:21.420456 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m15:40:21.424763 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m15:40:21.425985 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m15:40:21.426988 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m15:40:21.427987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:21.431986 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m15:40:21.431986 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m15:40:21.433020 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:40:21.435400 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m15:40:21.438399 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m15:40:21.438399 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m15:40:21.439751 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m15:40:21.440760 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:40:21.440760 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:40:21.885966 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:40:21.918488 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 15:40:21.421726 => 15:40:21.918488
[0m15:40:21.919484 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m15:40:21.922488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:40:21.923487 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:40:21.926720 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 15:40:21.309086 => 15:40:21.926720
[0m15:40:21.930686 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 15:40:21.355062 => 15:40:21.930686
[0m15:40:21.931670 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m15:40:21.933680 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m15:40:22.009953 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:40:22.012942 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 15:40:21.417422 => 15:40:22.012942
[0m15:40:22.013942 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m15:40:22.023940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDFA96D0>]}
[0m15:40:22.023940 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m15:40:22.025903 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m15:40:22.028623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDE3ED50>]}
[0m15:40:22.029613 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDFA9730>]}
[0m15:40:22.030590 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.77s]
[0m15:40:22.033485 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m15:40:22.031586 [info ] [Thread-4 (]: 4 of 8 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m15:40:22.035041 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m15:40:22.102989 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDFCDC70>]}
[0m15:40:22.104019 [info ] [Thread-3 (]: 3 of 8 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.84s]
[0m15:40:22.106019 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m15:40:22.106991 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m15:40:22.108023 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_5
[0m15:40:22.108995 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m15:40:22.106991 [info ] [Thread-2 (]: 5 of 8 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m15:40:22.110994 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m15:40:22.109993 [info ] [Thread-1 (]: 6 of 8 START sql view model DESCHEMA_reporting.rpt_5 ........................... [RUN]
[0m15:40:22.118014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m15:40:22.111998 [info ] [Thread-4 (]: 7 of 8 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m15:40:22.119993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_5)
[0m15:40:22.120989 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m15:40:22.118995 [info ] [Thread-3 (]: 8 of 8 START sql view model DESCHEMA_reporting.rpt_7 ........................... [RUN]
[0m15:40:22.121994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_6)
[0m15:40:22.122994 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_5
[0m15:40:22.129992 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m15:40:22.130992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_7)
[0m15:40:22.131993 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m15:40:22.135993 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m15:40:22.136995 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m15:40:22.142991 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m15:40:22.146994 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m15:40:22.148995 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 15:40:22.123993 => 15:40:22.147991
[0m15:40:22.150996 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m15:40:22.152931 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m15:40:22.152931 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 15:40:22.132992 => 15:40:22.152931
[0m15:40:22.152931 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_5
[0m15:40:22.152931 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 15:40:22.143994 => 15:40:22.152931
[0m15:40:22.166253 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m15:40:22.169249 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m15:40:22.169249 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m15:40:22.170248 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 15:40:22.137994 => 15:40:22.170248
[0m15:40:22.171253 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m15:40:22.176248 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m15:40:22.176248 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m15:40:22.177285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:22.178250 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m15:40:22.183502 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m15:40:22.184500 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m15:40:22.187500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:22.188500 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m15:40:22.189533 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m15:40:22.191535 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m15:40:22.192533 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:22.193532 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m15:40:22.194532 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:22.661856 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:40:22.666869 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 15:40:22.151403 => 15:40:22.666869
[0m15:40:22.667869 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m15:40:22.669902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:40:22.673903 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 15:40:22.152931 => 15:40:22.672901
[0m15:40:22.673903 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: Close
[0m15:40:22.697575 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:40:22.702740 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 15:40:22.172252 => 15:40:22.701739
[0m15:40:22.702740 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m15:40:22.742842 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:40:22.744850 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 15:40:22.179251 => 15:40:22.744850
[0m15:40:22.744850 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m15:40:22.754574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDB6B770>]}
[0m15:40:22.754574 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DESCHEMA_reporting.rpt_5 ...................... [[32mSUCCESS 1[0m in 0.63s]
[0m15:40:22.756934 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_5
[0m15:40:22.759934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDB1BEC0>]}
[0m15:40:22.759934 [info ] [Thread-2 (]: 5 of 8 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m15:40:22.761903 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m15:40:22.790498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDFFC380>]}
[0m15:40:22.791499 [info ] [Thread-3 (]: 8 of 8 OK created sql view model DESCHEMA_reporting.rpt_7 ...................... [[32mSUCCESS 1[0m in 0.66s]
[0m15:40:22.793499 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m15:40:22.836312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f3d601-e6bf-4852-a42f-b3d96148e794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDDBC5C0>]}
[0m15:40:22.836312 [info ] [Thread-4 (]: 7 of 8 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.72s]
[0m15:40:22.838321 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m15:40:22.838321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m15:40:22.838321 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m15:40:22.838321 [info ] [MainThread]: 
[0m15:40:22.838321 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m15:40:22.849342 [debug] [MainThread]: Command end result
[0m15:40:22.865895 [info ] [MainThread]: 
[0m15:40:22.866906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:22.868907 [info ] [MainThread]: 
[0m15:40:22.869904 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:40:22.872962 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:22.872962 after 9.64 seconds
[0m15:40:22.873970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD172390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD669040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD188590>]}
[0m15:40:22.873970 [debug] [MainThread]: Flushing usage events
[0m15:58:37.062816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268326652E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268326654F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026832665100>]}


============================== 15:58:37.084547 | d2a90394-b629-412b-a2ff-ce11bd366bf4 ==============================
[0m15:58:37.084547 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:58:37.085863 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:58:41.018364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2a90394-b629-412b-a2ff-ce11bd366bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026832D2FCB0>]}
[0m15:58:41.139027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2a90394-b629-412b-a2ff-ce11bd366bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268327B0230>]}
[0m15:58:41.143124 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:58:41.183283 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:58:42.893295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:58:42.893295 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_2.1.sql
[0m15:58:43.084696 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_engineering_project.rpt_2.1' (models\reporting\rpt_2.1.sql) depends on a node named 'customer_sales' which was not found
[0m15:58:43.084696 [debug] [MainThread]: Command `dbt run` failed at 15:58:43.084696 after 6.18 seconds
[0m15:58:43.084696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026832667BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268330F6A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268330F7F50>]}
[0m15:58:43.084696 [debug] [MainThread]: Flushing usage events
[0m16:02:10.046502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5B5616A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5B5618E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5B5628D0>]}


============================== 16:02:10.062224 | fee57f60-8c9d-42ad-a8e3-5546b0cee71e ==============================
[0m16:02:10.062224 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:02:10.062224 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:02:13.514811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5B59A780>]}
[0m16:02:13.625915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5BBA73B0>]}
[0m16:02:13.642078 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:02:13.672465 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:02:15.187671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:02:15.189679 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_2.1.sql
[0m16:02:15.376763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C0E7320>]}
[0m16:02:15.404123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5BE680E0>]}
[0m16:02:15.407307 [info ] [MainThread]: Found 9 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:02:15.407307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5BFF6FF0>]}
[0m16:02:15.409875 [info ] [MainThread]: 
[0m16:02:15.409875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:02:15.413062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:02:15.424606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:02:15.434482 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:02:15.434482 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:02:15.434482 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:02:15.434482 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:02:15.434482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:15.439295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:16.648981 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:02:16.650988 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:02:16.694698 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:02:16.701199 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:02:16.798363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:02:16.798363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:02:16.798363 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:02:16.814339 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:02:16.814339 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:02:16.814339 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:02:16.814339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:16.814339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:17.274508 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:02:17.274508 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:02:17.285886 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:02:17.285886 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:02:17.381967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C0FF7A0>]}
[0m16:02:17.381967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:17.381967 [info ] [MainThread]: 
[0m16:02:17.402608 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:02:17.403608 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:02:17.406021 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:02:17.406021 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:02:17.404607 [info ] [Thread-1 (]: 1 of 9 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m16:02:17.410138 [info ] [Thread-2 (]: 2 of 9 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m16:02:17.414179 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:02:17.410813 [info ] [Thread-3 (]: 3 of 9 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m16:02:17.415145 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:02:17.413145 [info ] [Thread-4 (]: 4 of 9 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m16:02:17.416144 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:02:17.417180 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:02:17.417180 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:02:17.417180 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:02:17.426672 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:02:17.431671 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:02:17.436010 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:02:17.436010 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:02:17.437043 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:02:17.445354 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:02:17.447351 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:02:17.432007 => 16:02:17.447351
[0m16:02:17.451827 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:02:17.417180 => 16:02:17.450803
[0m16:02:17.451827 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:02:17.452818 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:02:17.453818 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:02:17.437043 => 16:02:17.453818
[0m16:02:17.454818 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:02:17.441342 => 16:02:17.453818
[0m16:02:17.542196 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:02:17.542196 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:02:17.542196 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:02:17.542196 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:02:17.561346 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:02:17.566387 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:02:17.567347 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:02:17.568349 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:02:17.569381 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:02:17.570348 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:02:17.571347 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:02:17.572347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:17.572347 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:02:17.573349 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:02:17.575226 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:02:17.575226 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:02:17.575226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:02:17.575226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:02:17.979969 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:17.995232 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:18.011072 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:02:17.562347 => 16:02:18.011072
[0m16:02:18.026779 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:02:18.026779 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:02:17.454818 => 16:02:18.025039
[0m16:02:18.026779 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:02:18.042788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:18.042788 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:02:17.492390 => 16:02:18.042788
[0m16:02:18.042788 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:02:18.104949 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:18.108703 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:02:17.557913 => 16:02:18.108703
[0m16:02:18.108703 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:02:18.114704 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C2BEC60>]}
[0m16:02:18.114704 [info ] [Thread-4 (]: 4 of 9 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:02:18.123675 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:02:18.126686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C2BCC20>]}
[0m16:02:18.127687 [info ] [Thread-2 (]: 2 of 9 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:02:18.128687 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:02:18.151368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C0BA390>]}
[0m16:02:18.152366 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.74s]
[0m16:02:18.155403 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:02:18.194089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5BF34410>]}
[0m16:02:18.194089 [info ] [Thread-3 (]: 3 of 9 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.78s]
[0m16:02:18.194089 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:02:18.209777 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:02:18.210735 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2.1
[0m16:02:18.210735 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_5
[0m16:02:18.212768 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_6
[0m16:02:18.211768 [info ] [Thread-4 (]: 5 of 9 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m16:02:18.213736 [info ] [Thread-2 (]: 6 of 9 START sql view model DESCHEMA_reporting.rpt_2.1 ......................... [RUN]
[0m16:02:18.216735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:02:18.214735 [info ] [Thread-1 (]: 7 of 9 START sql view model DESCHEMA_reporting.rpt_5 ........................... [RUN]
[0m16:02:18.217738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2.1)
[0m16:02:18.218768 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:02:18.215735 [info ] [Thread-3 (]: 8 of 9 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m16:02:18.221215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_5)
[0m16:02:18.222630 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2.1
[0m16:02:18.228631 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:02:18.229634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_6)
[0m16:02:18.230631 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:02:18.237259 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2.1"
[0m16:02:18.238257 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:02:18.244098 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:02:18.249082 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:02:18.252245 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:02:18.222630 => 16:02:18.250082
[0m16:02:18.252245 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:02:18.252245 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:02:18.259824 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2.1 (compile): 16:02:18.230631 => 16:02:18.258813
[0m16:02:18.260825 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2.1
[0m16:02:18.262913 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2.1"
[0m16:02:18.262913 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:02:18.239257 => 16:02:18.262913
[0m16:02:18.262913 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:02:18.245078 => 16:02:18.262913
[0m16:02:18.262913 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:02:18.262913 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:02:18.277027 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:02:18.280986 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:02:18.282183 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:02:18.283192 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:02:18.284192 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2.1"
[0m16:02:18.285193 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:18.286190 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2.1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2.1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2.1
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        customer_id,
        COUNT(product_id)     AS num_products_bought,
        SUM(revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        customer_id
),
highest_cross_sell AS (
    SELECT
        customer_id,
        num_products_bought,
        total_spent,
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:02:18.289226 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:02:18.291225 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:02:18.291225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:18.292194 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:02:18.292194 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:02:18.293426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:18.294393 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:02:18.803972 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:18.813626 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:02:18.252245 => 16:02:18.813626
[0m16:02:18.813626 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:02:18.829383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:18.835549 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:02:18.262913 => 16:02:18.835549
[0m16:02:18.835549 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: Close
[0m16:02:18.851681 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb0018-0001-429a-0008-4d9600021706
[0m16:02:18.851681 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 55 unexpected '.1'.
[0m16:02:18.851681 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2.1 (execute): 16:02:18.260825 => 16:02:18.851681
[0m16:02:18.851681 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2.1: Close
[0m16:02:18.888366 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:02:18.901515 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:02:18.278021 => 16:02:18.901515
[0m16:02:18.903532 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: Close
[0m16:02:18.903532 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C2BF0B0>]}
[0m16:02:18.903532 [info ] [Thread-4 (]: 5 of 9 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:02:18.915176 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:02:18.915176 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_7
[0m16:02:18.915176 [info ] [Thread-4 (]: 9 of 9 START sql view model DESCHEMA_reporting.rpt_7 ........................... [RUN]
[0m16:02:18.915176 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:02:18.915176 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:02:18.915176 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:02:18.915176 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:02:18.915176 => 16:02:18.915176
[0m16:02:18.915176 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:02:18.915176 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:02:18.934051 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:02:18.934404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C2A8110>]}
[0m16:02:18.935503 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:02:18.937462 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:02:18.936462 [info ] [Thread-1 (]: 7 of 9 OK created sql view model DESCHEMA_reporting.rpt_5 ...................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:02:18.938150 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:02:18.968119 [debug] [Thread-2 (]: Database Error in model rpt_2.1 (models\reporting\rpt_2.1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 55 unexpected '.1'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2.1.sql
[0m16:02:18.968119 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C0FF560>]}
[0m16:02:18.968119 [error] [Thread-2 (]: 6 of 9 ERROR creating sql view model DESCHEMA_reporting.rpt_2.1 ................ [[31mERROR[0m in 0.75s]
[0m16:02:18.968119 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2.1
[0m16:02:18.999883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5C0FC170>]}
[0m16:02:18.999883 [info ] [Thread-3 (]: 8 of 9 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:02:19.002103 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:02:19.429518 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:02:19.433277 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:02:18.915176 => 16:02:19.433277
[0m16:02:19.433277 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: Close
[0m16:02:19.524898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee57f60-8c9d-42ad-a8e3-5546b0cee71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5BFB5910>]}
[0m16:02:19.526923 [info ] [Thread-4 (]: 9 of 9 OK created sql view model DESCHEMA_reporting.rpt_7 ...................... [[32mSUCCESS 1[0m in 0.61s]
[0m16:02:19.530725 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:02:19.530725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2.1' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:02:19.530725 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:02:19.530725 [info ] [MainThread]: 
[0m16:02:19.530725 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m16:02:19.548603 [debug] [MainThread]: Command end result
[0m16:02:19.564816 [info ] [MainThread]: 
[0m16:02:19.565814 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:19.566815 [info ] [MainThread]: 
[0m16:02:19.567847 [error] [MainThread]:   Database Error in model rpt_2.1 (models\reporting\rpt_2.1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 55 unexpected '.1'.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2.1.sql
[0m16:02:19.567847 [info ] [MainThread]: 
[0m16:02:19.568847 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m16:02:19.571251 [debug] [MainThread]: Command `dbt run` failed at 16:02:19.571251 after 9.64 seconds
[0m16:02:19.571251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5B473590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5987F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D59742B40>]}
[0m16:02:19.572298 [debug] [MainThread]: Flushing usage events
[0m16:03:47.310572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BCA5C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BCA5D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BCA5E390>]}


============================== 16:03:47.323916 | fa68a91b-4066-48c6-a3f2-2bdb94ae56f5 ==============================
[0m16:03:47.323916 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:03:47.323916 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:03:47.874486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD1BF170>]}
[0m16:03:47.995027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BCBF0EC0>]}
[0m16:03:47.995027 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:03:48.006867 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:03:48.129190 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:03:48.129190 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:03:48.129190 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_2.1.sql
[0m16:03:48.330375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD509A00>]}
[0m16:03:48.344285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD368140>]}
[0m16:03:48.345322 [info ] [MainThread]: Found 9 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:03:48.346283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD251F70>]}
[0m16:03:48.349074 [info ] [MainThread]: 
[0m16:03:48.350726 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:48.352232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:03:48.359240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:03:48.376714 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:03:48.378681 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:03:48.381836 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:03:48.382849 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:03:48.383847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:48.384850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:49.316701 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:03:49.321060 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:03:49.341874 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:03:49.341874 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:03:49.428243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:03:49.428243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:03:49.449372 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:03:49.457615 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:03:49.457615 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:03:49.457615 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:03:49.460279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:49.460279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:49.774005 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:03:49.785232 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:03:49.815889 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:03:49.818030 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:03:49.898176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD4F7440>]}
[0m16:03:49.913900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:49.913900 [info ] [MainThread]: 
[0m16:03:49.913900 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:03:49.913900 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:03:49.913900 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:03:49.913900 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:03:49.913900 [info ] [Thread-1 (]: 1 of 9 START sql view model DESCHEMA_staging.stg_country ....................... [RUN]
[0m16:03:49.924104 [info ] [Thread-2 (]: 2 of 9 START sql view model DESCHEMA_staging.stg_cust .......................... [RUN]
[0m16:03:49.926466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:03:49.925113 [info ] [Thread-3 (]: 3 of 9 START sql view model DESCHEMA_staging.stg_hotelbook ..................... [RUN]
[0m16:03:49.928531 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:03:49.929528 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:03:49.925113 [info ] [Thread-4 (]: 4 of 9 START sql view model DESCHEMA_staging.stg_prod .......................... [RUN]
[0m16:03:49.930528 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:03:49.931428 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:03:49.935017 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:03:49.941026 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:03:49.941026 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:03:49.950003 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:03:49.950003 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:03:49.955482 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:03:49.958482 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:03:49.958482 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:03:49.931428 => 16:03:49.958482
[0m16:03:49.958482 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:03:49.973265 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:03:49.951141 => 16:03:49.973265
[0m16:03:50.050943 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:03:49.941026 => 16:03:50.050587
[0m16:03:50.050943 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:03:50.050943 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:03:50.050943 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:03:49.956483 => 16:03:50.050943
[0m16:03:50.050943 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:03:50.063699 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:03:50.063699 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:03:50.068075 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:03:50.073075 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:03:50.074040 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:03:50.075076 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:03:50.075076 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:50.077044 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:03:50.080040 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:03:50.081075 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:03:50.081075 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:03:50.083041 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:03:50.083623 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:03:50.083623 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:03:50.083623 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:50.083623 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:03:50.496335 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:03:50.527790 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:03:50.063699 => 16:03:50.527790
[0m16:03:50.527790 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:03:50.560342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:03:50.568411 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:03:49.958482 => 16:03:50.568411
[0m16:03:50.568411 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:03:50.572426 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:03:50.577218 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:03:50.069081 => 16:03:50.577218
[0m16:03:50.577218 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:03:50.616969 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:03:50.616969 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:03:50.050943 => 16:03:50.616969
[0m16:03:50.616969 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:03:50.616969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD5BB8C0>]}
[0m16:03:50.616969 [info ] [Thread-2 (]: 2 of 9 OK created sql view model DESCHEMA_staging.stg_cust ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:03:50.616969 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:03:50.659373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD7CE990>]}
[0m16:03:50.660373 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DESCHEMA_staging.stg_country .................. [[32mSUCCESS 1[0m in 0.73s]
[0m16:03:50.661373 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:03:50.668407 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD7A7530>]}
[0m16:03:50.668407 [info ] [Thread-4 (]: 4 of 9 OK created sql view model DESCHEMA_staging.stg_prod ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m16:03:50.668407 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:03:50.720112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD790AD0>]}
[0m16:03:50.722129 [info ] [Thread-3 (]: 3 of 9 OK created sql view model DESCHEMA_staging.stg_hotelbook ................ [[32mSUCCESS 1[0m in 0.79s]
[0m16:03:50.726149 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:03:50.726149 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:03:50.742834 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:03:50.742834 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_5
[0m16:03:50.742834 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_6
[0m16:03:50.726149 [info ] [Thread-2 (]: 5 of 9 START sql view model DESCHEMA_reporting.rpt_1 ........................... [RUN]
[0m16:03:50.748862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:03:50.748862 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:03:50.755483 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:03:50.757500 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:03:50.749872 => 16:03:50.757500
[0m16:03:50.759509 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:03:50.744842 [info ] [Thread-1 (]: 6 of 9 START sql view model DESCHEMA_reporting.rpt_2a .......................... [RUN]
[0m16:03:50.765545 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:03:50.746851 [info ] [Thread-4 (]: 7 of 9 START sql view model DESCHEMA_reporting.rpt_5 ........................... [RUN]
[0m16:03:50.746851 [info ] [Thread-3 (]: 8 of 9 START sql view model DESCHEMA_reporting.rpt_6 ........................... [RUN]
[0m16:03:50.772199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2a)
[0m16:03:50.772199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_5)
[0m16:03:50.772199 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_6)
[0m16:03:50.772199 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:03:50.772199 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:03:50.772199 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:03:50.772199 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:03:50.789254 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:03:50.803671 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:03:50.784296 => 16:03:50.803671
[0m16:03:50.797303 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:03:50.801659 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:03:50.797303 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:03:50.805685 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:03:50.805685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:50.807695 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:03:50.772199 => 16:03:50.807695
[0m16:03:50.813088 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:03:50.814088 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:03:50.815057 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:03:50.791265 => 16:03:50.815057
[0m16:03:50.822379 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:03:50.824389 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:03:50.824389 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:03:50.824389 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:03:50.824389 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:03:50.833258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:50.835080 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:03:50.835080 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        customer_id,
        COUNT(product_id)     AS num_products_bought,
        SUM(revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        customer_id
),
highest_cross_sell AS (
    SELECT
        customer_id,
        num_products_bought,
        total_spent,
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:03:50.835080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:50.835080 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:03:50.835080 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:03:50.835080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:51.292337 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:03:51.292337 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:03:50.759509 => 16:03:51.292337
[0m16:03:51.292337 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:03:51.292337 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:03:51.308189 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:03:50.807695 => 16:03:51.308189
[0m16:03:51.308189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:03:51.308189 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_5: Close
[0m16:03:51.308189 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:03:50.816055 => 16:03:51.308189
[0m16:03:51.308189 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:03:51.421367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD7A6E70>]}
[0m16:03:51.421367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD7A5DF0>]}
[0m16:03:51.421367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD31B8C0>]}
[0m16:03:51.433156 [info ] [Thread-4 (]: 7 of 9 OK created sql view model DESCHEMA_reporting.rpt_5 ...................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:03:51.437549 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:03:51.433156 [info ] [Thread-2 (]: 5 of 9 OK created sql view model DESCHEMA_reporting.rpt_1 ...................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:03:51.445627 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_7
[0m16:03:51.448622 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:03:51.437549 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DESCHEMA_reporting.rpt_2a ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:03:51.452814 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:03:51.450291 [info ] [Thread-4 (]: 9 of 9 START sql view model DESCHEMA_reporting.rpt_7 ........................... [RUN]
[0m16:03:51.455840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_7)
[0m16:03:51.456630 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:03:51.463805 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:03:51.463805 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:03:51.457400 => 16:03:51.463805
[0m16:03:51.463805 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:03:51.470980 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:03:51.470980 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:03:51.475983 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:03:51.475983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:51.585374 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:03:51.585374 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:03:50.824389 => 16:03:51.585374
[0m16:03:51.594113 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: Close
[0m16:03:51.683157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD5B9280>]}
[0m16:03:51.683157 [info ] [Thread-3 (]: 8 of 9 OK created sql view model DESCHEMA_reporting.rpt_6 ...................... [[32mSUCCESS 1[0m in 0.91s]
[0m16:03:51.683157 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:03:52.017796 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:03:52.033762 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:03:51.463805 => 16:03:52.033762
[0m16:03:52.033762 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: Close
[0m16:03:52.129724 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa68a91b-4066-48c6-a3f2-2bdb94ae56f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD4B1F40>]}
[0m16:03:52.129724 [info ] [Thread-4 (]: 9 of 9 OK created sql view model DESCHEMA_reporting.rpt_7 ...................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:03:52.129724 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:03:52.129724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:03:52.129724 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:03:52.145658 [info ] [MainThread]: 
[0m16:03:52.146938 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m16:03:52.151421 [debug] [MainThread]: Command end result
[0m16:03:52.160336 [info ] [MainThread]: 
[0m16:03:52.160336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:52.170381 [info ] [MainThread]: 
[0m16:03:52.172062 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m16:03:52.174741 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:52.173640 after 4.93 seconds
[0m16:03:52.174741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD1F93A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD07FE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD4C45F0>]}
[0m16:03:52.174741 [debug] [MainThread]: Flushing usage events
[0m16:09:12.041816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024939F618E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024939F61AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024939F613A0>]}


============================== 16:09:12.047815 | f7faf553-ec2c-4e94-b606-df1b3bc12928 ==============================
[0m16:09:12.047815 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:09:12.048788 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:09:12.628836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B55A990>]}
[0m16:09:12.753994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024939B52300>]}
[0m16:09:12.755975 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:09:12.767753 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:09:12.935751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:09:12.935751 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\rpt_2b.sql
[0m16:09:13.154953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B721C40>]}
[0m16:09:13.170995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B813A40>]}
[0m16:09:13.170995 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:09:13.170995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B9C70E0>]}
[0m16:09:13.170995 [info ] [MainThread]: 
[0m16:09:13.170995 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:13.170995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:09:13.186971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:09:13.201252 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:09:13.204218 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:09:13.205221 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:09:13.205221 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:09:13.206219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:13.206625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:14.141790 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:09:14.141790 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:09:14.159395 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:09:14.162356 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:09:14.257452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:09:14.273852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:09:14.284667 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:09:14.289685 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:09:14.290277 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:09:14.290277 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:09:14.290277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:14.290277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:14.712646 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:09:14.715684 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:09:14.773096 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:09:14.773096 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:09:14.858319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BB7FA10>]}
[0m16:09:14.858319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:14.858319 [info ] [MainThread]: 
[0m16:09:14.858319 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:09:14.858319 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:09:14.858319 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:09:14.858319 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:09:14.858319 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:09:14.876440 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:09:14.874446 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:09:14.875439 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:09:14.878440 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:09:14.879440 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:09:14.877437 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:09:14.882033 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:09:14.883902 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:09:14.896371 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:09:14.897374 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:09:14.898117 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:09:14.903430 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:09:14.904433 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:09:14.910939 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:09:14.914940 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:09:14.914940 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:09:14.882413 => 16:09:14.914940
[0m16:09:14.914940 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:09:14.914940 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:09:14.899388 => 16:09:14.914940
[0m16:09:14.958980 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:09:14.904433 => 16:09:14.956967
[0m16:09:14.958980 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:09:14.910939 => 16:09:14.958980
[0m16:09:14.958980 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:09:14.958980 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:09:14.958980 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:09:14.958980 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:09:15.025176 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:09:15.025176 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:09:15.042049 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:09:15.045812 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:09:15.045812 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:09:15.045812 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:09:15.045812 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:09:15.045812 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:09:15.045812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:09:15.050701 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:09:15.050701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:15.050701 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:09:15.052707 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:09:15.055717 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:15.055717 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:15.474836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:15.506347 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:09:14.914940 => 16:09:15.506347
[0m16:09:15.508258 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:09:15.508258 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:15.508258 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:09:15.025176 => 16:09:15.508258
[0m16:09:15.508258 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:09:15.508258 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:15.508258 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:09:14.958980 => 16:09:15.508258
[0m16:09:15.508258 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:09:15.592088 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:15.592088 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:09:15.025176 => 16:09:15.592088
[0m16:09:15.592088 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:09:15.614460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B909010>]}
[0m16:09:15.614460 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BCE3890>]}
[0m16:09:15.614460 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.74s]
[0m16:09:15.614460 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:09:15.614460 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:09:15.614460 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:09:15.614460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BCE3680>]}
[0m16:09:15.614460 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.74s]
[0m16:09:15.625018 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:09:15.679785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B9095B0>]}
[0m16:09:15.679785 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.80s]
[0m16:09:15.679785 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:09:15.679785 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m16:09:15.679785 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:09:15.679785 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:09:15.679785 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:09:15.679785 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:09:15.694256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m16:09:15.695256 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:09:15.700253 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:09:15.679785 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:09:15.702252 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m16:09:15.702252 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:09:15.708255 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:09:15.679785 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:09:15.692015 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:09:15.711266 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:09:15.703256 => 16:09:15.711266
[0m16:09:15.713264 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:09:15.695256 => 16:09:15.713264
[0m16:09:15.717648 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2b)
[0m16:09:15.719434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:09:15.719434 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:09:15.720430 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:09:15.721434 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:09:15.721434 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:09:15.727544 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:09:15.733544 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:09:15.737540 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:09:15.744546 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:09:15.746542 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:09:15.734548 => 16:09:15.746542
[0m16:09:15.747542 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:09:15.738540 => 16:09:15.747542
[0m16:09:15.748544 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:09:15.749543 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:09:15.750542 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:09:15.755577 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:09:15.757576 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:09:15.762593 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:09:15.763581 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        customer_id,
        COUNT(product_id)     AS num_products_bought,
        SUM(revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        customer_id
),
highest_cross_sell AS (
    SELECT
        customer_id,
        num_products_bought,
        total_spent,
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:09:15.764547 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:09:15.765548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:15.766547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:15.769579 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:09:15.772576 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:09:15.773576 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:09:15.776577 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:09:15.776577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:15.777577 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:16.226594 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:16.240793 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:09:15.751543 => 16:09:16.240793
[0m16:09:16.243559 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:09:16.247605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:16.265157 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:09:15.728543 => 16:09:16.265157
[0m16:09:16.267993 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m16:09:16.271192 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:09:16.278631 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:09:15.758545 => 16:09:16.278631
[0m16:09:16.279629 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:09:16.282627 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:16.287629 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:09:15.722432 => 16:09:16.286628
[0m16:09:16.288630 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:09:16.347219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493801A3F0>]}
[0m16:09:16.348422 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:09:16.348422 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:09:16.348422 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:09:16.348422 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:09:16.348422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_6)
[0m16:09:16.348422 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:09:16.359449 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:09:16.361503 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:09:16.348422 => 16:09:16.361503
[0m16:09:16.362504 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:09:16.366506 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:09:16.368502 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:09:16.369537 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:09:16.370504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:16.388481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BDAF080>]}
[0m16:09:16.394131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BD3EF60>]}
[0m16:09:16.396130 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BAF9580>]}
[0m16:09:16.388481 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:09:16.405131 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:09:16.397129 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:09:16.406130 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_7
[0m16:09:16.409530 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:09:16.399126 [info ] [Thread-4 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:09:16.416560 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:09:16.413563 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:09:16.422437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:09:16.490054 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:09:16.553493 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:09:16.567210 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:09:16.491054 => 16:09:16.565195
[0m16:09:16.567210 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:09:16.629963 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:09:16.638014 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:09:16.640023 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:09:16.657441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:17.110676 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:17.110676 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:09:16.362504 => 16:09:17.110676
[0m16:09:17.110676 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:09:17.162349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:09:17.166349 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:09:16.573253 => 16:09:17.165348
[0m16:09:17.167349 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: Close
[0m16:09:17.239280 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BCE0380>]}
[0m16:09:17.240281 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m16:09:17.241281 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:09:17.243285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7faf553-ec2c-4e94-b606-df1b3bc12928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493BD14050>]}
[0m16:09:17.243285 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.82s]
[0m16:09:17.243285 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:09:17.261285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:17.261285 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:09:17.261285 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:09:17.261285 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:09:17.263295 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:09:17.263295 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:09:17.263295 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:09:17.263295 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:09:17.263295 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:09:17.263295 [info ] [MainThread]: 
[0m16:09:17.263295 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m16:09:17.270996 [debug] [MainThread]: Command end result
[0m16:09:17.292679 [info ] [MainThread]: 
[0m16:09:17.294689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:17.294689 [info ] [MainThread]: 
[0m16:09:17.296698 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:09:17.298745 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:17.298745 after 5.35 seconds
[0m16:09:17.300753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024939C8F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024939C43EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493B33BB30>]}
[0m16:09:17.300753 [debug] [MainThread]: Flushing usage events
[0m16:35:39.109146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B205DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B205DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B205D8E0>]}


============================== 16:35:39.130222 | 4f8d21b5-5c68-403e-8479-48622f8c8239 ==============================
[0m16:35:39.130222 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:35:39.131224 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:35:42.882583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2821E20>]}
[0m16:35:43.001481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2468FB0>]}
[0m16:35:43.012317 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:35:43.038388 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:35:44.726847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:44.727847 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:35:44.923221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2BE7BC0>]}
[0m16:35:44.952936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B29BC860>]}
[0m16:35:44.953331 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:35:44.954332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B20BD6A0>]}
[0m16:35:44.957365 [info ] [MainThread]: 
[0m16:35:44.958770 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:44.960771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:35:44.980645 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:35:44.981636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:35:44.982646 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:35:44.985233 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:35:44.986201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:44.986201 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:35:44.987234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.160169 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:35:46.168931 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:35:46.197875 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:35:46.200918 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:35:46.293838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:35:46.298836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:35:46.309833 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:35:46.312842 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:35:46.313833 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:35:46.314833 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:35:46.314833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.315799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.655250 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:35:46.657470 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:35:46.810837 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:35:46.812834 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:35:46.908389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2C67BC0>]}
[0m16:35:46.909701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:46.910700 [info ] [MainThread]: 
[0m16:35:46.920450 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:35:46.921450 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:35:46.922477 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:35:46.922477 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:35:46.923452 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:35:46.924671 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:35:46.926709 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:35:46.925672 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:35:46.928708 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:35:46.930671 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:35:46.931676 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:35:46.932671 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:35:46.927671 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:35:46.946002 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:35:46.947000 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:35:46.950998 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:35:46.953074 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:35:46.957373 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:35:46.958339 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:35:46.966384 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:35:46.967384 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:35:46.947998 => 16:35:46.966384
[0m16:35:46.967384 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:35:46.968862 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:35:46.933672 => 16:35:46.968412
[0m16:35:47.007396 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:35:46.954043 => 16:35:47.007396
[0m16:35:47.013865 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:35:47.013865 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:35:47.015096 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:35:47.016138 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:35:46.959378 => 16:35:47.015096
[0m16:35:47.074694 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:35:47.079118 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:35:47.079118 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:35:47.081084 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:35:47.085477 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:35:47.086444 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:35:47.087787 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:35:47.088787 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:35:47.089789 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:35:47.090786 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:35:47.092127 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:35:47.093170 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:35:47.095471 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:35:47.096178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:47.097189 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:35:47.099221 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:35:47.535400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:35:47.554137 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:35:47.565835 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:35:47.016138 => 16:35:47.565835
[0m16:35:47.569125 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:35:47.081084 => 16:35:47.569125
[0m16:35:47.570124 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:35:47.571391 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:35:47.572413 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:35:47.576883 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:35:46.968862 => 16:35:47.576883
[0m16:35:47.578928 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:35:47.664737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2DB9970>]}
[0m16:35:47.665739 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.74s]
[0m16:35:47.668089 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:35:47.671558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2DB93D0>]}
[0m16:35:47.672600 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:35:47.674565 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:35:47.684640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2DB8E90>]}
[0m16:35:47.686107 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.76s]
[0m16:35:47.689108 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:35:47.691140 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:47.696664 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:35:47.074694 => 16:35:47.695696
[0m16:35:47.696664 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:35:47.793992 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2A35550>]}
[0m16:35:47.795366 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.86s]
[0m16:35:47.796369 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:35:47.797369 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m16:35:47.798401 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:35:47.798401 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:35:47.799696 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:35:47.800731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m16:35:47.801697 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:35:47.803697 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:35:47.799696 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:35:47.802694 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:35:47.810069 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:35:47.812058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m16:35:47.813057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2b)
[0m16:35:47.804699 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:35:47.814092 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:35:47.815054 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:35:47.816054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:35:47.820533 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:35:47.823852 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:35:47.824894 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:35:47.804699 => 16:35:47.824894
[0m16:35:47.824894 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:35:47.826853 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:35:47.830852 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:35:47.836369 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:35:47.837372 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:35:47.816054 => 16:35:47.837372
[0m16:35:47.838332 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:35:47.820533 => 16:35:47.838332
[0m16:35:47.839333 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:35:47.840332 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:35:47.846368 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:35:47.826853 => 16:35:47.846368
[0m16:35:47.848332 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:35:47.851367 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:35:47.855709 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:35:47.855709 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:35:47.856709 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:35:47.862595 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:35:47.863596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:47.867141 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:35:47.868080 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:35:47.869076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:47.871868 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:35:47.875565 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:35:47.877615 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:35:47.879661 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:35:47.880625 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:35:47.881661 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:35:48.324799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:35:48.338393 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:35:47.831887 => 16:35:48.337390
[0m16:35:48.340384 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m16:35:48.389367 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:48.393710 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:35:47.851367 => 16:35:48.393710
[0m16:35:48.394757 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:35:48.424851 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:48.428854 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:35:47.857583 => 16:35:48.428854
[0m16:35:48.429855 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:35:48.437681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2BF1970>]}
[0m16:35:48.438680 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:35:48.439648 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:35:48.441023 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_6
[0m16:35:48.441023 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:35:48.443024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m16:35:48.444023 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:35:48.448451 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:35:48.451743 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:35:48.444023 => 16:35:48.451743
[0m16:35:48.452776 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:35:48.457083 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:35:48.460086 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:35:48.461087 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:35:48.462084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:48.506303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2BB0C50>]}
[0m16:35:48.507307 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:35:48.509303 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:35:48.510304 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_7
[0m16:35:48.511308 [info ] [Thread-2 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:35:48.513303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m16:35:48.514303 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:35:48.518304 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:35:48.519304 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:35:48.514303 => 16:35:48.519304
[0m16:35:48.520307 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:35:48.525313 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:35:48.527304 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:35:48.528304 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:35:48.528304 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:35:48.534305 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2BB2B10>]}
[0m16:35:48.535305 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:35:48.536304 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:35:48.596975 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb0039-0001-429e-0008-4d960001fffe
[0m16:35:48.597999 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_ID'
[0m16:35:48.598984 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:35:47.840332 => 16:35:48.598984
[0m16:35:48.599982 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:35:48.704084 [debug] [Thread-4 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:35:48.705081 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2A045C0>]}
[0m16:35:48.705432 [error] [Thread-4 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.89s]
[0m16:35:48.706430 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:35:49.002974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:49.006337 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:35:48.452776 => 16:35:49.006337
[0m16:35:49.006337 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: Close
[0m16:35:49.075708 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:49.082865 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:35:48.520307 => 16:35:49.082865
[0m16:35:49.083900 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: Close
[0m16:35:49.108397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AF11AA50>]}
[0m16:35:49.109397 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:35:49.110809 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:35:49.186194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f8d21b5-5c68-403e-8479-48622f8c8239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B2BB1F10>]}
[0m16:35:49.187194 [info ] [Thread-2 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:35:49.188159 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:35:49.190531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:49.191531 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:35:49.191531 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:35:49.191531 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:35:49.192532 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:35:49.192532 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:35:49.192532 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:35:49.194037 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:35:49.194461 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:35:49.194461 [info ] [MainThread]: 
[0m16:35:49.195570 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m16:35:49.198577 [debug] [MainThread]: Command end result
[0m16:35:49.216567 [info ] [MainThread]: 
[0m16:35:49.217575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:35:49.218565 [info ] [MainThread]: 
[0m16:35:49.219566 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:35:49.220566 [info ] [MainThread]: 
[0m16:35:49.221600 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:35:49.223599 [debug] [MainThread]: Command `dbt run` failed at 16:35:49.223599 after 10.23 seconds
[0m16:35:49.223599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B04DC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B26E5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170B0CD8A10>]}
[0m16:35:49.224599 [debug] [MainThread]: Flushing usage events
[0m16:36:34.651498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020702E65730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020702E65910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020702E652E0>]}


============================== 16:36:34.658026 | 58093570-cd0e-4e6a-98b0-0be444262443 ==============================
[0m16:36:34.658026 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:36:34.660031 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:36:35.199711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070353DE80>]}
[0m16:36:35.311017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207032FFC80>]}
[0m16:36:35.311017 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:36:35.326662 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:36:35.475156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:36:35.475156 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:36:35.659997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703719400>]}
[0m16:36:35.671553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207037BCA10>]}
[0m16:36:35.671553 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:36:35.679892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070328A750>]}
[0m16:36:35.679892 [info ] [MainThread]: 
[0m16:36:35.679892 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:36:35.679892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:36:35.687506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:36:35.709849 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:36:35.709849 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:36:35.709849 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:36:35.709849 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:36:35.709849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:35.709849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:36.561775 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:36:36.561775 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:36:36.589473 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:36:36.589473 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:36:36.689492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:36:36.689492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:36:36.713671 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:36:36.713671 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:36:36.721340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:36.721340 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:36:36.721340 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:36:36.721340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:37.177724 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:36:37.179728 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:36:37.184725 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:36:37.186756 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:36:37.272818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703A82510>]}
[0m16:36:37.272818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:37.272818 [info ] [MainThread]: 
[0m16:36:37.272818 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:36:37.272818 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:36:37.288620 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:36:37.272818 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:36:37.272818 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:36:37.289842 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:36:37.292851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:36:37.290852 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:36:37.294894 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:36:37.295892 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:36:37.293896 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:36:37.297708 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:36:37.298054 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:36:37.300991 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:36:37.313003 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:36:37.313003 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:36:37.317093 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:36:37.318133 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:36:37.322135 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:36:37.326044 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:36:37.326044 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:36:37.299576 => 16:36:37.326044
[0m16:36:37.330331 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:36:37.330331 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:36:37.313003 => 16:36:37.330331
[0m16:36:37.358732 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:36:37.322135 => 16:36:37.357966
[0m16:36:37.376679 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:36:37.376679 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:36:37.377669 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:36:37.319101 => 16:36:37.377669
[0m16:36:37.378702 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:36:37.437386 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:36:37.438353 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:36:37.442709 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:36:37.443309 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:36:37.448369 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:36:37.449880 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:36:37.449880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:37.449880 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:36:37.449880 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:36:37.449880 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:36:37.459891 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:36:37.460902 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:36:37.461918 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:36:37.462928 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:36:37.463469 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:36:37.463469 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:36:37.909674 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:36:37.943176 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:36:37.444380 => 16:36:37.943176
[0m16:36:37.943176 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:36:37.943176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:36:37.943176 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:36:37.330331 => 16:36:37.943176
[0m16:36:37.943176 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:36:37.943176 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:36:37.943176 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:36:37.378702 => 16:36:37.943176
[0m16:36:37.959854 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:36:38.011414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:38.028509 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:36:37.438353 => 16:36:38.027037
[0m16:36:38.028509 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:36:38.044757 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703C0BDA0>]}
[0m16:36:38.048503 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.75s]
[0m16:36:38.048503 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:36:38.053166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703C25280>]}
[0m16:36:38.053166 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.76s]
[0m16:36:38.056135 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:36:38.058185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703C248C0>]}
[0m16:36:38.059141 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.77s]
[0m16:36:38.061156 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:36:38.122098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703C24C80>]}
[0m16:36:38.122098 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.82s]
[0m16:36:38.124105 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:36:38.127182 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:36:38.129181 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:36:38.128196 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:36:38.129925 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:36:38.131138 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:36:38.133149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:36:38.132151 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:36:38.134151 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:36:38.136149 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:36:38.136149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2a)
[0m16:36:38.135150 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:36:38.136149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m16:36:38.142769 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:36:38.143858 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:36:38.144854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:36:38.145855 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:36:38.151461 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:36:38.152973 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:36:38.156981 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:36:38.162717 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:36:38.163715 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:36:38.136149 => 16:36:38.162717
[0m16:36:38.163715 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:36:38.169625 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:36:38.169625 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:36:38.146856 => 16:36:38.169625
[0m16:36:38.169625 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:36:38.178824 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:36:38.181855 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:36:38.156981 => 16:36:38.181855
[0m16:36:38.181855 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:36:38.153987 => 16:36:38.181855
[0m16:36:38.181855 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:36:38.181855 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:36:38.181855 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:36:38.181855 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:36:38.194932 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:36:38.196965 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:36:38.197931 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:36:38.197931 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(h.current_date, -12)
    GROUP BY
        c.customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:36:38.198970 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:38.199933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:38.200933 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:36:38.201967 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:36:38.202934 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:38.204970 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:36:38.206939 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:36:38.208932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:38.714676 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb003a-0001-429b-0008-4d9600020a56
[0m16:36:38.714676 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 36
invalid identifier 'H.CURRENT_DATE'
[0m16:36:38.714676 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:36:38.169625 => 16:36:38.714676
[0m16:36:38.714676 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:36:38.714676 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:38.727302 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:36:38.165224 => 16:36:38.727302
[0m16:36:38.727302 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:36:38.727302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:38.746325 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:36:38.181855 => 16:36:38.745331
[0m16:36:38.746325 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:36:38.766111 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:38.778996 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:36:38.181855 => 16:36:38.778996
[0m16:36:38.779994 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:36:38.827746 [debug] [Thread-2 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  000904 (42000): SQL compilation error: error line 14 at position 36
  invalid identifier 'H.CURRENT_DATE'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:36:38.827746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703CCE120>]}
[0m16:36:38.827746 [error] [Thread-2 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.69s]
[0m16:36:38.842460 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:36:38.844535 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020703CCE540>]}
[0m16:36:38.844535 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:36:38.844535 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:36:38.850091 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:36:38.844535 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:36:38.851101 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_7
[0m16:36:38.852756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2a, now model.data_engineering_project.rpt_6)
[0m16:36:38.854754 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:36:38.855936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077DE9AC60>]}
[0m16:36:38.859523 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:36:38.853753 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:36:38.862488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:36:38.861486 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:36:38.863489 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:36:38.864491 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:36:38.869012 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:36:38.873276 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:36:38.856273 => 16:36:38.871282
[0m16:36:38.874267 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:36:38.880945 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:36:38.881946 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:36:38.864491 => 16:36:38.881946
[0m16:36:38.882946 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:36:38.889469 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:36:38.891468 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:36:38.891468 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:36:38.893558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:38.897570 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:36:38.898569 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207039E7C80>]}
[0m16:36:38.899568 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:36:38.902220 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:38.901572 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m16:36:38.907277 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:36:39.413434 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:39.423084 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:36:38.882946 => 16:36:39.423084
[0m16:36:39.425083 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: Close
[0m16:36:39.428575 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:36:39.433691 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:36:38.874267 => 16:36:39.433691
[0m16:36:39.434691 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:36:39.526537 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077DEC2C60>]}
[0m16:36:39.528002 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:36:39.529836 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:36:39.534832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58093570-cd0e-4e6a-98b0-0be444262443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207038C8DD0>]}
[0m16:36:39.536172 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:36:39.537391 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:36:39.540388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:39.540388 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:36:39.541389 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:36:39.541389 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:36:39.542388 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:36:39.542388 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:36:39.542388 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:36:39.543389 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:36:39.544363 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:36:39.544769 [info ] [MainThread]: 
[0m16:36:39.545568 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m16:36:39.549134 [debug] [MainThread]: Command end result
[0m16:36:39.569537 [info ] [MainThread]: 
[0m16:36:39.570548 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:39.571549 [info ] [MainThread]: 
[0m16:36:39.572548 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  000904 (42000): SQL compilation error: error line 14 at position 36
  invalid identifier 'H.CURRENT_DATE'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:36:39.573548 [info ] [MainThread]: 
[0m16:36:39.574547 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:36:39.577110 [debug] [MainThread]: Command `dbt run` failed at 16:36:39.577110 after 5.00 seconds
[0m16:36:39.580118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020702860A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020702D36B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020702D34E60>]}
[0m16:36:39.580118 [debug] [MainThread]: Flushing usage events
[0m16:37:06.784888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92BD5D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92BD5D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92BD5E840>]}


============================== 16:37:06.797956 | 5934cc2b-1a98-426b-8821-e6607a4c3c67 ==============================
[0m16:37:06.797956 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:37:06.797956 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:37:07.338744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C481E20>]}
[0m16:37:07.459777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92BD94710>]}
[0m16:37:07.459777 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:37:07.476894 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:37:07.618650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:07.618650 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:37:07.791793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C7CAB70>]}
[0m16:37:07.807743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C6BC8C0>]}
[0m16:37:07.807743 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:37:07.820004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C3A7170>]}
[0m16:37:07.820004 [info ] [MainThread]: 
[0m16:37:07.823741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:07.823741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:37:07.840416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:37:07.844636 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:37:07.848414 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:37:07.848414 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:37:07.850462 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:37:07.850462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:07.851504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:08.813256 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:37:08.815262 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:37:08.857201 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:37:08.859211 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:37:08.960002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:37:08.963557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:37:08.975516 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:37:08.976514 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:37:08.977551 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:37:08.978518 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:37:08.978518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:08.979551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:09.426390 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:37:09.429422 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:37:09.437527 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:37:09.437527 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:37:09.524715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C5CCCB0>]}
[0m16:37:09.540167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:37:09.540167 [info ] [MainThread]: 
[0m16:37:09.540167 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:37:09.540167 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:37:09.540167 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:37:09.540167 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:37:09.540167 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:37:09.552382 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:37:09.555209 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:37:09.553143 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:37:09.557865 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:37:09.558873 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:37:09.556212 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:37:09.560440 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:37:09.560880 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:37:09.565203 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:37:09.574909 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:37:09.574909 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:37:09.583334 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:37:09.583334 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:37:09.583334 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:37:09.595642 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:37:09.596641 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:37:09.560880 => 16:37:09.596641
[0m16:37:09.597638 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:37:09.640102 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:37:09.583334 => 16:37:09.640102
[0m16:37:09.640883 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:37:09.583334 => 16:37:09.640883
[0m16:37:09.641758 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:37:09.641758 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:37:09.574909 => 16:37:09.641758
[0m16:37:09.641758 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:37:09.641758 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:37:09.641758 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:37:09.706288 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:37:09.707633 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:37:09.707633 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:37:09.707633 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:37:09.707633 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:37:09.707633 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:37:09.707633 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:09.707633 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:37:09.707633 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:37:09.707633 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:37:09.722961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:37:09.722961 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:37:09.722961 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:37:09.722961 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:37:09.722961 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:37:10.225207 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:10.241958 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:37:09.707633 => 16:37:10.241958
[0m16:37:10.241958 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:37:10.265261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:10.270851 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:37:09.597638 => 16:37:10.270851
[0m16:37:10.270851 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:37:10.275321 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:10.275321 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:37:09.706288 => 16:37:10.275321
[0m16:37:10.275321 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:37:10.354151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92CAA9190>]}
[0m16:37:10.356161 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.80s]
[0m16:37:10.357670 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:37:10.379597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C7348F0>]}
[0m16:37:10.380599 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.82s]
[0m16:37:10.381595 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:37:10.390247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C734E90>]}
[0m16:37:10.391642 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.83s]
[0m16:37:10.395513 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:37:10.412314 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:10.417314 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:37:09.641758 => 16:37:10.417314
[0m16:37:10.418510 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:37:10.509240 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C704C20>]}
[0m16:37:10.509240 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.95s]
[0m16:37:10.524563 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:37:10.525211 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:37:10.527220 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:37:10.526253 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:37:10.528254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:37:10.529253 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:37:10.533254 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:37:10.534255 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:37:10.534255 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:37:10.527220 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:37:10.537473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2a)
[0m16:37:10.538648 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:37:10.546257 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:37:10.535220 [info ] [Thread-4 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:37:10.548247 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:37:10.529253 => 16:37:10.547292
[0m16:37:10.549283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2b)
[0m16:37:10.536437 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:37:10.550246 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:37:10.551255 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:37:10.552292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:37:10.557288 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:37:10.557288 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:37:10.539681 => 16:37:10.557288
[0m16:37:10.562289 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:37:10.563289 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:37:10.564289 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:37:10.567810 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:37:10.574773 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:37:10.577891 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:37:10.579907 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:37:10.565258 => 16:37:10.579907
[0m16:37:10.579907 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:37:10.558252 => 16:37:10.579907
[0m16:37:10.579907 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:37:10.579907 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:37:10.579907 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:37:10.579907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:37:10.586916 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:37:10.586916 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:37:10.592498 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:37:10.592498 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:37:10.592498 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:37:10.601745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:10.601745 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:37:10.601745 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:37:10.607690 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:37:10.608495 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:37:10.609287 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:11.053764 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003b-0001-429b-0008-4d9600020a5e
[0m16:37:11.054761 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 7 at position 8
'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m16:37:11.055801 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:37:10.568809 => 16:37:11.055801
[0m16:37:11.056800 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:37:11.097604 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:11.101635 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:37:10.552292 => 16:37:11.101635
[0m16:37:11.101635 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:37:11.109992 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:11.109992 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:37:10.579907 => 16:37:11.109992
[0m16:37:11.109992 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:37:11.109992 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:11.126389 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:37:10.586916 => 16:37:11.126389
[0m16:37:11.126389 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:37:11.159821 [debug] [Thread-1 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:37:11.166383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E926AC2300>]}
[0m16:37:11.166383 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.63s]
[0m16:37:11.166383 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:37:11.166383 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_6
[0m16:37:11.166383 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:37:11.166383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2a, now model.data_engineering_project.rpt_6)
[0m16:37:11.166383 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:37:11.176747 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:37:11.178745 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:37:11.166383 => 16:37:11.178745
[0m16:37:11.179748 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:37:11.184093 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:37:11.191572 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:37:11.192431 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:37:11.193445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:11.205279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92CAA9280>]}
[0m16:37:11.205279 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:37:11.209123 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:37:11.210140 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_7
[0m16:37:11.211137 [info ] [Thread-2 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:37:11.213135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:37:11.213135 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:37:11.217637 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:37:11.219715 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:37:11.214133 => 16:37:11.219715
[0m16:37:11.220717 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:37:11.225816 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:37:11.228822 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:37:11.229826 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:37:11.229826 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:37:11.249357 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C6BEE40>]}
[0m16:37:11.250313 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:37:11.252322 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:37:11.252322 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92C7C76B0>]}
[0m16:37:11.252322 [info ] [Thread-4 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:37:11.252322 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:37:11.724735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:11.740604 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:37:11.179748 => 16:37:11.740604
[0m16:37:11.740604 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_6: Close
[0m16:37:11.777892 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:11.785562 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:37:11.220717 => 16:37:11.785562
[0m16:37:11.785562 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: Close
[0m16:37:11.845577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92CC50CE0>]}
[0m16:37:11.845577 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:37:11.845577 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:37:11.899890 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5934cc2b-1a98-426b-8821-e6607a4c3c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92B830560>]}
[0m16:37:11.899890 [info ] [Thread-2 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:37:11.899890 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:37:11.899890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:11.899890 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:37:11.899890 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:37:11.899890 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:37:11.899890 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:37:11.899890 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:37:11.899890 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:37:11.910715 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:37:11.910715 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:37:11.911799 [info ] [MainThread]: 
[0m16:37:11.912762 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m16:37:11.916921 [debug] [MainThread]: Command end result
[0m16:37:11.934338 [info ] [MainThread]: 
[0m16:37:11.935332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:37:11.936333 [info ] [MainThread]: 
[0m16:37:11.937330 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:37:11.937330 [info ] [MainThread]: 
[0m16:37:11.937330 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:37:11.937330 [debug] [MainThread]: Command `dbt run` failed at 16:37:11.937330 after 5.23 seconds
[0m16:37:11.937330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92BC72E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92BA43C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92B830560>]}
[0m16:37:11.941825 [debug] [MainThread]: Flushing usage events
[0m16:38:43.372097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5C95E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5C97350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5C96900>]}


============================== 16:38:43.381701 | 5f1c458a-a939-483c-8798-135e13818afc ==============================
[0m16:38:43.381701 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:38:43.381701 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:38:43.918231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C618A2A0>]}
[0m16:38:44.035391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C6068EC0>]}
[0m16:38:44.035391 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:38:44.054592 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:38:44.201362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:44.203369 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:38:44.385107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C67FB980>]}
[0m16:38:44.401397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C65BCA70>]}
[0m16:38:44.401397 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:38:44.401397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5E77290>]}
[0m16:38:44.401397 [info ] [MainThread]: 
[0m16:38:44.401397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:44.401397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:38:44.416533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:38:44.431741 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:38:44.434707 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:38:44.434707 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:38:44.435743 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:38:44.436122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:44.436122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:45.747587 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:38:45.758554 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:38:45.766530 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:38:45.769528 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:38:46.294734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:38:46.294734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:38:46.306284 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:38:46.306284 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:38:46.310599 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:38:46.310599 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:38:46.310599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.310599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.632173 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:38:46.633197 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:38:46.648873 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:38:46.648873 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:38:46.768522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5FE3980>]}
[0m16:38:46.768522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:46.768522 [info ] [MainThread]: 
[0m16:38:46.776566 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:38:46.776566 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:38:46.792709 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:38:46.794108 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:38:46.776566 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:38:46.795117 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:38:46.799179 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:38:46.797180 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:38:46.801216 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:38:46.803190 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:38:46.805596 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:38:46.805932 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:38:46.798178 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:38:46.809626 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:38:46.818835 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:38:46.826393 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:38:46.828388 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:38:46.830689 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:38:46.830689 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:38:46.837910 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:38:46.839758 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:38:46.819837 => 16:38:46.838448
[0m16:38:46.840147 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:38:46.872346 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:38:46.872346 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:38:46.808071 => 16:38:46.872346
[0m16:38:46.872346 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:38:46.942943 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:38:46.943941 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:38:46.830689 => 16:38:46.943941
[0m16:38:46.944906 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:38:46.828388 => 16:38:46.943941
[0m16:38:46.944906 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:38:46.945942 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:38:46.949944 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:38:46.954737 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:38:46.955880 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:38:46.956915 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:38:46.957880 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:38:46.958915 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:38:46.958915 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:46.959914 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:46.960914 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:38:46.961940 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:38:46.963947 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:38:46.967950 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:38:46.967950 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:46.968982 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:47.372462 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:38:47.422145 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:38:46.840147 => 16:38:47.422145
[0m16:38:47.422145 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:38:47.439050 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:38:47.439050 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:38:46.946908 => 16:38:47.439050
[0m16:38:47.439050 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:38:47.505951 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:38:47.507502 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:38:46.950941 => 16:38:47.507502
[0m16:38:47.507502 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:38:47.523711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:38:47.523711 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:38:46.872346 => 16:38:47.523711
[0m16:38:47.523711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C69C60F0>]}
[0m16:38:47.523711 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:38:47.523711 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:38:47.538793 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:38:47.543885 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C67F1220>]}
[0m16:38:47.544887 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:38:47.546849 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:38:47.607495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C660CB60>]}
[0m16:38:47.607495 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.80s]
[0m16:38:47.607495 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:38:47.607495 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:38:47.621771 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:38:47.623779 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:38:47.622818 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:38:47.623779 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:38:47.625815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:38:47.626821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_2b)
[0m16:38:47.624782 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:38:47.627780 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:38:47.628828 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:38:47.629808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m16:38:47.634838 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:38:47.638793 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:38:47.639800 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:38:47.644793 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:38:47.646110 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:38:47.634838 => 16:38:47.646110
[0m16:38:47.648136 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:38:47.649796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C660F740>]}
[0m16:38:47.653831 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:38:47.657146 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:38:47.629808 => 16:38:47.656127
[0m16:38:47.655117 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.85s]
[0m16:38:47.658125 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:38:47.640792 => 16:38:47.658125
[0m16:38:47.659126 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:38:47.660126 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:38:47.660126 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:38:47.666370 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:38:47.667336 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_5
[0m16:38:47.669370 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:38:47.675797 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:38:47.677762 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:38:47.677762 [info ] [Thread-1 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:38:47.679083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:47.679083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_5)
[0m16:38:47.679083 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:38:47.679083 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:38:47.679083 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:38:47.690428 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:38:47.693197 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:38:47.694197 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:38:47.695234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:47.696200 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:38:47.679083 => 16:38:47.696200
[0m16:38:47.697200 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:47.697200 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:38:47.704358 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:38:47.708736 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:38:47.709737 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:38:47.709737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:48.122385 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb003c-0001-429e-0008-4d960002203a
[0m16:38:48.122385 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 7 at position 8
'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m16:38:48.122385 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:38:47.669370 => 16:38:48.122385
[0m16:38:48.122385 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:38:48.171522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:38:48.178024 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:38:47.661125 => 16:38:48.175820
[0m16:38:48.178024 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:38:48.180032 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:38:48.184931 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:38:47.649796 => 16:38:48.184931
[0m16:38:48.184931 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:38:48.188005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:38:48.188005 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:38:47.697200 => 16:38:48.188005
[0m16:38:48.188005 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: Close
[0m16:38:48.232591 [debug] [Thread-4 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:38:48.234598 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C68A5BB0>]}
[0m16:38:48.236606 [error] [Thread-4 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.61s]
[0m16:38:48.236606 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:38:48.238612 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m16:38:48.240621 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:38:48.246488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2a, now model.data_engineering_project.rpt_6)
[0m16:38:48.247522 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:38:48.249521 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:38:48.249521 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:38:48.247522 => 16:38:48.249521
[0m16:38:48.249521 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:38:48.261060 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:38:48.263707 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:38:48.264148 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:38:48.264954 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:48.293013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C683AAE0>]}
[0m16:38:48.293013 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:38:48.293013 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:38:48.293013 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_7
[0m16:38:48.293013 [info ] [Thread-2 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:38:48.307347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:38:48.309923 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:38:48.314266 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:38:48.316203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5ACC8C0>]}
[0m16:38:48.316548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C66F5130>]}
[0m16:38:48.316548 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:38:48.319722 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:38:48.320893 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:38:48.310997 => 16:38:48.320893
[0m16:38:48.321893 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:38:48.319319 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:38:48.330351 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:38:48.329271 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:38:48.332922 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:38:48.333956 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:38:48.334957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:48.769648 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:38:48.785640 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:38:48.249521 => 16:38:48.785640
[0m16:38:48.785640 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m16:38:48.785640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:38:48.785640 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:38:48.322936 => 16:38:48.785640
[0m16:38:48.785640 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: Close
[0m16:38:48.891403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C64CEDE0>]}
[0m16:38:48.891403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1c458a-a939-483c-8798-135e13818afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C67FB920>]}
[0m16:38:48.891403 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:38:48.891403 [info ] [Thread-2 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.60s]
[0m16:38:48.907938 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:38:48.907938 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:38:48.907938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:48.907938 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:38:48.907938 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:38:48.907938 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:38:48.907938 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:38:48.921533 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:38:48.923082 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:38:48.923082 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:38:48.924098 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:38:48.925094 [info ] [MainThread]: 
[0m16:38:48.926092 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m16:38:48.930129 [debug] [MainThread]: Command end result
[0m16:38:48.951520 [info ] [MainThread]: 
[0m16:38:48.952520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:38:48.953516 [info ] [MainThread]: 
[0m16:38:48.954519 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:38:48.954519 [info ] [MainThread]: 
[0m16:38:48.956373 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:38:48.959382 [debug] [MainThread]: Command `dbt run` failed at 16:38:48.958436 after 5.66 seconds
[0m16:38:48.959382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C5B72B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C58FF320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2C57646B0>]}
[0m16:38:48.960384 [debug] [MainThread]: Flushing usage events
[0m16:41:53.830142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CF96450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CF968D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CF94C20>]}


============================== 16:41:53.836124 | a99b4867-c5f1-4171-9ba1-5ac7994c929f ==============================
[0m16:41:53.836124 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:41:53.837122 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:41:54.428093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164E63CB00>]}
[0m16:41:54.550777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CCB6480>]}
[0m16:41:54.551824 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:41:54.564529 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:41:54.727239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:41:54.727239 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:41:54.942849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EAE38C0>]}
[0m16:41:54.959291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164E86BB30>]}
[0m16:41:54.959838 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:41:54.961062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EA0F0B0>]}
[0m16:41:54.963092 [info ] [MainThread]: 
[0m16:41:54.964461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:54.967347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:41:54.977263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:41:54.995993 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:41:55.002361 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:41:55.002361 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:41:55.002361 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:41:55.002361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:55.002361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:55.891301 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:41:55.892952 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:41:55.892952 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:41:55.892952 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:41:56.011083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:41:56.011083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:41:56.011083 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:41:56.026004 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:41:56.027018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:56.027842 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:41:56.027842 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:41:56.027842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:56.358743 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:41:56.365672 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:41:56.493715 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:41:56.493715 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:41:56.594164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EAE7D10>]}
[0m16:41:56.594164 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:56.594164 [info ] [MainThread]: 
[0m16:41:56.611025 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:41:56.611025 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:41:56.613163 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:41:56.613163 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:41:56.612201 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:41:56.614196 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:41:56.616196 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:41:56.615162 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:41:56.616196 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:41:56.616196 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:41:56.616196 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:41:56.616196 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:41:56.616196 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:41:56.616196 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:41:56.632634 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:41:56.633635 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:41:56.637634 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:41:56.637634 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:41:56.645232 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:41:56.650186 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:41:56.652011 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:41:56.616196 => 16:41:56.651154
[0m16:41:56.652011 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:41:56.652011 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:41:56.633635 => 16:41:56.652011
[0m16:41:56.692503 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:41:56.759507 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:41:56.765475 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:41:56.765475 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:41:56.637634 => 16:41:56.765475
[0m16:41:56.766475 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:41:56.646190 => 16:41:56.766475
[0m16:41:56.767509 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:41:56.768476 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:41:56.769475 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:41:56.773482 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:41:56.777521 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:41:56.777521 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:41:56.777521 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:41:56.777521 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:41:56.777521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:56.777521 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:56.777521 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:41:56.777521 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:41:56.786661 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:56.777521 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:41:56.786661 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:41:56.793993 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:57.236005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:57.262203 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:57.284723 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:41:56.774586 => 16:41:57.284723
[0m16:41:57.285684 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:57.286559 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:41:57.290166 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:41:56.652011 => 16:41:57.289165
[0m16:41:57.293710 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:41:56.693313 => 16:41:57.292709
[0m16:41:57.295749 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:41:57.296707 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:41:57.361236 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:57.372415 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:41:56.769475 => 16:41:57.372415
[0m16:41:57.374423 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:41:57.404889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164ED340B0>]}
[0m16:41:57.404889 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.79s]
[0m16:41:57.404889 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:41:57.404889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164ECED100>]}
[0m16:41:57.411320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164E7CAF90>]}
[0m16:41:57.404889 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.79s]
[0m16:41:57.411320 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:41:57.411320 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.80s]
[0m16:41:57.411320 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:41:57.478091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164ECEFBC0>]}
[0m16:41:57.478091 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.86s]
[0m16:41:57.478091 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:41:57.478091 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m16:41:57.478091 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:41:57.478091 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:41:57.478091 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:41:57.488706 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:41:57.488706 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:41:57.488706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m16:41:57.488706 [info ] [Thread-4 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:41:57.493570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2a)
[0m16:41:57.494090 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:41:57.488706 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:41:57.496100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2b)
[0m16:41:57.497099 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:41:57.501098 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:41:57.502098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:41:57.503100 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:41:57.507544 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:41:57.507544 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:41:57.513848 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:41:57.517850 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:41:57.520433 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:41:57.497099 => 16:41:57.518410
[0m16:41:57.520433 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:41:57.525808 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:41:57.526808 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:41:57.509553 => 16:41:57.526808
[0m16:41:57.527775 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:41:57.503515 => 16:41:57.527775
[0m16:41:57.528827 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:41:57.529774 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:41:57.530778 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:41:57.513848 => 16:41:57.530778
[0m16:41:57.535540 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:41:57.535540 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:41:57.535540 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:41:57.546657 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:41:57.546657 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:41:57.551566 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:41:57.551566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:57.551566 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:41:57.551566 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:41:57.551566 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:41:57.551566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:57.559941 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:41:57.561421 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:41:57.561421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:57.561421 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:41:57.561421 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:57.994843 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb003f-0001-429e-0008-4d9600022076
[0m16:41:57.994843 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 8
invalid identifier 'CUSTOMER_NAME'
[0m16:41:57.994843 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:41:57.535540 => 16:41:57.994843
[0m16:41:57.994843 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:41:58.042299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:58.058367 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:41:57.522450 => 16:41:58.058367
[0m16:41:58.058367 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m16:41:58.074503 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:58.074503 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:41:57.544178 => 16:41:58.074503
[0m16:41:58.074503 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:41:58.074503 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:58.092707 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:41:57.531774 => 16:41:58.090666
[0m16:41:58.092707 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:41:58.106835 [debug] [Thread-2 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:41:58.106835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164ED16AB0>]}
[0m16:41:58.106835 [error] [Thread-2 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.62s]
[0m16:41:58.122646 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:41:58.122646 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:41:58.122646 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:41:58.122646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2a, now model.data_engineering_project.rpt_6)
[0m16:41:58.122646 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:41:58.122646 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:41:58.122646 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:41:58.122646 => 16:41:58.122646
[0m16:41:58.122646 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:41:58.138500 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:41:58.143857 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:41:58.143857 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:41:58.144894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:58.162135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164ECEC0B0>]}
[0m16:41:58.162135 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:41:58.162135 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:41:58.162135 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_7
[0m16:41:58.162135 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:41:58.162135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:41:58.162135 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:41:58.162135 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:41:58.162135 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:41:58.162135 => 16:41:58.162135
[0m16:41:58.162135 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:41:58.178968 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:41:58.183447 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:41:58.183447 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:41:58.183447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:58.183447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EAE6AB0>]}
[0m16:41:58.183447 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:41:58.192871 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:41:58.198317 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EAA69F0>]}
[0m16:41:58.200328 [info ] [Thread-4 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:41:58.200328 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:41:58.679799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:58.679799 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:41:58.162135 => 16:41:58.679799
[0m16:41:58.679799 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: Close
[0m16:41:58.687714 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:58.695525 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:41:58.122646 => 16:41:58.695525
[0m16:41:58.695525 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:41:58.782751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164ECEC2C0>]}
[0m16:41:58.782751 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:41:58.782751 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:41:58.800436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a99b4867-c5f1-4171-9ba1-5ac7994c929f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EDB4980>]}
[0m16:41:58.801664 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:41:58.802673 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:41:58.806051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:58.806051 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:41:58.807043 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:41:58.807043 [info ] [MainThread]: 
[0m16:41:58.807043 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m16:41:58.814157 [debug] [MainThread]: Command end result
[0m16:41:58.832623 [info ] [MainThread]: 
[0m16:41:58.836655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:58.836655 [info ] [MainThread]: 
[0m16:41:58.838645 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:41:58.839656 [info ] [MainThread]: 
[0m16:41:58.840653 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:41:58.843291 [debug] [MainThread]: Command `dbt run` failed at 16:41:58.843291 after 5.10 seconds
[0m16:41:58.847458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CE096D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CE8DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164EA34290>]}
[0m16:41:58.847458 [debug] [MainThread]: Flushing usage events
[0m16:42:12.406531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24E6659D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24E665FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24E665A90>]}


============================== 16:42:12.413737 | a105826a-bf21-4432-b038-e580b3d2c8ab ==============================
[0m16:42:12.413737 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:42:12.413737 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:42:12.949081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24EB0FCB0>]}
[0m16:42:13.072624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24EB0FCB0>]}
[0m16:42:13.074589 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:42:13.077225 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:42:13.210371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:13.226110 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:42:13.410229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24EE049B0>]}
[0m16:42:13.417997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24EFCCAA0>]}
[0m16:42:13.417997 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:42:13.426365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24EED9A00>]}
[0m16:42:13.426365 [info ] [MainThread]: 
[0m16:42:13.426365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:13.432010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:42:13.441412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:42:13.445837 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:42:13.445837 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:42:13.445837 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:42:13.445837 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:42:13.445837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:13.460030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:15.161788 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:42:15.170193 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:42:15.170193 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:42:15.180388 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:42:15.302092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:42:15.315492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:42:15.334942 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:42:15.337983 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:42:15.338983 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:42:15.338983 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:42:15.339983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:15.339983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:15.685225 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:42:15.701435 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:42:15.701435 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:42:15.685225 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:42:15.814319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F203E90>]}
[0m16:42:15.817363 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:15.819316 [info ] [MainThread]: 
[0m16:42:15.832940 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:42:15.834155 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:42:15.835150 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:42:15.837161 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:42:15.837161 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:42:15.839127 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:42:15.840138 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:42:15.844514 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:42:15.841776 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:42:15.846866 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:42:15.847865 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:42:15.848863 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:42:15.849866 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:42:15.850865 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:42:15.851862 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:42:15.862384 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:42:15.866415 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:42:15.867402 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:42:15.871416 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:42:15.875383 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:42:15.878388 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:42:15.862384 => 16:42:15.878388
[0m16:42:15.879383 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:42:15.851862 => 16:42:15.879383
[0m16:42:15.880383 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:42:15.881379 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:42:15.888383 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:42:15.867402 => 16:42:15.888383
[0m16:42:15.962415 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:42:15.872379 => 16:42:15.962415
[0m16:42:15.978539 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:42:15.978539 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:42:15.978539 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:42:15.978539 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:42:15.978539 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:42:15.978539 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:42:15.978539 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:42:15.978539 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:42:15.994598 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:42:15.994598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:15.994598 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:42:15.994598 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:42:15.994598 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:42:15.994598 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:15.994598 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:42:15.994598 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:42:15.994598 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:42:15.994598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:42:16.491932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:16.507748 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:42:15.978539 => 16:42:16.507748
[0m16:42:16.507748 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:42:16.523603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.523603 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:42:15.914543 => 16:42:16.523603
[0m16:42:16.523603 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:42:16.571867 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.571867 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:42:15.978539 => 16:42:16.571867
[0m16:42:16.571867 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:42:16.620012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.620012 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:42:15.882383 => 16:42:16.620012
[0m16:42:16.620012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F40E990>]}
[0m16:42:16.620012 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:42:16.620012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F40FFB0>]}
[0m16:42:16.636054 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:42:16.636054 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:42:16.636054 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.78s]
[0m16:42:16.636054 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:42:16.684514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F40F0B0>]}
[0m16:42:16.684514 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.84s]
[0m16:42:16.684514 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:42:16.684514 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:42:16.684514 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:42:16.684514 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:42:16.684514 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:42:16.684514 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:42:16.684514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:42:16.684514 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:42:16.696691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m16:42:16.697957 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:42:16.699965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:42:16.700665 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:42:16.705082 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:42:16.705555 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:42:16.709268 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:42:16.713547 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:42:16.717737 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:42:16.706638 => 16:42:16.716740
[0m16:42:16.718737 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:42:16.700665 => 16:42:16.717737
[0m16:42:16.719314 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:42:16.719314 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:42:16.720951 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:42:16.709268 => 16:42:16.720409
[0m16:42:16.724980 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:42:16.730521 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:42:16.731582 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:42:16.731582 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:42:16.742211 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:42:16.742211 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:42:16.742211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F3F0B30>]}
[0m16:42:16.742211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:16.747295 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:42:16.746117 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.90s]
[0m16:42:16.750375 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:42:16.751374 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:42:16.753378 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:42:16.755340 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:42:16.755340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:16.756340 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:42:16.757341 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:16.758341 [info ] [Thread-2 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:42:16.761478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_6)
[0m16:42:16.762478 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:42:16.766998 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:42:16.771668 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:42:16.762478 => 16:42:16.771668
[0m16:42:16.773687 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:42:16.779758 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:42:16.782637 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:42:16.784649 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:42:16.784649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:17.217584 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:17.217584 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:42:16.731582 => 16:42:17.217584
[0m16:42:17.217584 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:42:17.233432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:17.233432 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:42:16.720951 => 16:42:17.233432
[0m16:42:17.233432 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:42:17.264954 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.264954 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:42:16.724980 => 16:42:17.264954
[0m16:42:17.264954 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:42:17.321972 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F3F0B30>]}
[0m16:42:17.322972 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:42:17.323937 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:42:17.324972 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:42:17.324972 [info ] [Thread-3 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:42:17.326940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_2a)
[0m16:42:17.326940 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:42:17.330555 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:42:17.333515 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:42:17.327939 => 16:42:17.333515
[0m16:42:17.334559 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:42:17.338560 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:42:17.338560 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:42:17.338560 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:42:17.338560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F3F0650>]}
[0m16:42:17.344276 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:17.344276 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.344276 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:42:17.351638 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:42:16.775700 => 16:42:17.350644
[0m16:42:17.353504 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:42:17.355608 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:42:17.355608 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_7
[0m16:42:17.357618 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:42:17.357618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m16:42:17.357618 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:42:17.366296 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:42:17.369295 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:42:17.361730 => 16:42:17.368294
[0m16:42:17.370300 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:42:17.375491 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:42:17.379595 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:42:17.380582 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F40F560>]}
[0m16:42:17.382615 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:42:17.383898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:17.383898 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:42:17.385913 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:42:17.473194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F3F06B0>]}
[0m16:42:17.474194 [info ] [Thread-2 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:42:17.475197 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:42:17.853800 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.857834 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:42:17.334559 => 16:42:17.857834
[0m16:42:17.857834 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:42:17.880520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:17.880520 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:42:17.370983 => 16:42:17.880520
[0m16:42:17.880520 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: Close
[0m16:42:17.953127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24EE621B0>]}
[0m16:42:17.954098 [info ] [Thread-3 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:42:17.955016 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:42:18.001710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a105826a-bf21-4432-b038-e580b3d2c8ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F1C7560>]}
[0m16:42:18.002702 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:42:18.003685 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:42:18.006729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:18.006729 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:42:18.007731 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:42:18.007731 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:42:18.007731 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:42:18.008731 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:42:18.008731 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:42:18.009728 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:42:18.009728 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m16:42:18.010728 [info ] [MainThread]: 
[0m16:42:18.011702 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m16:42:18.014694 [debug] [MainThread]: Command end result
[0m16:42:18.027907 [info ] [MainThread]: 
[0m16:42:18.028909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:18.031333 [info ] [MainThread]: 
[0m16:42:18.032334 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:42:18.034375 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:18.033334 after 5.70 seconds
[0m16:42:18.034375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24A513080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24E253560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F4361E0>]}
[0m16:42:18.035368 [debug] [MainThread]: Flushing usage events
[0m16:43:13.905726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10BB9B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10BB9B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10BB99B80>]}


============================== 16:43:13.905726 | c22cc1af-bb8a-4163-9648-0a2b3e222a9c ==============================
[0m16:43:13.905726 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:43:13.905726 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:43:14.449678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C282E10>]}
[0m16:43:14.559098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10BCB0470>]}
[0m16:43:14.559098 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:43:14.569651 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:43:14.719690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:14.719690 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:43:14.893803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C6EFAD0>]}
[0m16:43:14.913712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C4BC2F0>]}
[0m16:43:14.913712 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:43:14.913712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C41BE30>]}
[0m16:43:14.913712 [info ] [MainThread]: 
[0m16:43:14.913712 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:14.913712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:43:14.925776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:43:14.949157 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:43:14.954531 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:43:14.955540 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:43:14.956539 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:43:14.956539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:14.957573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:15.829831 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:43:15.831842 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:43:15.903933 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:43:15.909982 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:43:16.011255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:43:16.011255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:43:16.027185 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:43:16.027185 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:43:16.027185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:16.027185 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:43:16.027185 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:43:16.027185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:16.374482 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:43:16.376493 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:43:16.500344 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:43:16.502353 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:43:16.594902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C7D7A70>]}
[0m16:43:16.594902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:16.594902 [info ] [MainThread]: 
[0m16:43:16.610859 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:43:16.610859 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:43:16.626841 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:43:16.626841 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:43:16.610859 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:43:16.626841 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:43:16.631103 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:43:16.626841 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:43:16.633060 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:43:16.633060 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:43:16.626841 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:43:16.635374 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:43:16.635374 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:43:16.646822 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:43:16.647827 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:43:16.648824 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:43:16.651863 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:43:16.653793 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:43:16.658442 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:43:16.662441 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:43:16.663441 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:43:16.636378 => 16:43:16.663441
[0m16:43:16.664408 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:43:16.675035 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:43:16.648824 => 16:43:16.675035
[0m16:43:16.706607 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:43:16.765798 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:43:16.773603 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:43:16.774614 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:43:16.659443 => 16:43:16.774614
[0m16:43:16.775650 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:43:16.776654 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:43:16.653793 => 16:43:16.775650
[0m16:43:16.781647 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:43:16.781647 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:43:16.783646 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:43:16.787646 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:43:16.788647 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:43:16.789938 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:43:16.790955 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:43:16.791940 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:43:16.792558 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:16.793167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:16.794175 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:43:16.795221 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:43:16.797825 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:43:16.799858 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:16.800826 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:43:17.255892 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:17.271921 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:43:16.706607 => 16:43:17.271921
[0m16:43:17.271921 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:43:17.355968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:17.355968 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:43:16.664408 => 16:43:17.355968
[0m16:43:17.355968 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:43:17.367395 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:17.372015 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:43:16.776654 => 16:43:17.372015
[0m16:43:17.372015 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:43:17.372015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:17.379831 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:43:16.783646 => 16:43:17.379831
[0m16:43:17.379831 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:43:17.381838 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C50F020>]}
[0m16:43:17.381838 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.75s]
[0m16:43:17.381838 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:43:17.474789 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C50DA00>]}
[0m16:43:17.474789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C8B38C0>]}
[0m16:43:17.474789 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.83s]
[0m16:43:17.474789 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:43:17.474789 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.84s]
[0m16:43:17.474789 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:43:17.474789 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C8B3680>]}
[0m16:43:17.474789 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.84s]
[0m16:43:17.490860 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:43:17.490860 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:43:17.490860 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:43:17.494495 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:43:17.495539 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:43:17.490860 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:43:17.494495 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:43:17.498502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:43:17.496506 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:43:17.499959 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m16:43:17.499959 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:43:17.497513 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:43:17.501932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m16:43:17.502646 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:43:17.509150 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:43:17.510149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:43:17.510149 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:43:17.514148 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:43:17.515149 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:43:17.519151 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:43:17.523522 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:43:17.527209 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:43:17.502646 => 16:43:17.525650
[0m16:43:17.528340 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:43:17.528340 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:43:17.516149 => 16:43:17.528340
[0m16:43:17.534511 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:43:17.535510 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:43:17.520151 => 16:43:17.535510
[0m16:43:17.536478 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:43:17.511148 => 16:43:17.536478
[0m16:43:17.536478 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:43:17.537510 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:43:17.538478 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:43:17.545454 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:43:17.547176 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:43:17.547176 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:43:17.557174 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:43:17.559546 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:43:17.559546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:17.559546 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:43:17.565127 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:43:17.565127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:17.567670 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:43:17.567670 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:43:17.567670 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:43:17.567670 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:43:17.574737 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:17.567670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:18.034862 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb0041-0001-429a-0008-4d96000218f2
[0m16:43:18.034862 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 7 at position 8
'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m16:43:18.034862 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:43:17.553402 => 16:43:18.034862
[0m16:43:18.034862 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:43:18.069245 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:18.073263 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:43:17.546458 => 16:43:18.071254
[0m16:43:18.073263 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:43:18.077280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:18.077280 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:43:17.538478 => 16:43:18.077280
[0m16:43:18.083463 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:43:18.131650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:18.131650 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:43:17.530520 => 16:43:18.131650
[0m16:43:18.131650 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:43:18.163621 [debug] [Thread-4 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:43:18.163621 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C6BAF00>]}
[0m16:43:18.163621 [error] [Thread-4 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.66s]
[0m16:43:18.163621 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:43:18.169504 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m16:43:18.169504 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:43:18.169504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2a, now model.data_engineering_project.rpt_6)
[0m16:43:18.169504 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:43:18.183560 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:43:18.186503 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:43:18.169504 => 16:43:18.185522
[0m16:43:18.186503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C8B2930>]}
[0m16:43:18.186503 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:43:18.195220 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:43:18.186503 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:43:18.196218 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:43:18.197222 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m16:43:18.198184 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:43:18.200430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_7)
[0m16:43:18.200430 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:43:18.205978 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:43:18.207946 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:43:18.202445 => 16:43:18.207946
[0m16:43:18.210944 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:43:18.210944 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:43:18.211946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C8DAB40>]}
[0m16:43:18.213947 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:43:18.220153 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:43:18.221153 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:18.221153 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:43:18.224463 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:43:18.228474 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:43:18.229512 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:43:18.230510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:18.281707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C8D93D0>]}
[0m16:43:18.281707 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.78s]
[0m16:43:18.281707 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:43:18.740159 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:18.740159 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:43:18.216145 => 16:43:18.740159
[0m16:43:18.740159 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m16:43:18.824653 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:18.824653 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:43:18.186503 => 16:43:18.824653
[0m16:43:18.824653 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m16:43:18.840840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C69A3C0>]}
[0m16:43:18.840840 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:43:18.840840 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:43:18.926220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22cc1af-bb8a-4163-9648-0a2b3e222a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C8E4C80>]}
[0m16:43:18.926545 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m16:43:18.927588 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:43:18.930576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:18.930576 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:43:18.931581 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:43:18.931581 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:43:18.932582 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:43:18.932582 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:43:18.932582 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m16:43:18.933581 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:43:18.933581 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:43:18.934582 [info ] [MainThread]: 
[0m16:43:18.935547 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m16:43:18.938547 [debug] [MainThread]: Command end result
[0m16:43:18.952387 [info ] [MainThread]: 
[0m16:43:18.952387 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:18.952387 [info ] [MainThread]: 
[0m16:43:18.960565 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:43:18.961570 [info ] [MainThread]: 
[0m16:43:18.962567 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:43:18.963567 [debug] [MainThread]: Command `dbt run` failed at 16:43:18.963567 after 5.14 seconds
[0m16:43:18.964601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C329E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C32A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10C6E3EC0>]}
[0m16:43:18.965567 [debug] [MainThread]: Flushing usage events
[0m16:43:46.671274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9A968A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9A96D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9A95A30>]}


============================== 16:43:46.687890 | 5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a ==============================
[0m16:43:46.687890 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:43:46.687890 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:43:47.250960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA13E030>]}
[0m16:43:47.351990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA12FC80>]}
[0m16:43:47.367890 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:43:47.369913 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:43:47.524716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:47.525714 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:43:47.705436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA2CD760>]}
[0m16:43:47.718921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA368200>]}
[0m16:43:47.718921 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:43:47.718921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA368080>]}
[0m16:43:47.718921 [info ] [MainThread]: 
[0m16:43:47.718921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:47.730959 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:43:47.746780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:43:47.750810 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:43:47.753983 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:43:47.755055 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:43:47.755372 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:43:47.755372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:47.755372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:48.802986 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:43:48.805872 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:43:48.808000 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:43:48.811002 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:43:48.917141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:43:48.919927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:43:48.934669 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:43:48.938454 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:43:48.939045 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:43:48.939421 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:43:48.940275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:48.940275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:49.295964 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:43:49.297961 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:43:49.300998 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:43:49.302791 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:43:49.414628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA5D6C60>]}
[0m16:43:49.414628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:49.414628 [info ] [MainThread]: 
[0m16:43:49.424210 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:43:49.425195 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:43:49.426573 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:43:49.426573 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:43:49.425195 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:43:49.426573 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:43:49.430896 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:43:49.428884 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:43:49.432056 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:43:49.433074 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:43:49.428884 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:43:49.433838 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:43:49.433838 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:43:49.445930 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:43:49.446930 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:43:49.447931 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:43:49.451472 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:43:49.451472 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:43:49.460640 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:43:49.467164 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:43:49.468173 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:43:49.433838 => 16:43:49.467164
[0m16:43:49.469173 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:43:49.477718 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:43:49.447931 => 16:43:49.477718
[0m16:43:49.492538 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:43:49.507644 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:43:49.573873 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:43:49.573873 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:43:49.455587 => 16:43:49.573873
[0m16:43:49.573873 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:43:49.461607 => 16:43:49.573873
[0m16:43:49.573873 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:43:49.573873 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:43:49.573873 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:43:49.590059 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:43:49.573873 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:43:49.591061 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:43:49.591061 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:43:49.591061 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:43:49.591061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:49.591061 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:49.591061 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:43:49.591061 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:43:49.591061 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:43:49.605707 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:43:49.607226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:43:49.607226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:50.057210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:50.096069 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:43:49.469173 => 16:43:50.096069
[0m16:43:50.096069 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:43:50.096069 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.096069 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:43:49.507644 => 16:43:50.096069
[0m16:43:50.105351 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:43:50.105351 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:50.107133 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:43:49.591061 => 16:43:50.107133
[0m16:43:50.107133 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:43:50.157391 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.176501 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:43:49.573873 => 16:43:50.175495
[0m16:43:50.176501 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:43:50.215264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA8046B0>]}
[0m16:43:50.216301 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.79s]
[0m16:43:50.218265 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:43:50.219303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA805730>]}
[0m16:43:50.221301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA8053A0>]}
[0m16:43:50.220263 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.79s]
[0m16:43:50.224268 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:43:50.222264 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:43:50.225263 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:43:50.276509 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA444920>]}
[0m16:43:50.276509 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.84s]
[0m16:43:50.276509 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:43:50.276509 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m16:43:50.276509 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:43:50.276509 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:43:50.276509 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:43:50.276509 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:43:50.276509 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:43:50.276509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m16:43:50.289686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2a)
[0m16:43:50.276509 [info ] [Thread-4 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:43:50.291697 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:43:50.276509 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:43:50.292696 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:43:50.293697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2b)
[0m16:43:50.298697 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:43:50.299698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:43:50.304032 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:43:50.304032 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:43:50.306432 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:43:50.311476 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:43:50.315051 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:43:50.315051 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:43:50.293697 => 16:43:50.315051
[0m16:43:50.318354 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:43:50.322374 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:43:50.323104 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:43:50.299698 => 16:43:50.323104
[0m16:43:50.325459 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:43:50.311476 => 16:43:50.325117
[0m16:43:50.325459 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:43:50.327470 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:43:50.306432 => 16:43:50.327470
[0m16:43:50.327470 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:43:50.327470 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:43:50.331046 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:43:50.331046 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:43:50.341799 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:43:50.342799 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:43:50.346835 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:43:50.347833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:50.349799 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:43:50.351798 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:43:50.353833 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:43:50.354802 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:50.356763 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:43:50.357845 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id,
        c.customer_name
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:43:50.358844 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:43:50.359869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:50.361599 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:50.854516 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.854516 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:50.854516 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:43:50.331046 => 16:43:50.854516
[0m16:43:50.870371 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:43:50.342799 => 16:43:50.870371
[0m16:43:50.870371 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:43:50.870371 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:43:50.886498 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.886498 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:43:50.331046 => 16:43:50.886498
[0m16:43:50.886498 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:43:50.951034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.951034 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:43:50.318354 => 16:43:50.951034
[0m16:43:50.951034 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m16:43:50.982980 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA8A98B0>]}
[0m16:43:50.982980 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA7F6C00>]}
[0m16:43:50.982980 [info ] [Thread-4 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:43:50.982980 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:43:50.982980 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m16:43:50.982980 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:43:50.982980 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:43:50.982980 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m16:43:50.982980 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:43:50.982980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_6)
[0m16:43:50.982980 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:43:50.996808 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:43:50.982980 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:43:50.999531 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_7)
[0m16:43:51.000528 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:43:51.002925 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:43:51.008455 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:43:50.982980 => 16:43:51.007449
[0m16:43:51.010447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA806360>]}
[0m16:43:51.011446 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:43:51.016979 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:43:51.012479 [info ] [Thread-2 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:43:51.016979 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:43:51.000528 => 16:43:51.016979
[0m16:43:51.022451 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:43:51.022451 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:43:51.028493 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:43:51.031066 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:43:51.031066 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:43:51.033083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:51.035093 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:43:51.035093 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:43:51.037100 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:51.086714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA805EE0>]}
[0m16:43:51.087715 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.81s]
[0m16:43:51.088682 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:43:51.547191 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:51.551207 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:43:51.023460 => 16:43:51.551207
[0m16:43:51.551207 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m16:43:51.551207 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:51.559133 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:43:51.013443 => 16:43:51.559133
[0m16:43:51.560870 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m16:43:51.644917 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA7F4560>]}
[0m16:43:51.655899 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:43:51.655899 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:43:51.655899 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea7d2e3-e71a-4cf4-b50e-1d4a05d6853a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA805EE0>]}
[0m16:43:51.655899 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:43:51.655899 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:43:51.667446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:51.667446 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:43:51.668884 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:43:51.668884 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:43:51.669454 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:43:51.670432 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m16:43:51.670804 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:43:51.671813 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:43:51.671813 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:43:51.672806 [info ] [MainThread]: 
[0m16:43:51.674405 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m16:43:51.679781 [debug] [MainThread]: Command end result
[0m16:43:51.695585 [info ] [MainThread]: 
[0m16:43:51.699633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:51.699633 [info ] [MainThread]: 
[0m16:43:51.699633 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:43:51.703557 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:51.699633 after 5.10 seconds
[0m16:43:51.703557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC998F2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC97E7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9A65B50>]}
[0m16:43:51.704565 [debug] [MainThread]: Flushing usage events
[0m16:44:28.253566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E161820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E161C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E1613D0>]}


============================== 16:44:28.259565 | 5af7c21a-716e-417b-a492-8aa75f57aa8c ==============================
[0m16:44:28.259565 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:44:28.264363 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:44:28.967795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E82FEC0>]}
[0m16:44:29.097098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5CB61FD0>]}
[0m16:44:29.097098 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:44:29.107314 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:44:29.247382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:29.247382 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:44:29.453334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EBF5760>]}
[0m16:44:29.461767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EA64350>]}
[0m16:44:29.461767 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:44:29.461767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EC0F080>]}
[0m16:44:29.461767 [info ] [MainThread]: 
[0m16:44:29.461767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:44:29.461767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:44:29.486005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:44:29.494879 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:44:29.497489 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:44:29.498489 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:44:29.499487 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:44:29.499487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:29.500487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:30.495499 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:44:30.498599 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:44:30.499603 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:44:30.502443 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:44:30.610262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:44:30.613833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:44:30.624493 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:44:30.627467 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:44:30.628823 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:44:30.628823 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:44:30.629831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:30.630703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:30.968994 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:44:30.974984 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:44:30.997612 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:44:31.002648 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:44:31.107615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E92A570>]}
[0m16:44:31.107615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:31.114854 [info ] [MainThread]: 
[0m16:44:31.116055 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:44:31.116055 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:44:31.116055 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:44:31.116055 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:44:31.116055 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:44:31.116055 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:44:31.116055 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:44:31.116055 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:44:31.116055 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:44:31.116055 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:44:31.132479 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:44:31.116055 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:44:31.133437 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:44:31.133437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:44:31.135921 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:44:31.145252 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:44:31.151193 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:44:31.152193 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:44:31.156190 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:44:31.160225 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:44:31.162192 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:44:31.135921 => 16:44:31.161189
[0m16:44:31.162192 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:44:31.183568 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:44:31.147183 => 16:44:31.183568
[0m16:44:31.196353 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:44:31.157191 => 16:44:31.196353
[0m16:44:31.196353 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:44:31.209586 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:44:31.210547 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:44:31.152193 => 16:44:31.209586
[0m16:44:31.210547 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:44:31.267985 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:44:31.268997 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:44:31.273030 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:44:31.273991 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:44:31.279026 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:44:31.279993 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:44:31.280595 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:44:31.280595 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:31.280595 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:44:31.283647 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:44:31.283647 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:44:31.283647 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:44:31.283647 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:44:31.283647 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:44:31.283647 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:44:31.283647 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:44:31.782339 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:31.799650 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:44:31.268997 => 16:44:31.799650
[0m16:44:31.799650 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:44:31.881222 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:31.884161 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:44:31.211579 => 16:44:31.884161
[0m16:44:31.887064 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:44:31.891083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:31.895102 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:44:31.163190 => 16:44:31.895102
[0m16:44:31.895102 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:44:31.902655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EF14E60>]}
[0m16:44:31.903697 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:44:31.905572 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:44:31.982430 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:31.984675 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:44:31.274993 => 16:44:31.984675
[0m16:44:31.984675 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:44:31.984675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EB08BF0>]}
[0m16:44:31.984675 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.87s]
[0m16:44:31.984675 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:44:32.000069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5ECAC320>]}
[0m16:44:32.000069 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.88s]
[0m16:44:32.005251 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:44:32.084852 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EF3FA40>]}
[0m16:44:32.084852 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.95s]
[0m16:44:32.099123 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:44:32.100118 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:44:32.100118 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:44:32.100118 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:44:32.100118 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:44:32.100118 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:44:32.100118 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:44:32.100118 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:44:32.100118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2a)
[0m16:44:32.100118 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:44:32.100118 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:44:32.100118 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:44:32.100118 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:44:32.100118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m16:44:32.116749 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:44:32.120776 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:44:32.122788 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:44:32.122788 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:44:32.125936 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:44:32.129957 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:44:32.136765 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:44:32.136765 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:44:32.100118 => 16:44:32.136765
[0m16:44:32.136765 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:44:32.116749 => 16:44:32.136765
[0m16:44:32.140590 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:44:32.140590 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:44:32.148161 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:44:32.156218 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:44:32.157177 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:44:32.125936 => 16:44:32.156218
[0m16:44:32.158207 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:44:32.131392 => 16:44:32.157177
[0m16:44:32.159171 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:44:32.159171 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:44:32.164171 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:44:32.170173 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:44:32.172173 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:44:32.174174 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:44:32.175177 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:44:32.177175 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:44:32.178176 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        payment_month >= ADD_MONTHS(current_date, -12)
    GROUP BY
        c.customer_id,
        c.customer_name
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:44:32.179212 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:44:32.180212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:32.181176 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:44:32.181476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:32.181476 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:44:32.181476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:32.185011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:32.683050 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:32.686818 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:44:32.140590 => 16:44:32.686818
[0m16:44:32.686818 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:44:32.699886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:32.700842 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:44:32.160206 => 16:44:32.700842
[0m16:44:32.700842 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:44:32.716359 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:32.717354 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:44:32.165174 => 16:44:32.717354
[0m16:44:32.717354 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:44:32.734234 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:32.734234 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:44:32.148161 => 16:44:32.734234
[0m16:44:32.734234 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:44:32.800687 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EA19850>]}
[0m16:44:32.800687 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:44:32.800687 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:44:32.800687 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m16:44:32.807338 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:44:32.807338 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m16:44:32.807338 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:44:32.807338 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:44:32.815412 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:44:32.807338 => 16:44:32.807338
[0m16:44:32.816426 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:44:32.822334 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:44:32.822334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EF15490>]}
[0m16:44:32.827876 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:44:32.829888 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EF15400>]}
[0m16:44:32.822334 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:44:32.829888 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:44:32.834169 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:44:32.833171 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:44:32.835207 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:32.836204 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_7
[0m16:44:32.837168 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:44:32.838168 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:44:32.843169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m16:44:32.844168 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:44:32.849169 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:44:32.851174 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:44:32.844168 => 16:44:32.851174
[0m16:44:32.852171 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:44:32.858169 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:44:32.863170 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:44:32.864205 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:44:32.864205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:32.865512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EF48380>]}
[0m16:44:32.865512 [info ] [Thread-2 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:44:32.871286 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:44:33.344865 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:33.350829 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:44:32.817425 => 16:44:33.350829
[0m16:44:33.350829 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m16:44:33.452167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:33.456188 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:44:32.852171 => 16:44:33.456188
[0m16:44:33.456188 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: Close
[0m16:44:33.458196 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5EA1BD70>]}
[0m16:44:33.458196 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:44:33.458196 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:44:33.566109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af7c21a-716e-417b-a492-8aa75f57aa8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B013080>]}
[0m16:44:33.567208 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:44:33.568581 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:44:33.568581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:44:33.568581 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:44:33.568581 [info ] [MainThread]: 
[0m16:44:33.568581 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m16:44:33.568581 [debug] [MainThread]: Command end result
[0m16:44:33.599408 [info ] [MainThread]: 
[0m16:44:33.601565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:33.603565 [info ] [MainThread]: 
[0m16:44:33.604580 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:44:33.607566 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:33.607566 after 5.68 seconds
[0m16:44:33.607566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5CD2A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B013080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B58A42BA0>]}
[0m16:44:33.608563 [debug] [MainThread]: Flushing usage events
[0m16:45:52.404506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176197612E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176197616D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017619763C80>]}


============================== 16:45:52.436571 | d8512a32-a53f-4dbd-948d-5dc25d2fb641 ==============================
[0m16:45:52.436571 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:45:52.436571 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:45:55.861986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017619E910D0>]}
[0m16:45:55.977965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176197C1C70>]}
[0m16:45:55.987677 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:45:56.005866 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:45:57.574601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:45:57.575565 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:45:57.760837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A002750>]}
[0m16:45:57.788483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A0781D0>]}
[0m16:45:57.788483 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:45:57.788483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A205FA0>]}
[0m16:45:57.788483 [info ] [MainThread]: 
[0m16:45:57.788483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:57.788483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:45:57.813039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:45:57.817229 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:45:57.820264 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:45:57.821257 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:45:57.821257 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:45:57.822228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:57.823229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:58.940960 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:45:58.957427 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:45:58.980149 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:45:58.983151 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:45:59.081562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:45:59.081562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:45:59.097697 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:45:59.097697 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:45:59.097697 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:45:59.097697 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:45:59.097697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:59.097697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:59.506205 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:45:59.513207 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:45:59.519137 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:45:59.523190 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:45:59.631433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A38FA10>]}
[0m16:45:59.631433 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:59.631433 [info ] [MainThread]: 
[0m16:45:59.631433 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:45:59.631433 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:45:59.631433 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:45:59.631433 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:45:59.631433 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:45:59.647328 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:45:59.649485 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:45:59.647328 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:45:59.651879 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:45:59.653117 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:45:59.650498 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:45:59.654221 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:45:59.655263 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:45:59.666429 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:45:59.667437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:45:59.667437 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:45:59.669315 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:45:59.669315 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:45:59.669315 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:45:59.669315 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:45:59.688128 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:45:59.655263 => 16:45:59.686115
[0m16:45:59.690139 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:45:59.786027 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:45:59.669315 => 16:45:59.786027
[0m16:45:59.786027 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:45:59.669315 => 16:45:59.786027
[0m16:45:59.786027 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:45:59.786027 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:45:59.786027 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:45:59.786027 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:45:59.669315 => 16:45:59.786027
[0m16:45:59.786027 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:45:59.786027 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:45:59.786027 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:45:59.786027 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:45:59.801766 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:45:59.801766 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:45:59.801766 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:45:59.801766 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:45:59.801766 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:45:59.801766 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:45:59.801766 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:45:59.801766 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:45:59.801766 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:59.801766 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:45:59.801766 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:45:59.817642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:46:00.251220 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:46:00.251220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:46:00.288667 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:45:59.786027 => 16:46:00.288667
[0m16:46:00.298728 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:45:59.690139 => 16:46:00.298728
[0m16:46:00.301584 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:46:00.301584 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:46:00.379442 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:46:00.379442 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:45:59.786027 => 16:46:00.379442
[0m16:46:00.379442 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:46:00.395182 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:46:00.395182 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:45:59.786027 => 16:46:00.395182
[0m16:46:00.395182 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:46:00.395182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A532870>]}
[0m16:46:00.395182 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.74s]
[0m16:46:00.395182 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:46:00.411337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A328650>]}
[0m16:46:00.411337 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.76s]
[0m16:46:00.411337 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:46:00.495487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A5327E0>]}
[0m16:46:00.496488 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.83s]
[0m16:46:00.497190 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:46:00.504066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A532810>]}
[0m16:46:00.505096 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m16:46:00.506065 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:46:00.507074 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:46:00.509064 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:46:00.509064 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:46:00.508098 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:46:00.511063 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:46:00.510064 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:46:00.513064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:46:00.511063 [info ] [Thread-4 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:46:00.515097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2a)
[0m16:46:00.515097 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:46:00.516184 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2b)
[0m16:46:00.513064 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:46:00.517195 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:46:00.522300 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:46:00.523299 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:46:00.524333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:46:00.525191 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:46:00.533613 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:46:00.533613 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:46:00.538651 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:46:00.540614 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:46:00.517195 => 16:46:00.539648
[0m16:46:00.541614 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:46:00.554217 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:46:00.556225 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:46:00.525191 => 16:46:00.556225
[0m16:46:00.558227 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:46:00.524876 => 16:46:00.557235
[0m16:46:00.558227 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:46:00.534611 => 16:46:00.558227
[0m16:46:00.559242 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:46:00.560224 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:46:00.562223 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:46:00.562223 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:46:00.567261 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:46:00.571772 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:46:00.572772 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:46:00.576738 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:46:00.577748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:46:00.581714 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:46:00.582750 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    GROUP BY
        c.customer_id,
        c.customer_name
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:46:00.583751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:00.585747 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:46:00.588747 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:46:00.589740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:46:00.590747 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:46:00.591714 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:46:00.591714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:46:01.039175 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:46:01.042695 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:46:00.543549 => 16:46:01.042695
[0m16:46:01.042695 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:46:01.044703 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:46:01.044703 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:46:00.572772 => 16:46:01.044703
[0m16:46:01.044703 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:46:01.044703 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:46:01.056567 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:46:00.563258 => 16:46:01.056567
[0m16:46:01.056567 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:46:01.137501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:46:01.137501 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:46:00.567261 => 16:46:01.137501
[0m16:46:01.137501 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:46:01.137501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A301670>]}
[0m16:46:01.137501 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:46:01.137501 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:46:01.137501 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:46:01.153240 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:46:01.153240 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A3022D0>]}
[0m16:46:01.153240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m16:46:01.153240 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:46:01.160935 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:46:01.153240 [info ] [Thread-4 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:46:01.162175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A07A8A0>]}
[0m16:46:01.163184 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:46:01.165581 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_7
[0m16:46:01.164494 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:46:01.166578 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:46:01.168207 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:46:01.153240 => 16:46:01.167580
[0m16:46:01.166578 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:46:01.168561 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:46:01.171275 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m16:46:01.172213 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:46:01.177488 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:46:01.181530 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:46:01.182531 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:46:01.182531 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:46:01.178532 => 16:46:01.182531
[0m16:46:01.182531 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:46:01.182531 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:46:01.186751 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:46:01.191793 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:46:01.198394 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:46:01.199391 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:46:01.200392 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:46:01.248808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A02BDD0>]}
[0m16:46:01.249808 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.73s]
[0m16:46:01.250808 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:46:01.702355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:46:01.718383 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:46:01.171275 => 16:46:01.718383
[0m16:46:01.718383 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:46:01.734366 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:46:01.734366 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:46:01.186751 => 16:46:01.734366
[0m16:46:01.734366 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: Close
[0m16:46:01.836899 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017619E3BCB0>]}
[0m16:46:01.836899 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:46:01.854842 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:46:01.856864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8512a32-a53f-4dbd-948d-5dc25d2fb641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A515A00>]}
[0m16:46:01.856864 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:46:01.856864 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:46:01.862704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:01.862704 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:46:01.863713 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:46:01.864700 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:46:01.865198 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:46:01.865664 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:46:01.866050 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:46:01.866050 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:46:01.867148 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:46:01.867148 [info ] [MainThread]: 
[0m16:46:01.868177 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m16:46:01.872713 [debug] [MainThread]: Command end result
[0m16:46:01.888996 [info ] [MainThread]: 
[0m16:46:01.891021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:01.891021 [info ] [MainThread]: 
[0m16:46:01.893560 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:46:01.895568 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:01.895568 after 9.59 seconds
[0m16:46:01.895568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176196596D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761968F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001761A2F3EC0>]}
[0m16:46:01.896569 [debug] [MainThread]: Flushing usage events
[0m16:48:06.450192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE0616A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE0617C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE061460>]}


============================== 16:48:06.458486 | 4d97fd15-7a73-4689-84ff-68d4240c46ff ==============================
[0m16:48:06.458486 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:48:06.458486 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:48:07.204060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5ACEDCB00>]}
[0m16:48:07.346776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE5DFBC0>]}
[0m16:48:07.347776 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:48:07.365606 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:48:07.541884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:07.542886 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:48:07.946786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEBFBDD0>]}
[0m16:48:07.963012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE9BCC50>]}
[0m16:48:07.964116 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:48:07.965114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE9BC980>]}
[0m16:48:07.968113 [info ] [MainThread]: 
[0m16:48:07.970113 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:07.973121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:48:07.981652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:48:08.008243 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:48:08.012238 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:48:08.014242 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:48:08.015242 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:48:08.016241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:08.017238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:08.921834 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:48:08.923834 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:48:08.962535 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:48:08.963988 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:48:09.066073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:48:09.069786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:48:09.088386 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:48:09.085747 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:48:09.089386 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:48:09.090387 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:48:09.090387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:09.091385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:09.447541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:48:09.447541 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:48:09.566523 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:48:09.566523 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:48:09.662493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE062990>]}
[0m16:48:09.663494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:09.665451 [info ] [MainThread]: 
[0m16:48:09.671640 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:48:09.671640 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:48:09.673681 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:48:09.673681 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:48:09.672673 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:48:09.674714 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:48:09.677680 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:48:09.675679 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:48:09.678681 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:48:09.679715 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:48:09.675679 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:48:09.682516 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:48:09.683516 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:48:09.685518 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:48:09.696120 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:48:09.697158 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:48:09.700994 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:48:09.700994 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:48:09.707017 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:48:09.707017 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:48:09.707017 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:48:09.683516 => 16:48:09.707017
[0m16:48:09.707017 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:48:09.714683 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:48:09.697158 => 16:48:09.714252
[0m16:48:09.715605 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:48:09.715605 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:48:09.703002 => 16:48:09.715605
[0m16:48:09.730046 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:48:09.707017 => 16:48:09.730046
[0m16:48:09.813324 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:48:09.814954 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:48:09.814954 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:48:09.814954 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:48:09.830443 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:48:09.830443 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:48:09.830443 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:48:09.830443 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:48:09.830443 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:09.830443 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:48:09.830443 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:48:09.830443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:09.846288 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:48:09.846288 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:48:09.846288 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:48:09.846288 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:48:09.846288 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:09.846288 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:10.314617 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:10.345512 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:48:09.830443 => 16:48:10.344505
[0m16:48:10.345512 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:48:10.348471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:10.353124 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:48:09.707017 => 16:48:10.352125
[0m16:48:10.354122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:10.354122 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:48:10.358403 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:48:09.730046 => 16:48:10.357088
[0m16:48:10.359404 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:48:10.440832 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:10.443835 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:48:09.814954 => 16:48:10.443835
[0m16:48:10.444799 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:48:10.452604 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEDA0DD0>]}
[0m16:48:10.453585 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:48:10.455768 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:48:10.458754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEDA0BF0>]}
[0m16:48:10.459753 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEC67AD0>]}
[0m16:48:10.460719 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.78s]
[0m16:48:10.462749 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:48:10.461593 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.78s]
[0m16:48:10.463749 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:48:10.535390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEC3EE40>]}
[0m16:48:10.536389 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m16:48:10.537390 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:48:10.538389 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:48:10.539391 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:48:10.540391 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:48:10.541389 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:48:10.540391 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:48:10.542388 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:48:10.544392 [info ] [Thread-4 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:48:10.546391 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:48:10.544392 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:48:10.548393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2a)
[0m16:48:10.550048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2b)
[0m16:48:10.551049 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:48:10.553050 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:48:10.554051 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:48:10.556052 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:48:10.562049 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:48:10.563048 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:48:10.569740 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:48:10.573738 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:48:10.577744 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:48:10.580745 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:48:10.556052 => 16:48:10.579743
[0m16:48:10.581747 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:48:10.587353 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:48:10.589354 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:48:10.563048 => 16:48:10.588353
[0m16:48:10.589354 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:48:10.590860 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:48:10.574737 => 16:48:10.590354
[0m16:48:10.596907 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:48:10.597870 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:48:10.570734 => 16:48:10.596907
[0m16:48:10.597870 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:48:10.598870 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:48:10.604126 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:48:10.606089 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:48:10.609757 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:48:10.610722 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:48:10.612722 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:48:10.612722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:10.613724 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -12) as twelve_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    GROUP BY
        c.customer_id,
        c.customer_name
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:48:10.615581 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:48:10.616765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:10.618780 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:48:10.621776 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:48:10.622774 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:48:10.624772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:10.625774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:11.104201 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:11.104201 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:48:10.582219 => 16:48:11.104201
[0m16:48:11.116136 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:48:11.118145 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:11.121104 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:48:10.600095 => 16:48:11.121104
[0m16:48:11.121104 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:48:11.153683 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:11.153683 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:48:10.606714 => 16:48:11.153683
[0m16:48:11.153683 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:48:11.213418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEBFBB90>]}
[0m16:48:11.216210 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:48:11.218220 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:48:11.219230 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:48:11.220220 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:48:11.220220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m16:48:11.220220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE9BF3E0>]}
[0m16:48:11.220220 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:48:11.220220 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m16:48:11.220220 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:48:11.220220 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m16:48:11.232962 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:48:11.220220 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:48:11.235977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_7)
[0m16:48:11.236974 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:48:11.242543 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:48:11.242543 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:48:11.220220 => 16:48:11.242543
[0m16:48:11.242543 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:48:11.254607 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:48:11.255606 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:48:11.237951 => 16:48:11.255606
[0m16:48:11.256607 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:48:11.261636 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:48:11.263606 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE9BCAA0>]}
[0m16:48:11.268336 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:48:11.263606 [info ] [Thread-4 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.71s]
[0m16:48:11.270330 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:48:11.271316 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:48:11.271316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:11.274375 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:48:11.276390 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:48:11.276390 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:11.286099 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0046-0001-429a-0008-4d9600021a8e
[0m16:48:11.287101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 10 at position 8
'H.PAYMENT_MONTH' in select clause is neither an aggregate nor in the group by clause.
[0m16:48:11.288103 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:48:10.590860 => 16:48:11.288103
[0m16:48:11.289163 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:48:11.405132 [debug] [Thread-1 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 10 at position 8
  'H.PAYMENT_MONTH' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:48:11.405132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEBF2BA0>]}
[0m16:48:11.405132 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.86s]
[0m16:48:11.413333 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:48:11.820919 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:11.820919 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:48:11.242543 => 16:48:11.820919
[0m16:48:11.820919 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:48:11.838742 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:11.838742 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:48:11.257611 => 16:48:11.838742
[0m16:48:11.838742 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m16:48:11.906248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AEAC93D0>]}
[0m16:48:11.906248 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:48:11.918443 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:48:11.954482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d97fd15-7a73-4689-84ff-68d4240c46ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE9BE600>]}
[0m16:48:11.954482 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:48:11.954482 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:48:11.954482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:48:11.954482 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:48:11.954482 [info ] [MainThread]: 
[0m16:48:11.968022 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m16:48:11.971163 [debug] [MainThread]: Command end result
[0m16:48:11.995579 [info ] [MainThread]: 
[0m16:48:11.996582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:48:11.997581 [info ] [MainThread]: 
[0m16:48:11.998612 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  001104 (42601): SQL compilation error: error line 10 at position 8
  'H.PAYMENT_MONTH' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:48:12.000581 [info ] [MainThread]: 
[0m16:48:12.002582 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:48:12.004580 [debug] [MainThread]: Command `dbt run` failed at 16:48:12.004580 after 5.64 seconds
[0m16:48:12.005597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE061460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE062B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5AE0616A0>]}
[0m16:48:12.006583 [debug] [MainThread]: Flushing usage events
[0m16:49:04.535494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2CC94530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2CC950D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2CC956D0>]}


============================== 16:49:04.535494 | 4dcddad3-610a-46cc-b547-849ea3629bfa ==============================
[0m16:49:04.535494 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:49:04.535494 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:49:05.084886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D1F9BE0>]}
[0m16:49:05.200345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2CDDBEF0>]}
[0m16:49:05.202352 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:49:05.202352 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:49:05.350591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:49:05.350591 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:49:05.543393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D6C9130>]}
[0m16:49:05.554767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D5BC770>]}
[0m16:49:05.554767 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:49:05.554767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2CC96DE0>]}
[0m16:49:05.561144 [info ] [MainThread]: 
[0m16:49:05.561144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:05.561144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:49:05.570244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:49:05.587558 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:49:05.590591 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:49:05.591590 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:49:05.591590 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:49:05.593101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:05.593101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:06.711942 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:49:06.713905 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:49:06.753519 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:49:06.769265 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:49:06.882153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:49:06.886906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:49:06.895940 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:49:06.897948 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:49:06.897948 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:49:06.897948 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:49:06.897948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:06.897948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:07.255376 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:49:07.255376 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:49:07.270507 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:49:07.272925 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:49:07.389571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D70F260>]}
[0m16:49:07.395266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:49:07.397285 [info ] [MainThread]: 
[0m16:49:07.399344 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:49:07.399344 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:49:07.399344 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:49:07.399344 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:49:07.399344 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:49:07.399344 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:49:07.414302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:49:07.399344 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:49:07.416315 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:49:07.417347 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:49:07.415348 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:49:07.419293 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:49:07.419293 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:49:07.422915 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:49:07.422915 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:49:07.422915 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:49:07.422915 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:49:07.439481 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:49:07.422915 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:49:07.439481 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:49:07.439481 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:49:07.420288 => 16:49:07.439481
[0m16:49:07.439481 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:49:07.479049 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:49:07.422915 => 16:49:07.479049
[0m16:49:07.479049 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:49:07.439481 => 16:49:07.479049
[0m16:49:07.479049 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:49:07.438586 => 16:49:07.479049
[0m16:49:07.490543 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:49:07.490543 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:49:07.497693 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:49:07.497693 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:49:07.555679 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:49:07.555679 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:49:07.555679 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:49:07.555679 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:49:07.555679 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:49:07.555679 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:49:07.555679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:07.571607 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:49:07.571607 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:49:07.573616 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:49:07.573616 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:49:07.573616 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:49:07.573616 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:49:07.582405 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:49:07.582405 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:49:08.028396 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:49:08.068137 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:49:07.497693 => 16:49:08.068137
[0m16:49:08.068137 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:49:08.068137 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:49:08.068137 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:49:07.555679 => 16:49:08.068137
[0m16:49:08.068137 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:49:08.158180 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D8DB8C0>]}
[0m16:49:08.158180 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:08.172997 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D9CDBB0>]}
[0m16:49:08.158180 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.74s]
[0m16:49:08.176982 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:49:07.555679 => 16:49:08.176982
[0m16:49:08.178678 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:49:08.177624 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.74s]
[0m16:49:08.179632 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:49:08.180631 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:49:08.190678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:08.195700 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:49:07.439481 => 16:49:08.194700
[0m16:49:08.195700 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:49:08.271369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D9CE870>]}
[0m16:49:08.272369 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m16:49:08.274344 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:49:08.274344 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:49:08.274344 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:49:08.276447 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:49:08.276447 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:49:08.276447 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:49:08.278453 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:49:08.278453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2a)
[0m16:49:08.278453 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:49:08.278453 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:49:08.278453 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:49:08.283264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_2b)
[0m16:49:08.287316 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:49:08.291836 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:49:08.291836 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:49:08.295302 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:49:08.299166 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:49:08.288302 => 16:49:08.295302
[0m16:49:08.299770 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:49:08.283264 => 16:49:08.299770
[0m16:49:08.299770 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:49:08.302775 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:49:08.293043 => 16:49:08.301785
[0m16:49:08.302775 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:49:08.308370 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:49:08.309314 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:49:08.313313 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:49:08.313313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D9B1430>]}
[0m16:49:08.313313 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:49:08.323046 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.91s]
[0m16:49:08.325075 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:49:08.326054 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_5
[0m16:49:08.326911 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:49:08.326911 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -12) as twelve_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:49:08.326911 [info ] [Thread-1 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:49:08.326911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:49:08.326911 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:49:08.326911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_5)
[0m16:49:08.337033 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:49:08.337033 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:49:08.337033 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:49:08.340753 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:49:08.342755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:49:08.346787 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:49:08.347751 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:49:08.353208 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:49:08.343752 => 16:49:08.351190
[0m16:49:08.353208 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:49:08.359410 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:49:08.363101 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:49:08.363101 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:49:08.363101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:08.814051 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:49:08.818051 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:49:08.309314 => 16:49:08.818051
[0m16:49:08.818051 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:49:08.821016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:49:08.823525 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:49:08.353208 => 16:49:08.823525
[0m16:49:08.823525 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_5: Close
[0m16:49:08.823525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:49:08.823525 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:49:08.313313 => 16:49:08.823525
[0m16:49:08.823525 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:49:08.854910 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:08.870836 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:49:08.303817 => 16:49:08.870836
[0m16:49:08.870836 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:49:08.919214 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D9B3A10>]}
[0m16:49:08.935142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D9B0E90>]}
[0m16:49:08.919214 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:49:08.935142 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:49:08.942164 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m16:49:08.935142 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:49:08.946001 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:49:08.947998 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m16:49:08.942164 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:49:08.951897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m16:49:08.953895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2DA3A660>]}
[0m16:49:08.954892 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:49:08.949895 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:49:08.963741 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:49:08.957580 [info ] [Thread-1 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:49:08.965775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m16:49:08.966775 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:49:08.967740 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:49:08.973722 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:49:08.974762 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:49:08.958797 => 16:49:08.974762
[0m16:49:08.976735 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:49:08.980732 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:49:08.982730 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:49:08.967740 => 16:49:08.981732
[0m16:49:08.982730 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:49:08.987570 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:49:08.991313 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:49:08.993722 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:49:08.995742 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:49:08.995742 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:49:08.997754 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D5BE5D0>]}
[0m16:49:08.997754 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:49:09.001269 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:49:09.001269 [info ] [Thread-2 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:49:09.003277 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:49:09.512017 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:09.527184 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:49:08.976735 => 16:49:09.526876
[0m16:49:09.527184 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m16:49:09.549762 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:09.552888 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:49:08.983542 => 16:49:09.552888
[0m16:49:09.553887 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m16:49:09.613865 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D7A29C0>]}
[0m16:49:09.613865 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:49:09.613865 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:49:09.659709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcddad3-610a-46cc-b547-849ea3629bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2D7A29C0>]}
[0m16:49:09.659709 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:49:09.659709 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:49:09.659709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:49:09.659709 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:49:09.659709 [info ] [MainThread]: 
[0m16:49:09.659709 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m16:49:09.674756 [debug] [MainThread]: Command end result
[0m16:49:09.692151 [info ] [MainThread]: 
[0m16:49:09.694146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:09.695554 [info ] [MainThread]: 
[0m16:49:09.695554 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:49:09.695554 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:09.695554 after 5.24 seconds
[0m16:49:09.695554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2C60A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2C881040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2C882480>]}
[0m16:49:09.700880 [debug] [MainThread]: Flushing usage events
[0m16:50:45.606452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A635D4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A635D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A635F0E0>]}


============================== 16:50:45.623939 | 393c7663-19a9-4b4b-ad71-72b7ac523808 ==============================
[0m16:50:45.623939 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:50:45.623939 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:50:46.152254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6A3E690>]}
[0m16:50:46.275583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A64B06E0>]}
[0m16:50:46.287262 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:50:46.298538 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:50:46.433909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:50:46.433909 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:50:46.626778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A695BD70>]}
[0m16:50:46.646712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6CB8950>]}
[0m16:50:46.646712 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:50:46.647710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6AF68D0>]}
[0m16:50:46.650745 [info ] [MainThread]: 
[0m16:50:46.651417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:46.654307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:50:46.671012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:50:46.672056 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:50:46.675080 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:50:46.676022 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:50:46.676577 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:50:46.676577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:46.677620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:47.815098 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:50:47.817130 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:50:47.856499 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:50:47.856499 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:50:47.986075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:50:47.989005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:50:47.999172 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:50:48.000408 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:50:48.000408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:48.003450 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:50:48.004440 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:50:48.004440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:48.338052 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:50:48.345166 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:50:48.487532 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:50:48.499130 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:50:48.599945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6F3F650>]}
[0m16:50:48.599945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:48.599945 [info ] [MainThread]: 
[0m16:50:48.615621 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:50:48.615621 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:50:48.615621 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:50:48.615621 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:50:48.615621 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:50:48.615621 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:50:48.623306 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:50:48.622104 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:50:48.625315 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:50:48.624350 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:50:48.626315 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:50:48.627349 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:50:48.627349 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:50:48.629348 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:50:48.639313 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:50:48.639313 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:50:48.643893 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:50:48.644858 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:50:48.646573 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:50:48.646573 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:50:48.656229 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:50:48.640350 => 16:50:48.646573
[0m16:50:48.657245 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:50:48.658253 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:50:48.629348 => 16:50:48.658253
[0m16:50:48.659240 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:50:48.644858 => 16:50:48.659240
[0m16:50:48.692708 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:50:48.703707 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:50:48.704707 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:50:48.646573 => 16:50:48.703707
[0m16:50:48.704707 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:50:48.760344 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:50:48.761348 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:50:48.765343 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:50:48.769344 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:50:48.771310 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:50:48.772309 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:50:48.773035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:50:48.773807 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:50:48.774897 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:50:48.775911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:48.780877 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:50:48.781912 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:50:48.782910 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:50:48.783910 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:50:48.784915 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:50:48.784915 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:50:49.264154 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:50:49.291373 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:50:49.295371 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:50:48.660239 => 16:50:49.294371
[0m16:50:49.298372 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:50:48.766311 => 16:50:49.298372
[0m16:50:49.299371 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:50:49.300337 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:50:49.301336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:50:49.306995 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:50:48.705714 => 16:50:49.306995
[0m16:50:49.306995 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:50:49.370723 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:50:49.388134 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:50:48.762319 => 16:50:49.386827
[0m16:50:49.388477 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:50:49.414267 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6B207A0>]}
[0m16:50:49.416277 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.78s]
[0m16:50:49.419231 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:50:49.422256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6D34290>]}
[0m16:50:49.425773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6D06720>]}
[0m16:50:49.423759 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.80s]
[0m16:50:49.428782 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:50:49.425773 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.80s]
[0m16:50:49.429785 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:50:49.480523 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6D06E40>]}
[0m16:50:49.480523 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m16:50:49.480523 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:50:49.490384 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:50:49.491394 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:50:49.491394 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:50:49.493435 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:50:49.492427 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:50:49.494394 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:50:49.497058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:50:49.494394 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:50:49.498727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2a)
[0m16:50:49.499725 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:50:49.500262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2b)
[0m16:50:49.495395 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:50:49.500262 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:50:49.504281 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:50:49.507082 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:50:49.508092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:50:49.512125 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:50:49.516124 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:50:49.516124 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:50:49.520124 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:50:49.521124 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:50:49.500262 => 16:50:49.521124
[0m16:50:49.522121 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:50:49.527253 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:50:49.528252 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:50:49.508092 => 16:50:49.528252
[0m16:50:49.529254 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:50:49.517090 => 16:50:49.529254
[0m16:50:49.530260 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:50:49.531145 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:50:49.538699 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:50:49.540475 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:50:49.513090 => 16:50:49.538699
[0m16:50:49.545480 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:50:49.547390 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:50:49.547390 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:50:49.547390 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:50:49.547390 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:50:49.554231 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:50:49.556239 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:50:49.557147 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -12) as twelve_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent,
        payment_month,
        twelve_months_ago
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:50:49.558157 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:50:49.560157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:49.560157 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:50:49.563154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:50:49.563767 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:50:49.563767 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:50:49.563767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:50.006601 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:50:50.022695 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:50:49.547390 => 16:50:50.022695
[0m16:50:50.022695 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:50:50.022695 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:50:50.039445 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:50:49.540475 => 16:50:50.039445
[0m16:50:50.039445 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:50:50.054553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:50:50.054553 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:50:49.531145 => 16:50:50.054553
[0m16:50:50.054553 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:50:50.086998 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:50:50.086998 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:50:49.523091 => 16:50:50.086998
[0m16:50:50.102741 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:50:50.102741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6EF93D0>]}
[0m16:50:50.102741 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.60s]
[0m16:50:50.117224 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:50:50.118049 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:50:50.119139 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:50:50.120135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_6)
[0m16:50:50.120135 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:50:50.124756 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:50:50.125865 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:50:50.121173 => 16:50:50.125865
[0m16:50:50.126906 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:50:50.130763 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:50:50.133760 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:50:50.133760 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:50:50.134760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:50:50.140231 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6E9B7D0>]}
[0m16:50:50.141210 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:50:50.144525 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:50:50.144525 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m16:50:50.145525 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:50:50.147454 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_7)
[0m16:50:50.148026 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:50:50.152171 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:50:50.155969 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:50:50.148026 => 16:50:50.154960
[0m16:50:50.155969 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:50:50.158004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A80A91C0>]}
[0m16:50:50.162517 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:50:50.164527 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:50:50.166539 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:50:50.168826 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:50:50.168826 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:50:50.169871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:50:50.195100 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A80ABEF0>]}
[0m16:50:50.196101 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:50:50.197102 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:50:50.635165 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:50:50.637670 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:50:50.126906 => 16:50:50.637670
[0m16:50:50.637670 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:50:50.716622 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:50:50.716622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6E9A2D0>]}
[0m16:50:50.732610 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:50:50.158490 => 16:50:50.732610
[0m16:50:50.732610 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m16:50:50.732610 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.60s]
[0m16:50:50.732610 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:50:50.827895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c7663-19a9-4b4b-ad71-72b7ac523808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A231A5A0>]}
[0m16:50:50.827895 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:50:50.827895 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:50:50.827895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:50:50.827895 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m16:50:50.827895 [info ] [MainThread]: 
[0m16:50:50.827895 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m16:50:50.842043 [debug] [MainThread]: Command end result
[0m16:50:50.856042 [info ] [MainThread]: 
[0m16:50:50.857042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:50.859041 [info ] [MainThread]: 
[0m16:50:50.860322 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:50:50.862357 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:50.862357 after 5.33 seconds
[0m16:50:50.863357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A678A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A695BD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6540560>]}
[0m16:50:50.863357 [debug] [MainThread]: Flushing usage events
[0m16:56:38.942078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20EF61730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20EE72390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20EF61940>]}


============================== 16:56:38.949250 | 59b44bf8-dbd3-4f10-ba44-2756ebfef4f0 ==============================
[0m16:56:38.949250 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:38.949250 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:56:39.493238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210681D60>]}
[0m16:56:39.621748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210584D10>]}
[0m16:56:39.622370 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:56:39.633985 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:39.796682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:39.796682 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:56:39.984362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210AE3B90>]}
[0m16:56:40.001586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2108BCC20>]}
[0m16:56:40.004153 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:56:40.004153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2109F5340>]}
[0m16:56:40.004153 [info ] [MainThread]: 
[0m16:56:40.004153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:40.010596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:56:40.019129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:56:40.033399 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:56:40.033399 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:56:40.033399 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:56:40.039437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:40.039437 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:56:40.041447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:40.906762 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:56:40.919464 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:56:41.015701 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:56:41.015701 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:56:41.111732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:56:41.111732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:56:41.127512 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:56:41.138086 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:56:41.138086 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:56:41.138086 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:56:41.138086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:41.138086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:41.468460 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:56:41.484250 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:56:41.875160 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:56:41.875160 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:56:42.002885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210BAF290>]}
[0m16:56:42.002885 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:56:42.002885 [info ] [MainThread]: 
[0m16:56:42.018748 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:56:42.018748 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:56:42.018748 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:56:42.018748 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:56:42.018748 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:56:42.024292 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:56:42.026335 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:56:42.024292 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:56:42.028342 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:56:42.028342 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:56:42.025303 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:56:42.030301 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:56:42.030301 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:56:42.042337 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:56:42.042772 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:56:42.044782 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:56:42.048802 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:56:42.048802 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:56:42.048802 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:56:42.057989 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:56:42.062371 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:56:42.044782 => 16:56:42.060332
[0m16:56:42.062371 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:56:42.062371 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:56:42.031336 => 16:56:42.062371
[0m16:56:42.075482 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:56:42.160569 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:56:42.160569 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:56:42.048802 => 16:56:42.160569
[0m16:56:42.174586 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:56:42.174586 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:56:42.174586 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:56:42.048802 => 16:56:42.174586
[0m16:56:42.174586 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:56:42.174586 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:56:42.174586 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:56:42.174586 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:56:42.174586 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:56:42.174586 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:56:42.190386 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:56:42.190386 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:56:42.190386 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:56:42.190386 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:56:42.190386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:42.190386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:56:42.194991 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:56:42.194991 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:56:42.194991 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:56:42.650687 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:56:42.650687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:56:42.682302 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:42.682302 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:56:42.174586 => 16:56:42.682302
[0m16:56:42.692098 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:56:42.075482 => 16:56:42.692098
[0m16:56:42.692098 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:56:42.062371 => 16:56:42.692098
[0m16:56:42.692098 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:56:42.697979 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:56:42.697979 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:56:42.761777 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:42.761777 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:56:42.174586 => 16:56:42.761777
[0m16:56:42.761777 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:56:42.795374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210D03C20>]}
[0m16:56:42.795374 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.77s]
[0m16:56:42.795374 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:56:42.810101 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210CCD7F0>]}
[0m16:56:42.811064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210CCD5B0>]}
[0m16:56:42.812064 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.77s]
[0m16:56:42.814591 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:56:42.813519 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.78s]
[0m16:56:42.815588 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:56:42.883637 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21090B5F0>]}
[0m16:56:42.884636 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m16:56:42.885602 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:56:42.886631 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m16:56:42.888601 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:56:42.888601 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:56:42.887637 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:56:42.890601 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:56:42.889602 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:56:42.893558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m16:56:42.891603 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:56:42.895465 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m16:56:42.894386 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:56:42.896463 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:56:42.897462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2b)
[0m16:56:42.897462 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:56:42.898497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:56:42.902463 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:56:42.903499 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:56:42.907449 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:56:42.908483 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:56:42.913188 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:56:42.919818 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:56:42.921827 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:56:42.899497 => 16:56:42.921827
[0m16:56:42.921827 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:56:42.928210 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:56:42.930175 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:56:42.915135 => 16:56:42.929208
[0m16:56:42.930175 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:56:42.931177 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:56:42.904441 => 16:56:42.931177
[0m16:56:42.932210 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:56:42.909254 => 16:56:42.932210
[0m16:56:42.939173 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:56:42.940177 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:56:42.940177 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:56:42.943173 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:56:42.948252 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:56:42.953254 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:56:42.953254 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:56:42.955253 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:56:42.956220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:42.956220 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:56:42.957221 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:56:42.959221 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:56:42.961218 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -3) as three_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        h.payment_month >= three_months_ago
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent,
        payment_month,
        twelve_months_ago
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:56:42.961218 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:56:42.967384 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:56:42.967384 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:56:42.968384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:56:43.475338 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb004e-0001-429a-0008-4d9600021cca
[0m16:56:43.475338 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 30 at position 8
invalid identifier 'TWELVE_MONTHS_AGO'
[0m16:56:43.475338 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:56:42.944198 => 16:56:43.475338
[0m16:56:43.475338 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:56:43.539761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:43.539761 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:56:42.921827 => 16:56:43.539761
[0m16:56:43.539761 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m16:56:43.571571 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:43.571571 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:56:42.949219 => 16:56:43.571571
[0m16:56:43.571571 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:56:43.603409 [debug] [Thread-4 (]: Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  000904 (42000): SQL compilation error: error line 30 at position 8
  invalid identifier 'TWELVE_MONTHS_AGO'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:56:43.603409 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210CA1AC0>]}
[0m16:56:43.603409 [error] [Thread-4 (]: 6 of 10 ERROR creating sql view model DESCHEMA_reporting.rpt_2a ................ [[31mERROR[0m in 0.71s]
[0m16:56:43.607168 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:56:43.607168 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m16:56:43.607168 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:56:43.607168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2a, now model.data_engineering_project.rpt_6)
[0m16:56:43.607168 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:56:43.607168 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:56:43.607168 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:56:43.607168 => 16:56:43.607168
[0m16:56:43.607168 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:56:43.623348 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:56:43.625443 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:56:43.626348 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:56:43.626348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:56:43.647670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210CCC9B0>]}
[0m16:56:43.659027 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m16:56:43.660498 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:56:43.660498 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_7
[0m16:56:43.662511 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:56:43.663524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:56:43.663524 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:56:43.663524 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:56:43.663524 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:56:43.663524 => 16:56:43.663524
[0m16:56:43.663524 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:56:43.671649 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:56:43.677081 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:56:43.679106 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:56:43.679106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:43.698139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2108618E0>]}
[0m16:56:43.699711 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.80s]
[0m16:56:43.701729 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:56:43.709040 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:43.713720 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:56:42.933207 => 16:56:43.713720
[0m16:56:43.713720 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:56:43.827884 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210863710>]}
[0m16:56:43.831921 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m16:56:43.831921 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:56:44.319112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:44.321138 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:44.321138 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:56:43.671649 => 16:56:44.321138
[0m16:56:44.332752 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:56:43.607168 => 16:56:44.332752
[0m16:56:44.332752 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: Close
[0m16:56:44.332752 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m16:56:44.458878 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210CD8590>]}
[0m16:56:44.451543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b44bf8-dbd3-4f10-ba44-2756ebfef4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F210CCCFE0>]}
[0m16:56:44.458878 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.85s]
[0m16:56:44.458878 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:56:44.458878 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.79s]
[0m16:56:44.458878 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:56:44.465706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:56:44.465706 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:56:44.465706 [info ] [MainThread]: 
[0m16:56:44.465706 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m16:56:44.473944 [debug] [MainThread]: Command end result
[0m16:56:44.478767 [info ] [MainThread]: 
[0m16:56:44.494854 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:56:44.497857 [info ] [MainThread]: 
[0m16:56:44.498854 [error] [MainThread]:   Database Error in model rpt_2a (models\reporting\rpt_2a.sql)
  000904 (42000): SQL compilation error: error line 30 at position 8
  invalid identifier 'TWELVE_MONTHS_AGO'
  compiled Code at target\run\data_engineering_project\models\reporting\rpt_2a.sql
[0m16:56:44.499884 [info ] [MainThread]: 
[0m16:56:44.500852 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m16:56:44.502852 [debug] [MainThread]: Command `dbt run` failed at 16:56:44.501852 after 5.64 seconds
[0m16:56:44.502852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20EC93410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20EE72390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20EE728A0>]}
[0m16:56:44.503850 [debug] [MainThread]: Flushing usage events
[0m16:57:13.236500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47395190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47395670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA473948F0>]}


============================== 16:57:13.247658 | 64697f62-db2f-4b8b-a8a8-0966889f8bc1 ==============================
[0m16:57:13.247658 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:57:13.247658 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:57:13.769965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47B27BF0>]}
[0m16:57:13.892627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA478BD580>]}
[0m16:57:13.894631 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:57:13.906399 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:57:14.047333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:14.049340 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:57:14.236326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47EE3B60>]}
[0m16:57:14.239840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47CBCA10>]}
[0m16:57:14.239840 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:57:14.239840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47E356A0>]}
[0m16:57:14.254660 [info ] [MainThread]: 
[0m16:57:14.255668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:57:14.255668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:57:14.275933 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:57:14.276933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:57:14.276933 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:57:14.280746 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:57:14.281076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:14.281076 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:57:14.281076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:15.143234 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:57:15.159147 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:57:15.159147 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:57:15.159147 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:57:15.276022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:57:15.279988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:57:15.288031 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:57:15.290996 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:57:15.291996 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:57:15.291996 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:57:15.291996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:15.291996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:15.627872 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:57:15.627872 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:57:15.659798 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:57:15.659798 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:57:15.771288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47E346E0>]}
[0m16:57:15.772287 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:57:15.773256 [info ] [MainThread]: 
[0m16:57:15.779235 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:57:15.780272 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:57:15.781268 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:57:15.781268 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:57:15.782275 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:57:15.783274 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:57:15.785309 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:57:15.783274 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:57:15.787309 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:57:15.787309 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:57:15.788279 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:57:15.785309 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:57:15.789309 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:57:15.795962 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:57:15.800053 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:57:15.800053 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:57:15.805342 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:57:15.811362 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:57:15.812361 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:57:15.815327 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:57:15.815327 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:57:15.800053 => 16:57:15.815327
[0m16:57:15.815327 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:57:15.815327 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:57:15.790309 => 16:57:15.815327
[0m16:57:15.827008 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:57:15.813326 => 16:57:15.827008
[0m16:57:15.827008 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:57:15.863796 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:57:15.864762 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:57:15.805342 => 16:57:15.863796
[0m16:57:15.865408 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:57:15.918655 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:57:15.920664 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:57:15.923436 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:57:15.923436 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:57:15.923436 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:57:15.923436 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:57:15.923436 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:57:15.933680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:15.933680 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:57:15.933680 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:57:15.933680 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:57:15.933680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:57:15.933680 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:57:15.933680 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:57:15.939401 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:57:15.939401 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:57:16.380302 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:57:16.413596 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:57:15.920664 => 16:57:16.413596
[0m16:57:16.413596 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:57:16.421290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:57:16.421290 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:57:15.865983 => 16:57:16.421290
[0m16:57:16.421290 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:57:16.469700 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:57:16.469700 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:57:15.923436 => 16:57:16.469700
[0m16:57:16.469700 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:57:16.502376 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47D35910>]}
[0m16:57:16.502376 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:57:16.502376 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:57:16.536294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4911F3E0>]}
[0m16:57:16.536294 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.75s]
[0m16:57:16.538308 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:57:16.561079 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:57:16.565079 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:57:15.815327 => 16:57:16.564115
[0m16:57:16.565079 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:57:16.566059 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA49109040>]}
[0m16:57:16.566059 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.78s]
[0m16:57:16.566059 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:57:16.566059 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m16:57:16.566059 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:57:16.566059 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:57:16.566059 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:57:16.580299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m16:57:16.576803 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:57:16.580299 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:57:16.582310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m16:57:16.578286 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:57:16.586470 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:57:16.587433 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:57:16.587433 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:57:16.592438 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:57:16.593454 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:57:16.595453 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:57:16.582310 => 16:57:16.594452
[0m16:57:16.600350 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:57:16.602374 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:57:16.608086 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:57:16.610098 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:57:16.587433 => 16:57:16.609095
[0m16:57:16.611124 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:57:16.612096 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:57:16.596447 => 16:57:16.611124
[0m16:57:16.617512 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:57:16.625838 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:57:16.627840 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:57:16.630839 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:57:16.633839 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:57:16.633839 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:57:16.635914 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:57:16.635914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:57:16.635914 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:57:16.640123 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:57:16.640123 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:57:16.640123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:16.686292 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47E9B800>]}
[0m16:57:16.687293 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.90s]
[0m16:57:16.688293 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:57:16.689298 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:57:16.690293 [info ] [Thread-2 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:57:16.691293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_6)
[0m16:57:16.692296 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:57:16.693294 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:57:16.693294 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:57:16.692296 => 16:57:16.693294
[0m16:57:16.698940 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:57:16.698940 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:57:16.698940 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:57:16.698940 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:57:16.698940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:57:17.115208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:57:17.115208 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:57:16.619531 => 16:57:17.115208
[0m16:57:17.115208 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:57:17.115208 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:57:17.130940 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:57:16.602374 => 16:57:17.130940
[0m16:57:17.130940 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m16:57:17.146753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:57:17.146753 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:57:16.612096 => 16:57:17.146753
[0m16:57:17.146753 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:57:17.210327 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4341A750>]}
[0m16:57:17.210327 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:57:17.210327 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:57:17.210327 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:57:17.225999 [info ] [Thread-3 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:57:17.225999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_2a)
[0m16:57:17.228008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47E98680>]}
[0m16:57:17.228008 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:57:17.228008 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:57:17.228008 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:57:17.236923 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:57:17.236923 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_7
[0m16:57:17.238768 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:57:17.239827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_7)
[0m16:57:17.240864 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:57:17.245663 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:57:17.249004 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:57:17.228008 => 16:57:17.247674
[0m16:57:17.250013 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:57:17.254013 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:57:17.254013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:57:17.260472 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:57:16.698940 => 16:57:17.260472
[0m16:57:17.260472 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:57:17.240864 => 16:57:17.260472
[0m16:57:17.263661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4911E780>]}
[0m16:57:17.263661 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:57:17.265672 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:57:17.267683 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:57:17.267683 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:57:17.274521 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:57:17.275520 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -3) as three_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        h.payment_month >= three_months_ago
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent,
        payment_month,
        three_months_ago
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:57:17.276520 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:57:17.277837 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:57:17.281863 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:57:17.283874 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:57:17.283874 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:57:17.382672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA491DB260>]}
[0m16:57:17.383672 [info ] [Thread-2 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m16:57:17.386118 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:57:17.778203 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:57:17.794189 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:57:17.269691 => 16:57:17.794189
[0m16:57:17.794189 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_7: Close
[0m16:57:17.810091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:57:17.810091 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:57:17.250013 => 16:57:17.810091
[0m16:57:17.810091 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:57:17.885238 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA4910B7D0>]}
[0m16:57:17.886247 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:57:17.887248 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:57:17.902495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64697f62-db2f-4b8b-a8a8-0966889f8bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA47DC8200>]}
[0m16:57:17.903502 [info ] [Thread-3 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:57:17.904494 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:57:17.907460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:17.908458 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:57:17.908458 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:57:17.909457 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:57:17.910461 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:57:17.910461 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m16:57:17.911460 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:57:17.911460 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:57:17.912460 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:57:17.912460 [info ] [MainThread]: 
[0m16:57:17.913460 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m16:57:17.917265 [debug] [MainThread]: Command end result
[0m16:57:17.934881 [info ] [MainThread]: 
[0m16:57:17.936348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:17.936348 [info ] [MainThread]: 
[0m16:57:17.938361 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:57:17.938361 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:17.938361 after 4.78 seconds
[0m16:57:17.938361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA43AD7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA43446CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA431ACD70>]}
[0m16:57:17.941201 [debug] [MainThread]: Flushing usage events
[0m16:59:14.262592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CCC65700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CCC659A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CCC65250>]}


============================== 16:59:14.262592 | 09df61d7-a464-4e01-81f0-fd14cf85ee85 ==============================
[0m16:59:14.262592 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:59:14.262592 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:59:14.797209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD03A4B0>]}
[0m16:59:14.924058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD068FB0>]}
[0m16:59:14.926067 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:59:14.928075 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:59:15.082480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:15.082480 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m16:59:15.267262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD761AF0>]}
[0m16:59:15.282539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD56B9B0>]}
[0m16:59:15.282539 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:59:15.282539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD6DBCE0>]}
[0m16:59:15.282539 [info ] [MainThread]: 
[0m16:59:15.282539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:15.282539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:59:15.306834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m16:59:15.313437 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:59:15.316433 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m16:59:15.317434 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:59:15.317434 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m16:59:15.317434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:15.317434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:16.224155 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:59:16.240199 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:59:16.240199 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:59:16.240199 [debug] [ThreadPool]: On list_NEWDB: Close
[0m16:59:16.368042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m16:59:16.383182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m16:59:16.398882 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m16:59:16.414859 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m16:59:16.414859 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m16:59:16.414859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:16.414859 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m16:59:16.414859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:16.774765 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:59:16.774765 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m16:59:16.896478 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:59:16.896478 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m16:59:16.999650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD87FCE0>]}
[0m16:59:16.999650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:59:16.999650 [info ] [MainThread]: 
[0m16:59:17.020497 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m16:59:17.022495 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m16:59:17.024325 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m16:59:17.026325 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m16:59:17.023201 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m16:59:17.027324 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m16:59:17.030091 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m16:59:17.034732 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m16:59:17.030091 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m16:59:17.035948 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m16:59:17.036956 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m16:59:17.036956 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m16:59:17.038990 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m16:59:17.046478 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m16:59:17.039990 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m16:59:17.039990 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m16:59:17.050497 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m16:59:17.050497 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m16:59:17.060354 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m16:59:17.063323 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m16:59:17.063323 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 16:59:17.046478 => 16:59:17.063323
[0m16:59:17.070810 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 16:59:17.039990 => 16:59:17.070810
[0m16:59:17.070810 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m16:59:17.072945 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m16:59:17.073955 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 16:59:17.050497 => 16:59:17.072945
[0m16:59:17.079894 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 16:59:17.061319 => 16:59:17.079894
[0m16:59:17.160860 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m16:59:17.179820 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m16:59:17.179820 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m16:59:17.179820 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m16:59:17.192280 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m16:59:17.196870 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m16:59:17.196870 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m16:59:17.201457 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m16:59:17.201457 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m16:59:17.201457 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m16:59:17.201457 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m16:59:17.201457 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m16:59:17.201457 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:59:17.201457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:17.201457 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m16:59:17.201457 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m16:59:17.201457 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:59:17.211543 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:59:17.691131 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:59:17.713098 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 16:59:17.194289 => 16:59:17.713098
[0m16:59:17.728824 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m16:59:17.728824 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:17.728824 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 16:59:17.073955 => 16:59:17.728824
[0m16:59:17.728824 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m16:59:17.728824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:17.743881 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 16:59:17.079894 => 16:59:17.743881
[0m16:59:17.744889 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m16:59:17.798115 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:17.798115 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 16:59:17.179820 => 16:59:17.798115
[0m16:59:17.798115 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m16:59:17.890287 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD6C8C80>]}
[0m16:59:17.890287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD6C89B0>]}
[0m16:59:17.890287 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.86s]
[0m16:59:17.898256 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m16:59:17.898256 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.85s]
[0m16:59:17.898256 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m16:59:17.898256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD9C60F0>]}
[0m16:59:17.898256 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.87s]
[0m16:59:17.898256 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m16:59:17.955510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD9C5B50>]}
[0m16:59:17.957517 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.92s]
[0m16:59:17.957517 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m16:59:17.957517 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_1
[0m16:59:17.957517 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m16:59:17.957517 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m16:59:17.962315 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m16:59:17.957517 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m16:59:17.962315 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m16:59:17.964201 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_1)
[0m16:59:17.964201 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m16:59:17.964201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m16:59:17.964201 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_1
[0m16:59:17.964201 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m16:59:17.970821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m16:59:17.970821 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m16:59:17.974855 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m16:59:17.974855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m16:59:17.974855 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m16:59:17.982004 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m16:59:17.983040 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m16:59:17.986759 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m16:59:17.986759 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m16:59:17.993421 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 16:59:17.971859 => 16:59:17.993421
[0m16:59:17.994434 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_1
[0m16:59:17.995432 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 16:59:17.974855 => 16:59:17.995432
[0m16:59:18.002188 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m16:59:18.001188 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m16:59:18.003192 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 16:59:17.986759 => 16:59:18.002188
[0m16:59:18.004190 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 16:59:17.984046 => 16:59:18.004190
[0m16:59:18.004190 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m16:59:18.004190 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m16:59:18.004190 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m16:59:18.015764 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m16:59:18.023297 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m16:59:18.023297 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m16:59:18.023297 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m16:59:18.023297 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m16:59:18.023297 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -72) as three_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        h.payment_month >= three_months_ago
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent,
        payment_month,
        three_months_ago
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m16:59:18.030007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:59:18.032017 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m16:59:18.032017 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:59:18.034049 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m16:59:18.035049 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m16:59:18.037053 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m16:59:18.039743 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:59:18.040743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:18.600833 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:18.600833 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 16:59:17.996435 => 16:59:18.600833
[0m16:59:18.600833 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_1: Close
[0m16:59:18.600833 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:18.600833 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 16:59:18.013353 => 16:59:18.600833
[0m16:59:18.600833 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m16:59:18.600833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:18.618609 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 16:59:18.015764 => 16:59:18.618609
[0m16:59:18.618609 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m16:59:18.632658 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:18.648340 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 16:59:18.004190 => 16:59:18.648340
[0m16:59:18.648340 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m16:59:18.719179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD79B170>]}
[0m16:59:18.720195 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m16:59:18.723138 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_1
[0m16:59:18.724135 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_6
[0m16:59:18.724135 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m16:59:18.726135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m16:59:18.727169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD569910>]}
[0m16:59:18.727169 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_6
[0m16:59:18.728169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD9B4D70>]}
[0m16:59:18.733435 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m16:59:18.729138 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.76s]
[0m16:59:18.736396 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m16:59:18.735395 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m16:59:18.737397 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_7
[0m16:59:18.739407 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m16:59:18.741396 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 16:59:18.730170 => 16:59:18.740398
[0m16:59:18.740398 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m16:59:18.742395 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_6
[0m16:59:18.743395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m16:59:18.748397 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m16:59:18.749432 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_7
[0m16:59:18.754405 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m16:59:18.758395 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m16:59:18.758395 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m16:59:18.759395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:59:18.760395 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 16:59:18.750397 => 16:59:18.760395
[0m16:59:18.761396 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD79A180>]}
[0m16:59:18.762396 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_7
[0m16:59:18.771825 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m16:59:18.766396 [info ] [Thread-4 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.80s]
[0m16:59:18.771825 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m16:59:18.771825 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m16:59:18.771825 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m16:59:18.771825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:19.314677 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:19.314677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:19.314677 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 16:59:18.743395 => 16:59:19.314677
[0m16:59:19.330480 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 16:59:18.766396 => 16:59:19.330480
[0m16:59:19.330480 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_6: Close
[0m16:59:19.330480 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_7: Close
[0m16:59:19.427266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CDA7ED50>]}
[0m16:59:19.427266 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.68s]
[0m16:59:19.427266 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_7
[0m16:59:19.427266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09df61d7-a464-4e01-81f0-fd14cf85ee85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129C7C4ADE0>]}
[0m16:59:19.427266 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:59:19.427266 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_6
[0m16:59:19.444673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:19.445670 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:59:19.446350 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m16:59:19.447240 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m16:59:19.448147 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m16:59:19.448521 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m16:59:19.449322 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m16:59:19.449322 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_5' was properly closed.
[0m16:59:19.449322 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m16:59:19.449322 [info ] [MainThread]: 
[0m16:59:19.452401 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m16:59:19.455444 [debug] [MainThread]: Command end result
[0m16:59:19.469254 [info ] [MainThread]: 
[0m16:59:19.469254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:19.474268 [info ] [MainThread]: 
[0m16:59:19.475278 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:59:19.477277 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:19.477277 after 5.29 seconds
[0m16:59:19.477277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CC973770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD068FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000129CD2A6F60>]}
[0m16:59:19.478277 [debug] [MainThread]: Flushing usage events
[0m17:11:39.215465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FA75DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FA75DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FA75D880>]}


============================== 17:11:39.242565 | 5c9d2cf0-d018-48b3-aff9-b8dd2ce75134 ==============================
[0m17:11:39.242565 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:11:39.243533 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:11:42.708466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FAAE2B40>]}
[0m17:11:42.819650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FA6310D0>]}
[0m17:11:42.843259 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:11:42.868256 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:11:44.423044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:44.424095 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m17:11:44.606228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB2E7980>]}
[0m17:11:44.634664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB054920>]}
[0m17:11:44.634664 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:11:44.634664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FAF21F70>]}
[0m17:11:44.634664 [info ] [MainThread]: 
[0m17:11:44.634664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:44.634664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:11:44.656646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:11:44.668595 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:11:44.670557 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:11:44.670557 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:11:44.673342 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:11:44.673797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:44.673797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:45.783142 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:11:45.783142 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:11:45.815354 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:11:45.815354 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:11:45.927307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:11:45.933343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:11:45.943076 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:11:45.959159 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:11:45.959159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:45.943076 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:11:45.959159 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:11:45.959159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:46.268125 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:11:46.272284 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:11:46.289905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:11:46.292435 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:11:46.389261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FAE83D70>]}
[0m17:11:46.389261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:46.389261 [info ] [MainThread]: 
[0m17:11:46.395484 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:11:46.398428 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:11:46.398428 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:11:46.398428 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:11:46.400438 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:11:46.400438 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:11:46.400438 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:11:46.404036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:11:46.406037 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:11:46.404036 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:11:46.408087 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:11:46.409129 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:11:46.409129 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:11:46.411319 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:11:46.413429 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:11:46.431744 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:11:46.425715 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:11:46.431744 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:11:46.431744 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:11:46.442525 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:11:46.444533 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:11:46.425715 => 17:11:46.444533
[0m17:11:46.446544 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:11:46.475099 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:11:46.415447 => 17:11:46.474270
[0m17:11:46.491108 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:11:46.555796 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:11:46.556797 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:11:46.431744 => 17:11:46.555796
[0m17:11:46.556797 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:11:46.431744 => 17:11:46.556797
[0m17:11:46.561879 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:11:46.562875 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:11:46.563874 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:11:46.567877 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:11:46.572877 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:11:46.574874 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:11:46.574874 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:11:46.574874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:46.577650 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:11:46.577650 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:11:46.577650 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:11:46.577650 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:11:46.582779 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:46.582779 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:11:46.582779 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:11:46.585444 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:46.585444 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:47.010103 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:11:47.057671 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:11:46.446544 => 17:11:47.057671
[0m17:11:47.057671 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:11:47.057671 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:11:47.065278 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:11:46.563874 => 17:11:47.065278
[0m17:11:47.065278 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:11:47.067285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:11:47.067285 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:11:46.491108 => 17:11:47.067285
[0m17:11:47.067285 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:11:47.157007 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:11:47.177601 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:11:46.568873 => 17:11:47.175383
[0m17:11:47.181554 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:11:47.188555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB2A31A0>]}
[0m17:11:47.192552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB501C70>]}
[0m17:11:47.194715 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.78s]
[0m17:11:47.196735 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:11:47.196735 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.78s]
[0m17:11:47.202154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB2A3C20>]}
[0m17:11:47.202154 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:11:47.202154 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.80s]
[0m17:11:47.208352 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:11:47.293585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB50F290>]}
[0m17:11:47.309325 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.89s]
[0m17:11:47.310333 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:11:47.310333 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_1
[0m17:11:47.310333 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_2a
[0m17:11:47.310333 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2b
[0m17:11:47.310333 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m17:11:47.310333 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m17:11:47.310333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_1)
[0m17:11:47.310333 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m17:11:47.310333 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_1
[0m17:11:47.319279 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_2a)
[0m17:11:47.310333 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m17:11:47.324038 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m17:11:47.310333 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m17:11:47.325038 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m17:11:47.326197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2b)
[0m17:11:47.326197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m17:11:47.333586 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m17:11:47.334629 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m17:11:47.334629 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m17:11:47.335661 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 17:11:47.319279 => 17:11:47.335661
[0m17:11:47.338703 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m17:11:47.343436 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m17:11:47.343436 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_1
[0m17:11:47.343436 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 17:11:47.326197 => 17:11:47.343436
[0m17:11:47.351646 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m17:11:47.351646 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_2a
[0m17:11:47.351646 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 17:11:47.338703 => 17:11:47.351646
[0m17:11:47.360212 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m17:11:47.362236 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m17:11:47.362236 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 17:11:47.336674 => 17:11:47.362236
[0m17:11:47.364244 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m17:11:47.364244 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m17:11:47.364244 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2b
[0m17:11:47.364244 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:11:47.376808 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m17:11:47.376808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:47.376808 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m17:11:47.376808 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT(h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        avg(h.revenue) as avg_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -72) as three_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    WHERE
        h.payment_month >= three_months_ago
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent,
        payment_month,
        three_months_ago
    FROM cross_sell_analysis
    where total_spent > avg_spent
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m17:11:47.376808 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m17:11:47.376808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:11:47.376808 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:11:47.387633 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m17:11:47.387633 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:47.387633 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:11:47.391904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:47.872307 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:11:47.872307 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 17:11:47.364244 => 17:11:47.872307
[0m17:11:47.872307 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m17:11:47.888237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:11:47.888237 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 17:11:47.343436 => 17:11:47.888237
[0m17:11:47.888237 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_1: Close
[0m17:11:47.888237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:11:47.888237 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 17:11:47.364244 => 17:11:47.888237
[0m17:11:47.888237 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2b: Close
[0m17:11:47.952525 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:11:47.952525 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 17:11:47.351646 => 17:11:47.952525
[0m17:11:47.952525 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_2a: Close
[0m17:11:47.984420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB5332C0>]}
[0m17:11:47.984420 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.66s]
[0m17:11:47.984420 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m17:11:47.984420 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_6
[0m17:11:47.984420 [info ] [Thread-3 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m17:11:47.984420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_6)
[0m17:11:47.984420 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_6
[0m17:11:47.984420 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m17:11:47.984420 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 17:11:47.984420 => 17:11:47.984420
[0m17:11:47.984420 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_6
[0m17:11:48.000424 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m17:11:48.004702 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m17:11:48.005160 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:11:48.006242 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:11:48.013570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB4E6510>]}
[0m17:11:48.014569 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.69s]
[0m17:11:48.016570 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2b
[0m17:11:48.016570 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_7
[0m17:11:48.017569 [info ] [Thread-2 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m17:11:48.019097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_2b, now model.data_engineering_project.rpt_7)
[0m17:11:48.019097 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_7
[0m17:11:48.019097 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m17:11:48.019097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB502870>]}
[0m17:11:48.026736 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m17:11:48.028200 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_1
[0m17:11:48.030244 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 17:11:48.019097 => 17:11:48.030244
[0m17:11:48.032268 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_7
[0m17:11:48.036220 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m17:11:48.038223 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m17:11:48.038223 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:11:48.038223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:48.096449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB122CC0>]}
[0m17:11:48.097494 [info ] [Thread-4 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.79s]
[0m17:11:48.098459 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_2a
[0m17:11:48.549410 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:11:48.549410 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:11:48.549410 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 17:11:47.984420 => 17:11:48.549410
[0m17:11:48.549410 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 17:11:48.032268 => 17:11:48.549410
[0m17:11:48.565337 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_6: Close
[0m17:11:48.565337 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_7: Close
[0m17:11:48.667739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB533440>]}
[0m17:11:48.667739 [info ] [Thread-3 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m17:11:48.667739 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_6
[0m17:11:48.667739 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c9d2cf0-d018-48b3-aff9-b8dd2ce75134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB1C9400>]}
[0m17:11:48.667739 [info ] [Thread-2 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.65s]
[0m17:11:48.678648 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_7
[0m17:11:48.680650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:48.681650 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:11:48.681650 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:11:48.682649 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:11:48.682649 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:11:48.683650 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_1' was properly closed.
[0m17:11:48.683650 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m17:11:48.683650 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m17:11:48.684649 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m17:11:48.685653 [info ] [MainThread]: 
[0m17:11:48.686650 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m17:11:48.689683 [debug] [MainThread]: Command end result
[0m17:11:48.705657 [info ] [MainThread]: 
[0m17:11:48.706658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:48.707657 [info ] [MainThread]: 
[0m17:11:48.708657 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:11:48.710659 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:48.710659 after 9.60 seconds
[0m17:11:48.711658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FB2B8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FA939AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FACDCA70>]}
[0m17:11:48.711658 [debug] [MainThread]: Flushing usage events
[0m17:14:01.426595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001648795DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001648795E9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001648795D970>]}


============================== 17:14:01.432562 | 44546b1f-a051-4fe2-91a8-4819746528f0 ==============================
[0m17:14:01.432562 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:14:01.432562 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:14:02.073568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001648802FE00>]}
[0m17:14:02.200077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016487D699D0>]}
[0m17:14:02.201072 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:14:02.212907 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:14:02.398086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:14:02.399084 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\rpt_2a.sql
[0m17:14:02.654405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016488210530>]}
[0m17:14:02.677534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164882B8230>]}
[0m17:14:02.679588 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:14:02.683617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016488082CF0>]}
[0m17:14:02.687641 [info ] [MainThread]: 
[0m17:14:02.689653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:02.695126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:14:02.724759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:14:02.734191 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:14:02.742189 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:14:02.742189 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:14:02.743192 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:14:02.745270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:02.746784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:03.683460 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:14:03.683460 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:14:03.697097 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:14:03.699092 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:14:03.799676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:14:03.805718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:14:03.821190 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:14:03.824190 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:14:03.825189 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:14:03.826190 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:14:03.826190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:03.827190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:04.105952 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:14:04.105952 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:14:04.137732 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:14:04.137732 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:14:04.229930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016487FA3320>]}
[0m17:14:04.231936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:04.232941 [info ] [MainThread]: 
[0m17:14:04.238965 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:14:04.238965 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:14:04.240972 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:14:04.240972 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:14:04.242980 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:14:04.242980 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:14:04.246256 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:14:04.242980 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:14:04.249255 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:14:04.249761 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:14:04.246256 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:14:04.251770 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:14:04.251770 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:14:04.262805 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:14:04.263263 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:14:04.263263 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:14:04.269293 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:14:04.271196 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:14:04.275634 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:14:04.279637 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:14:04.279637 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:14:04.252805 => 17:14:04.279637
[0m17:14:04.279637 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:14:04.313179 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:14:04.265273 => 17:14:04.312383
[0m17:14:04.330040 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:14:04.331121 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:14:04.332120 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:14:04.275634 => 17:14:04.331121
[0m17:14:04.332120 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:14:04.271196 => 17:14:04.332120
[0m17:14:04.401419 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:14:04.401419 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:14:04.402419 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:14:04.406419 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:14:04.411420 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:14:04.412419 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:14:04.413421 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:14:04.414420 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:14:04.415419 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:14:04.416421 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:14:04.416421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:04.417419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:14:04.419419 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:14:04.419419 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:14:04.420419 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:14:04.422419 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:14:04.425419 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:14:04.900459 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:14:04.929329 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:14:04.333121 => 17:14:04.929329
[0m17:14:04.930328 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:14:04.930328 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:14:04.930328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:14:04.930328 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:14:04.403419 => 17:14:04.930328
[0m17:14:04.930328 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:14:04.284262 => 17:14:04.930328
[0m17:14:04.930328 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:14:04.930328 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:14:04.993101 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:14:04.993101 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:14:04.407420 => 17:14:04.993101
[0m17:14:04.993101 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:14:05.024661 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164886A3980>]}
[0m17:14:05.024661 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.76s]
[0m17:14:05.024661 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:14:05.040339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016488304260>]}
[0m17:14:05.040339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164886EB4A0>]}
[0m17:14:05.040339 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.79s]
[0m17:14:05.049478 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:14:05.040339 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.80s]
[0m17:14:05.051660 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:14:05.099522 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164886E00B0>]}
[0m17:14:05.100522 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m17:14:05.101487 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:14:05.102486 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_1
[0m17:14:05.103486 [debug] [Thread-2 (]: Began running node model.data_engineering_project.rpt_2a
[0m17:14:05.104486 [debug] [Thread-1 (]: Began running node model.data_engineering_project.rpt_2b
[0m17:14:05.103486 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.rpt_1 .......................... [RUN]
[0m17:14:05.105486 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_5
[0m17:14:05.105486 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.rpt_2a ......................... [RUN]
[0m17:14:05.107487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.rpt_1)
[0m17:14:05.106486 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.rpt_2b ......................... [RUN]
[0m17:14:05.109489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.rpt_2a)
[0m17:14:05.110489 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_1
[0m17:14:05.108489 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.rpt_5 .......................... [RUN]
[0m17:14:05.111489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.rpt_2b)
[0m17:14:05.112522 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.rpt_2a
[0m17:14:05.118153 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_1"
[0m17:14:05.120165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.rpt_5)
[0m17:14:05.120165 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.rpt_2b
[0m17:14:05.126407 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2a"
[0m17:14:05.127406 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_5
[0m17:14:05.130327 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.rpt_2b"
[0m17:14:05.137467 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (compile): 17:14:05.113490 => 17:14:05.137467
[0m17:14:05.137467 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_5"
[0m17:14:05.137467 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_1
[0m17:14:05.143528 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_1"
[0m17:14:05.144533 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (compile): 17:14:05.120165 => 17:14:05.144533
[0m17:14:05.145496 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (compile): 17:14:05.127406 => 17:14:05.145496
[0m17:14:05.147142 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.rpt_2a
[0m17:14:05.147142 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.rpt_2b
[0m17:14:05.154595 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2a"
[0m17:14:05.156604 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.rpt_2b"
[0m17:14:05.156604 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (compile): 17:14:05.130327 => 17:14:05.156604
[0m17:14:05.162242 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_1"
[0m17:14:05.164303 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_5
[0m17:14:05.164303 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_1"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_1
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:14:05.164303 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_5"
[0m17:14:05.164303 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:05.164303 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.rpt_2a"
[0m17:14:05.174216 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2a"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2a
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought,
        SUM(h.revenue) AS total_spent,
        avg(h.revenue) as avg_spent,
        h.payment_month,
        ADD_MONTHS(current_date, -72) as three_months_ago
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
),
highest_cross_sell AS (
    SELECT
        RANK() OVER (ORDER BY num_products_bought DESC, total_spent DESC) AS cross_sell_rank,
        customer_id,
        customer_name,
        num_products_bought,
        total_spent,
        payment_month,
        three_months_ago
    FROM cross_sell_analysis
    where total_spent > avg_spent
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m17:14:05.174216 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.rpt_2b"
[0m17:14:05.177402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:14:05.180825 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_5"
[0m17:14:05.180825 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_2b"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_2b
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:14:05.180825 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_5"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_5
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:14:05.180825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:05.180825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:05.630954 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:14:05.630954 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_1 (execute): 17:14:05.137467 => 17:14:05.630954
[0m17:14:05.630954 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_1: Close
[0m17:14:05.650837 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:14:05.650837 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_5 (execute): 17:14:05.164303 => 17:14:05.650837
[0m17:14:05.650837 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_5: Close
[0m17:14:05.661098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:14:05.671317 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.rpt_2b (execute): 17:14:05.156604 => 17:14:05.671317
[0m17:14:05.671317 [debug] [Thread-1 (]: On model.data_engineering_project.rpt_2b: Close
[0m17:14:05.673324 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:14:05.676959 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.rpt_2a (execute): 17:14:05.147142 => 17:14:05.676959
[0m17:14:05.676959 [debug] [Thread-2 (]: On model.data_engineering_project.rpt_2a: Close
[0m17:14:05.724199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164882BB920>]}
[0m17:14:05.724199 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.rpt_1 ..................... [[32mSUCCESS 1[0m in 0.62s]
[0m17:14:05.724199 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_1
[0m17:14:05.724199 [debug] [Thread-4 (]: Began running node model.data_engineering_project.rpt_6
[0m17:14:05.724199 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.rpt_6 .......................... [RUN]
[0m17:14:05.724199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_1, now model.data_engineering_project.rpt_6)
[0m17:14:05.724199 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.rpt_6
[0m17:14:05.724199 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.rpt_6"
[0m17:14:05.724199 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (compile): 17:14:05.724199 => 17:14:05.724199
[0m17:14:05.724199 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.rpt_6
[0m17:14:05.742820 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.rpt_6"
[0m17:14:05.745478 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.rpt_6"
[0m17:14:05.746512 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_6"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_6
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:14:05.746512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:14:05.754055 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164886B2C60>]}
[0m17:14:05.755051 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.rpt_5 ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m17:14:05.756018 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_5
[0m17:14:05.757018 [debug] [Thread-3 (]: Began running node model.data_engineering_project.rpt_7
[0m17:14:05.757018 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.rpt_7 ......................... [RUN]
[0m17:14:05.758021 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.rpt_5, now model.data_engineering_project.rpt_7)
[0m17:14:05.758021 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.rpt_7
[0m17:14:05.762067 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.rpt_7"
[0m17:14:05.764634 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (compile): 17:14:05.758021 => 17:14:05.764634
[0m17:14:05.764634 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.rpt_7
[0m17:14:05.768672 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.rpt_7"
[0m17:14:05.774571 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.rpt_7"
[0m17:14:05.775569 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016488766ED0>]}
[0m17:14:05.775569 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.rpt_7"} */
create or replace   view NEWDB.DESCHEMA_reporting.rpt_7
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:14:05.778570 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:05.777572 [info ] [Thread-2 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.rpt_2a .................... [[32mSUCCESS 1[0m in 0.67s]
[0m17:14:05.778570 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.rpt_2a
[0m17:14:05.781385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164884B3260>]}
[0m17:14:05.781385 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.rpt_2b .................... [[32mSUCCESS 1[0m in 0.67s]
[0m17:14:05.781385 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.rpt_2b
[0m17:14:06.254492 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:14:06.259548 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.rpt_6 (execute): 17:14:05.724199 => 17:14:06.259548
[0m17:14:06.259548 [debug] [Thread-4 (]: On model.data_engineering_project.rpt_6: Close
[0m17:14:06.275547 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:14:06.275547 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.rpt_7 (execute): 17:14:05.766659 => 17:14:06.275547
[0m17:14:06.275547 [debug] [Thread-3 (]: On model.data_engineering_project.rpt_7: Close
[0m17:14:06.359477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164884A6540>]}
[0m17:14:06.359477 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.rpt_6 ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m17:14:06.359477 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.rpt_6
[0m17:14:06.381110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44546b1f-a051-4fe2-91a8-4819746528f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016488766EA0>]}
[0m17:14:06.382121 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.rpt_7 .................... [[32mSUCCESS 1[0m in 0.62s]
[0m17:14:06.383089 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.rpt_7
[0m17:14:06.383089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2b' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_2a' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_7' was properly closed.
[0m17:14:06.383089 [debug] [MainThread]: Connection 'model.data_engineering_project.rpt_6' was properly closed.
[0m17:14:06.383089 [info ] [MainThread]: 
[0m17:14:06.383089 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m17:14:06.395987 [debug] [MainThread]: Command end result
[0m17:14:06.413908 [info ] [MainThread]: 
[0m17:14:06.417577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:06.418520 [info ] [MainThread]: 
[0m17:14:06.418520 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:14:06.422606 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:06.422606 after 5.26 seconds
[0m17:14:06.424615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016487CC8EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164826C2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016485E1AB40>]}
[0m17:14:06.424615 [debug] [MainThread]: Flushing usage events
[0m17:39:58.714382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6079950D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6079947A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E607995400>]}


============================== 17:39:58.746027 | d6b4f8f5-8922-4515-b707-4aa6077e05d7 ==============================
[0m17:39:58.746027 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:39:58.746027 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:40:02.419318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E607F7F230>]}
[0m17:40:02.547832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6079BDE50>]}
[0m17:40:02.547832 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:40:02.586832 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:40:04.132626 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 0 files changed.
[0m17:40:04.132626 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\product_rank.sql
[0m17:40:04.132626 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\new_logos.sql
[0m17:40:04.132626 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:40:04.148354 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\product_churn.sql
[0m17:40:04.148989 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\customer_churn.sql
[0m17:40:04.150033 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\customer_rank.sql
[0m17:40:04.150033 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_2b.sql
[0m17:40:04.151031 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_7.sql
[0m17:40:04.151031 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_6.sql
[0m17:40:04.151031 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_2a.sql
[0m17:40:04.152031 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_5.sql
[0m17:40:04.152031 [debug] [MainThread]: Partial parsing: deleted file: data_engineering_project://models\reporting\rpt_1.sql
[0m17:40:04.362972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E608498C20>]}
[0m17:40:04.394822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6082601D0>]}
[0m17:40:04.394822 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:40:04.394822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6079BE810>]}
[0m17:40:04.394822 [info ] [MainThread]: 
[0m17:40:04.394822 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:40:04.407416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:40:04.414432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:40:04.425776 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:40:04.425776 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:40:04.425776 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:40:04.432225 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:40:04.433234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:04.433234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:05.686547 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:40:05.686547 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:40:05.719910 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:40:05.719910 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:40:05.815439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:40:05.826443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:40:05.835414 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:40:05.835414 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:40:05.835414 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:40:05.835414 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:40:05.840942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:05.840942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:06.190803 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:40:06.190803 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:40:06.190803 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:40:06.202871 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:40:06.317132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E608411DC0>]}
[0m17:40:06.317132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:06.317132 [info ] [MainThread]: 
[0m17:40:06.333525 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:40:06.333525 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:40:06.333525 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:40:06.333525 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:40:06.333525 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:40:06.333525 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:40:06.347874 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:40:06.333525 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:40:06.348870 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:40:06.349873 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:40:06.351587 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:40:06.346861 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:40:06.352660 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:40:06.363495 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:40:06.364539 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:40:06.365540 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:40:06.371577 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:40:06.371577 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:40:06.371577 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:40:06.379787 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:40:06.379787 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:40:06.352660 => 17:40:06.379787
[0m17:40:06.379787 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:40:06.384909 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:40:06.366538 => 17:40:06.384141
[0m17:40:06.469154 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:40:06.484699 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:40:06.484699 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:40:06.484699 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:40:06.371577 => 17:40:06.484699
[0m17:40:06.484699 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:40:06.503056 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:40:06.503056 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:40:06.371577 => 17:40:06.503056
[0m17:40:06.503056 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:40:06.503056 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:40:06.503056 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:40:06.503056 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:40:06.503056 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:40:06.512764 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:40:06.512764 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:40:06.512764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:06.512764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:06.515796 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:40:06.515796 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:40:06.515796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:06.515796 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:40:06.515796 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:07.001633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:40:07.031018 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:40:06.384909 => 17:40:07.031018
[0m17:40:07.031018 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:40:07.036452 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:40:07.046900 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:40:06.503056 => 17:40:07.046900
[0m17:40:07.046900 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:40:07.143579 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:40:07.143579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B20F0>]}
[0m17:40:07.143579 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:40:06.484154 => 17:40:07.143579
[0m17:40:07.159267 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B0DA0>]}
[0m17:40:07.159267 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:40:07.159267 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.80s]
[0m17:40:07.159267 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.79s]
[0m17:40:07.159267 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:40:07.159267 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:40:07.264036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B0A70>]}
[0m17:40:07.265021 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.92s]
[0m17:40:07.267036 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:40:07.305518 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:40:07.305518 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:40:06.484699 => 17:40:07.305518
[0m17:40:07.305518 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:40:07.416495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B90A0>]}
[0m17:40:07.416495 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 1.07s]
[0m17:40:07.416495 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:40:07.422260 [debug] [Thread-1 (]: Began running node model.data_engineering_project.cross_sell
[0m17:40:07.422260 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_churn
[0m17:40:07.422260 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_rank
[0m17:40:07.422260 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:40:07.424798 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m17:40:07.424798 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:40:07.426872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.cross_sell)
[0m17:40:07.426872 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:40:07.429973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.customer_churn)
[0m17:40:07.428817 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:40:07.430984 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:40:07.431981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_rank)
[0m17:40:07.432982 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:40:07.433981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m17:40:07.439282 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:40:07.439282 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:40:07.439282 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:40:07.439282 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:40:07.451560 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:40:07.456702 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:40:07.460721 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:40:07.452529 => 17:40:07.458712
[0m17:40:07.460721 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m17:40:07.460721 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:40:07.439282 => 17:40:07.460721
[0m17:40:07.466751 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:40:07.466751 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:40:07.477467 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:40:07.479478 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:40:07.439282 => 17:40:07.479478
[0m17:40:07.479478 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:40:07.481486 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:40:07.484505 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:40:07.490141 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:40:07.490141 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:40:07.434426 => 17:40:07.490141
[0m17:40:07.490141 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:40:07.490141 [debug] [Thread-4 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:40:07.490141 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:40:07.490141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:07.490141 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:07.498452 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:40:07.502959 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:40:07.504957 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:40:07.504957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:07.512958 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:40:07.512958 [debug] [Thread-1 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name,
        h.payment_month
    ORDER BY
        num_products_bought DESC
),
highest_cross_sell AS (
    SELECT * , 
        RANK() OVER (PARTITION BY customer_id ORDER BY num_products_bought DESC) AS cross_sell_rank
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m17:40:07.513955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:07.940559 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:40:07.951797 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:40:07.462730 => 17:40:07.951797
[0m17:40:07.951797 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m17:40:07.951797 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:40:07.967464 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:40:07.471438 => 17:40:07.967464
[0m17:40:07.970719 [debug] [Thread-4 (]: On model.data_engineering_project.customer_churn: Close
[0m17:40:08.010611 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:40:08.014610 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:40:07.485306 => 17:40:08.014610
[0m17:40:08.015614 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: Close
[0m17:40:08.050197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B1C40>]}
[0m17:40:08.050197 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.60s]
[0m17:40:08.050197 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m17:40:08.050197 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_churn
[0m17:40:08.050197 [info ] [Thread-3 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:40:08.050197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.product_churn)
[0m17:40:08.050197 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:40:08.050197 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:40:08.050197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:40:08.050197 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:40:07.490141 => 17:40:08.050197
[0m17:40:08.065927 [debug] [Thread-1 (]: On model.data_engineering_project.cross_sell: Close
[0m17:40:08.065927 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:40:08.050197 => 17:40:08.065927
[0m17:40:08.069440 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_churn
[0m17:40:08.076205 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B0BF0>]}
[0m17:40:08.075102 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:40:08.076205 [info ] [Thread-4 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.65s]
[0m17:40:08.080440 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:40:08.081452 [debug] [Thread-4 (]: Began running node model.data_engineering_project.product_rank
[0m17:40:08.082484 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:40:08.083448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_rank)
[0m17:40:08.084484 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:40:08.089906 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:40:08.092870 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:40:08.093871 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:40:08.093871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:08.100528 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:40:08.084484 => 17:40:08.099528
[0m17:40:08.100528 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.product_rank
[0m17:40:08.107047 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:40:08.110050 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:40:08.111050 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:40:08.111050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:40:08.137885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60846D130>]}
[0m17:40:08.137885 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.71s]
[0m17:40:08.137885 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:40:08.206995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6086B8E60>]}
[0m17:40:08.207995 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.78s]
[0m17:40:08.208959 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:40:08.531651 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:40:08.538576 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:40:08.070485 => 17:40:08.538576
[0m17:40:08.539574 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: Close
[0m17:40:08.603266 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:40:08.603266 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:40:08.101562 => 17:40:08.603266
[0m17:40:08.616004 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: Close
[0m17:40:08.663762 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60875C260>]}
[0m17:40:08.663762 [info ] [Thread-3 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.61s]
[0m17:40:08.663762 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_churn
[0m17:40:08.719470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b4f8f5-8922-4515-b707-4aa6077e05d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6083B36E0>]}
[0m17:40:08.720155 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.64s]
[0m17:40:08.721240 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.product_rank
[0m17:40:08.724239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:08.724239 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:40:08.725274 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:40:08.725274 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:40:08.726240 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:40:08.726240 [debug] [MainThread]: Connection 'model.data_engineering_project.cross_sell' was properly closed.
[0m17:40:08.726240 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m17:40:08.727274 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:40:08.727274 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:40:08.728239 [info ] [MainThread]: 
[0m17:40:08.729238 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m17:40:08.732239 [debug] [MainThread]: Command end result
[0m17:40:08.747356 [info ] [MainThread]: 
[0m17:40:08.748360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:08.749386 [info ] [MainThread]: 
[0m17:40:08.750362 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:40:08.750362 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:08.750362 after 10.15 seconds
[0m17:40:08.753094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E607B39D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E607FA7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E607832F00>]}
[0m17:40:08.753094 [debug] [MainThread]: Flushing usage events
[0m17:42:18.168994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714495D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714496C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714495880>]}


============================== 17:42:18.179222 | 18a767cf-ff23-4a54-8851-de19ae3a8bbc ==============================
[0m17:42:18.179222 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:42:18.179222 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:42:18.736629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714143770>]}
[0m17:42:18.862849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371486B530>]}
[0m17:42:18.862849 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:42:18.884122 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:42:19.038869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:19.040875 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:42:19.230625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714FE7710>]}
[0m17:42:19.237121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714D6BD40>]}
[0m17:42:19.237121 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:42:19.251943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714F38830>]}
[0m17:42:19.251943 [info ] [MainThread]: 
[0m17:42:19.255677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:19.255677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:42:19.271579 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:42:19.271579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:42:19.271579 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:42:19.282736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:19.289000 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:42:19.290986 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:42:19.290986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:20.256047 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:42:20.256047 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:42:20.269062 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:42:20.271071 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:42:20.354196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:42:20.370562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:42:20.402026 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:42:20.402026 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:42:20.402026 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:42:20.402026 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:42:20.402026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:20.402026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:20.759380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:42:20.761386 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:42:20.907113 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m17:42:20.909114 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:42:21.015661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237144BE4E0>]}
[0m17:42:21.015661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:42:21.015661 [info ] [MainThread]: 
[0m17:42:21.024924 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:42:21.024924 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:42:21.024924 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:42:21.031540 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:42:21.024924 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:42:21.024924 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:42:21.034952 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:42:21.036402 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:42:21.032549 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:42:21.037407 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:42:21.038405 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:42:21.033547 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:42:21.039707 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:42:21.052132 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:42:21.052132 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:42:21.052132 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:42:21.052132 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:42:21.052132 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:42:21.064883 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:42:21.069065 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:42:21.069065 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:42:21.040218 => 17:42:21.069065
[0m17:42:21.069065 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:42:21.052132 => 17:42:21.069065
[0m17:42:21.069065 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:42:21.069065 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:42:21.084921 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:42:21.052132 => 17:42:21.084063
[0m17:42:21.116723 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:42:21.166409 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:42:21.166409 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:42:21.064883 => 17:42:21.166409
[0m17:42:21.166409 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:42:21.166409 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:42:21.166409 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:42:21.184076 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:42:21.184076 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:42:21.184076 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:42:21.184076 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:42:21.190078 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:42:21.190078 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:42:21.190078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:21.190078 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:42:21.190078 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:42:21.190078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:42:21.190078 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:42:21.190078 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:42:21.198025 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:42:21.641578 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:42:21.673499 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:42:21.689372 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:42:21.182067 => 17:42:21.689372
[0m17:42:21.689372 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:42:21.117723 => 17:42:21.689372
[0m17:42:21.689372 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:42:21.689372 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:42:21.689372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:42:21.700571 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:42:21.069065 => 17:42:21.700571
[0m17:42:21.700571 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:42:21.752541 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:42:21.752541 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:42:21.166409 => 17:42:21.752541
[0m17:42:21.768516 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:42:21.800217 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371619CC80>]}
[0m17:42:21.800217 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.75s]
[0m17:42:21.800217 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:42:21.800217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371619C6E0>]}
[0m17:42:21.807555 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.77s]
[0m17:42:21.807555 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:42:21.809564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371619FDD0>]}
[0m17:42:21.809564 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.77s]
[0m17:42:21.809564 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:42:21.867605 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714E0D490>]}
[0m17:42:21.869910 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.83s]
[0m17:42:21.869910 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:42:21.869910 [debug] [Thread-4 (]: Began running node model.data_engineering_project.cross_sell
[0m17:42:21.869910 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m17:42:21.869910 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_rank
[0m17:42:21.869910 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:42:21.877067 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m17:42:21.869910 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:42:21.877067 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.cross_sell)
[0m17:42:21.877067 [info ] [Thread-2 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:42:21.877067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m17:42:21.877067 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:42:21.877067 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:42:21.882737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_rank)
[0m17:42:21.883780 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:42:21.885231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m17:42:21.890702 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:42:21.891702 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:42:21.895706 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:42:21.896707 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:42:21.901652 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:42:21.907616 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:42:21.909625 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:42:21.885695 => 17:42:21.908620
[0m17:42:21.910044 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:42:21.912059 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:42:21.912059 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:42:21.891702 => 17:42:21.912059
[0m17:42:21.912059 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:42:21.912059 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:42:21.902619 => 17:42:21.912059
[0m17:42:21.919106 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:42:21.896707 => 17:42:21.919106
[0m17:42:21.920689 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:42:21.920689 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m17:42:21.920689 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:42:21.920689 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:42:21.920689 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:42:21.935784 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name,
    ORDER BY
        num_products_bought DESC
),
highest_cross_sell AS (
    SELECT * , 
        RANK() OVER (ORDER BY num_products_bought DESC) AS cross_sell_rank
    FROM cross_sell_analysis
)
 
SELECT
    *
FROM
    highest_cross_sell
  );
[0m17:42:21.941665 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:42:21.942725 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:42:21.945678 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:42:21.946810 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:42:21.949852 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:42:21.950817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:21.951818 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:42:21.953857 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:42:21.954819 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:42:21.955818 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:42:21.957818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:42:22.419512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:42:22.429520 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:42:21.920689 => 17:42:22.429520
[0m17:42:22.431529 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m17:42:22.435290 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:42:22.439979 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:42:21.920689 => 17:42:22.439979
[0m17:42:22.441985 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m17:42:22.472670 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:42:22.477665 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:42:21.937062 => 17:42:22.477665
[0m17:42:22.478662 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: Close
[0m17:42:22.518408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714E2BB00>]}
[0m17:42:22.534449 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.64s]
[0m17:42:22.534449 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:42:22.534449 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_churn
[0m17:42:22.536995 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:42:22.536995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_churn)
[0m17:42:22.536995 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:42:22.542975 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:42:22.542975 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237161B5E20>]}
[0m17:42:22.542975 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.66s]
[0m17:42:22.542975 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m17:42:22.542975 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_rank
[0m17:42:22.542975 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:42:22.540126 => 17:42:22.542975
[0m17:42:22.550448 [info ] [Thread-3 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:42:22.551453 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_churn
[0m17:42:22.552448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.product_rank)
[0m17:42:22.556816 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:42:22.558388 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:42:22.563586 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:42:22.565553 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bb007c-0001-429e-0008-4d96000226f2
[0m17:42:22.566553 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:42:22.558388 => 17:42:22.565553
[0m17:42:22.567586 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:42:22.567586 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 4 unexpected 'ORDER'.
[0m17:42:22.569762 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_rank
[0m17:42:22.570411 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:42:22.570411 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:42:21.910044 => 17:42:22.570411
[0m17:42:22.570411 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:42:22.570411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:22.570411 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: Close
[0m17:42:22.570411 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:42:22.570411 [debug] [Thread-3 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:42:22.586417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:42:22.589279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237161B67E0>]}
[0m17:42:22.591293 [info ] [Thread-2 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.71s]
[0m17:42:22.594408 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:42:22.724882 [debug] [Thread-4 (]: Database Error in model cross_sell (models\reporting\cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 4 unexpected 'ORDER'.
  compiled Code at target\run\data_engineering_project\models\reporting\cross_sell.sql
[0m17:42:22.724882 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237161CAAE0>]}
[0m17:42:22.724882 [error] [Thread-4 (]: 5 of 10 ERROR creating sql view model DESCHEMA_reporting.cross_sell ............ [[31mERROR[0m in 0.85s]
[0m17:42:22.726889 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:42:23.053271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:42:23.071407 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:42:22.553177 => 17:42:23.071407
[0m17:42:23.073413 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: Close
[0m17:42:23.089196 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:42:23.093206 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:42:22.570411 => 17:42:23.091200
[0m17:42:23.093206 [debug] [Thread-3 (]: On model.data_engineering_project.product_rank: Close
[0m17:42:23.170315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237162E8E90>]}
[0m17:42:23.170315 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.63s]
[0m17:42:23.170315 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_churn
[0m17:42:23.193674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a767cf-ff23-4a54-8851-de19ae3a8bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237163239E0>]}
[0m17:42:23.193674 [info ] [Thread-3 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.64s]
[0m17:42:23.193674 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_rank
[0m17:42:23.193674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m17:42:23.193674 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:42:23.203716 [debug] [MainThread]: Connection 'model.data_engineering_project.cross_sell' was properly closed.
[0m17:42:23.205270 [info ] [MainThread]: 
[0m17:42:23.207281 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m17:42:23.211404 [debug] [MainThread]: Command end result
[0m17:42:23.228586 [info ] [MainThread]: 
[0m17:42:23.229598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:42:23.230566 [info ] [MainThread]: 
[0m17:42:23.230566 [error] [MainThread]:   Database Error in model cross_sell (models\reporting\cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 4 unexpected 'ORDER'.
  compiled Code at target\run\data_engineering_project\models\reporting\cross_sell.sql
[0m17:42:23.232968 [info ] [MainThread]: 
[0m17:42:23.233975 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m17:42:23.233975 [debug] [MainThread]: Command `dbt run` failed at 17:42:23.233975 after 5.14 seconds
[0m17:42:23.233975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237144BE4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371486B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023714808B30>]}
[0m17:42:23.237077 [debug] [MainThread]: Flushing usage events
[0m17:43:36.700679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4165460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF41656D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4165220>]}


============================== 17:43:36.707714 | 24b561ec-79d2-4277-af77-614743c35e1c ==============================
[0m17:43:36.707714 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:43:36.708677 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:43:37.285672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4924B00>]}
[0m17:43:37.397353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4194C80>]}
[0m17:43:37.397353 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:43:37.414935 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:43:37.582332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:37.582332 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:43:37.779015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4CE36B0>]}
[0m17:43:37.794747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4A682F0>]}
[0m17:43:37.794747 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:43:37.794747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4C0C590>]}
[0m17:43:37.794747 [info ] [MainThread]: 
[0m17:43:37.794747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:37.794747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:43:37.811453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:43:37.846792 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:43:37.850897 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:43:37.850897 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:43:37.850897 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:43:37.850897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:37.850897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:38.855868 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:43:38.857878 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:43:38.869678 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:43:38.871688 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:43:38.985181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:43:38.989817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:43:39.053236 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:43:39.053236 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:43:39.053236 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:43:39.059288 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:43:39.059288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:39.059288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:39.437074 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:43:39.447971 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:43:39.529963 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:43:39.538925 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:43:39.631493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4CE7E00>]}
[0m17:43:39.631493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:39.631493 [info ] [MainThread]: 
[0m17:43:39.631493 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:43:39.631493 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:43:39.631493 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:43:39.631493 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:43:39.631493 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:43:39.631493 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:43:39.631493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:43:39.631493 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:43:39.648337 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:43:39.649337 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:43:39.650334 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:43:39.631493 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:43:39.651339 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:43:39.662369 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:43:39.662369 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:43:39.665338 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:43:39.669087 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:43:39.674314 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:43:39.674314 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:43:39.681864 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:43:39.682862 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:43:39.652338 => 17:43:39.682862
[0m17:43:39.683863 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:43:39.701080 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:43:39.666348 => 17:43:39.701080
[0m17:43:39.701080 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:43:39.776586 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:43:39.670086 => 17:43:39.776586
[0m17:43:39.797994 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:43:39.797994 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:43:39.815248 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:43:39.815248 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:43:39.674314 => 17:43:39.815248
[0m17:43:39.815248 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:43:39.815248 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:43:39.815248 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:43:39.831339 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:43:39.831339 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:43:39.833602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:43:39.833602 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:43:39.833602 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:43:39.833602 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:43:39.833602 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:43:39.833602 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:43:39.833602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:43:39.833602 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:43:39.833602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:43:39.833602 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:40.269141 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:43:40.305801 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:43:39.701080 => 17:43:40.304799
[0m17:43:40.306768 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:43:40.308802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:43:40.312801 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:43:39.683863 => 17:43:40.312801
[0m17:43:40.314524 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:43:40.315728 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:43:40.320726 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:43:39.815248 => 17:43:40.320726
[0m17:43:40.321726 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:43:40.342727 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:43:40.345719 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:43:39.797994 => 17:43:40.345719
[0m17:43:40.347337 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:43:40.412657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4E9C4A0>]}
[0m17:43:40.413691 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.77s]
[0m17:43:40.416660 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:43:40.418687 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4E9C9B0>]}
[0m17:43:40.419691 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.76s]
[0m17:43:40.421657 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:43:40.425659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4E9C740>]}
[0m17:43:40.426658 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.79s]
[0m17:43:40.432089 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:43:40.622509 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4E9D0A0>]}
[0m17:43:40.622509 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.97s]
[0m17:43:40.624518 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:43:40.630293 [debug] [Thread-2 (]: Began running node model.data_engineering_project.cross_sell
[0m17:43:40.636341 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_churn
[0m17:43:40.636341 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_rank
[0m17:43:40.632240 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:43:40.644388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.cross_sell)
[0m17:43:40.644388 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:43:40.660216 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:43:40.665390 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:43:40.650159 => 17:43:40.662222
[0m17:43:40.665390 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:43:40.671456 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:43:40.673464 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:43:40.673464 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name,
    ORDER BY
        num_products_bought DESC
)
 
SELECT
    *
FROM
   cross_sell_analysis
  );
[0m17:43:40.675472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:43:40.638351 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m17:43:40.638351 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:43:40.693352 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.customer_churn)
[0m17:43:40.695363 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:43:40.705432 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:43:40.638351 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:43:40.707443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_rank)
[0m17:43:40.689328 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:43:40.707443 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:43:40.709196 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:43:40.695363 => 17:43:40.709196
[0m17:43:40.711205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m17:43:40.718615 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:43:40.720626 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:43:40.720626 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:43:40.728676 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:43:40.740487 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:43:40.740487 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:43:40.711205 => 17:43:40.740487
[0m17:43:40.742495 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:43:40.751109 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:43:40.753119 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:43:40.755128 [debug] [Thread-4 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:43:40.755128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:43:40.755128 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:43:40.732441 => 17:43:40.755128
[0m17:43:40.757135 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:43:40.759144 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m17:43:40.759144 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:43:40.768709 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:43:40.770720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:40.774737 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:43:40.774737 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:43:40.776747 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:43:41.110420 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb007d-0001-429b-0008-4d96000230da
[0m17:43:41.110420 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 4 unexpected 'ORDER'.
[0m17:43:41.110420 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:43:40.667438 => 17:43:41.110420
[0m17:43:41.115901 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: Close
[0m17:43:41.225738 [debug] [Thread-2 (]: Database Error in model cross_sell (models\reporting\cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 4 unexpected 'ORDER'.
  compiled Code at target\run\data_engineering_project\models\reporting\cross_sell.sql
[0m17:43:41.226738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4F388C0>]}
[0m17:43:41.227739 [error] [Thread-2 (]: 5 of 10 ERROR creating sql view model DESCHEMA_reporting.cross_sell ............ [[31mERROR[0m in 0.58s]
[0m17:43:41.228407 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:43:41.229450 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_churn
[0m17:43:41.229450 [info ] [Thread-2 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:43:41.232636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.product_churn)
[0m17:43:41.232636 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:43:41.237875 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:43:41.239875 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:43:41.233636 => 17:43:41.238871
[0m17:43:41.240911 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_churn
[0m17:43:41.245004 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:43:41.250006 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:43:41.251005 [debug] [Thread-2 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:43:41.252037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:43:41.294867 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:43:41.299305 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:43:40.722641 => 17:43:41.299305
[0m17:43:41.300278 [debug] [Thread-4 (]: On model.data_engineering_project.customer_churn: Close
[0m17:43:41.341753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:43:41.346397 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:43:40.742495 => 17:43:41.346397
[0m17:43:41.347546 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: Close
[0m17:43:41.352159 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:43:41.356804 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:43:40.759144 => 17:43:41.356804
[0m17:43:41.357805 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m17:43:41.414847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4B08320>]}
[0m17:43:41.414847 [info ] [Thread-4 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.72s]
[0m17:43:41.414847 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:43:41.414847 [debug] [Thread-4 (]: Began running node model.data_engineering_project.product_rank
[0m17:43:41.420686 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:43:41.420686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_rank)
[0m17:43:41.420686 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:43:41.426197 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:43:41.428205 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:43:41.420686 => 17:43:41.428205
[0m17:43:41.430880 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.product_rank
[0m17:43:41.441298 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:43:41.444299 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:43:41.445295 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:43:41.447302 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:43:41.477494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4F38410>]}
[0m17:43:41.478495 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.77s]
[0m17:43:41.479622 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:43:41.483219 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4EC4140>]}
[0m17:43:41.483219 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.77s]
[0m17:43:41.483219 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m17:43:41.728262 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:43:41.728262 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:43:41.240911 => 17:43:41.728262
[0m17:43:41.728262 [debug] [Thread-2 (]: On model.data_engineering_project.product_churn: Close
[0m17:43:41.822867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4F36DE0>]}
[0m17:43:41.822867 [info ] [Thread-2 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.59s]
[0m17:43:41.838918 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_churn
[0m17:43:41.966272 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:43:41.970743 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:43:41.431607 => 17:43:41.970743
[0m17:43:41.970743 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: Close
[0m17:43:42.064631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24b561ec-79d2-4277-af77-614743c35e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4F388C0>]}
[0m17:43:42.064631 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.64s]
[0m17:43:42.064631 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.product_rank
[0m17:43:42.080342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:42.080342 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:43:42.082850 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:43:42.082850 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:43:42.082850 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:43:42.084858 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m17:43:42.084858 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:43:42.084858 [debug] [MainThread]: Connection 'model.data_engineering_project.new_logos' was properly closed.
[0m17:43:42.084858 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:43:42.086866 [info ] [MainThread]: 
[0m17:43:42.086866 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m17:43:42.092893 [debug] [MainThread]: Command end result
[0m17:43:42.112119 [info ] [MainThread]: 
[0m17:43:42.112119 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:42.112119 [info ] [MainThread]: 
[0m17:43:42.112119 [error] [MainThread]:   Database Error in model cross_sell (models\reporting\cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 4 unexpected 'ORDER'.
  compiled Code at target\run\data_engineering_project\models\reporting\cross_sell.sql
[0m17:43:42.112119 [info ] [MainThread]: 
[0m17:43:42.112119 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m17:43:42.120144 [debug] [MainThread]: Command `dbt run` failed at 17:43:42.120144 after 5.50 seconds
[0m17:43:42.120144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF2E4AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF4925490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EAF2D5C320>]}
[0m17:43:42.122165 [debug] [MainThread]: Flushing usage events
[0m17:47:56.968750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653FF5D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653FE72390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653FF5DA30>]}


============================== 17:47:56.984462 | 5329e81a-db32-4db0-a1d4-63a62ea0f13d ==============================
[0m17:47:56.984462 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:47:56.984462 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:48:00.453602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265410D85C0>]}
[0m17:48:00.578552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265415E72C0>]}
[0m17:48:00.580557 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:48:00.618867 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:48:02.166799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:02.168547 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:48:02.353082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541AE7500>]}
[0m17:48:02.387013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541864290>]}
[0m17:48:02.387013 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:48:02.390315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541368EC0>]}
[0m17:48:02.390315 [info ] [MainThread]: 
[0m17:48:02.393470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:48:02.393470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:48:02.413191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:48:02.413191 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:48:02.419300 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:48:02.420302 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:48:02.420302 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:48:02.421300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:02.422266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:03.631640 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:48:03.644608 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:48:03.647589 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:48:03.647589 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:48:03.833812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:48:03.844794 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:48:03.844794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:48:03.844794 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:48:03.853792 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:48:03.853792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:03.853792 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:48:03.853792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:04.214236 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:48:04.214236 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:48:04.321615 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:48:04.323615 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:48:04.424030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541B7F650>]}
[0m17:48:04.424030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:04.424030 [info ] [MainThread]: 
[0m17:48:04.424030 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:48:04.424030 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:48:04.424030 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:48:04.424030 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:48:04.424030 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:48:04.424030 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:48:04.441181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:48:04.424030 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:48:04.443183 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:48:04.441181 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:48:04.443904 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:48:04.445488 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:48:04.446544 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:48:04.460163 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:48:04.460779 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:48:04.466131 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:48:04.468146 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:48:04.470161 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:48:04.447553 => 17:48:04.470161
[0m17:48:04.475293 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:48:04.477597 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:48:04.479622 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:48:04.462809 => 17:48:04.479622
[0m17:48:04.481631 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:48:04.485657 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:48:04.487673 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:48:04.587792 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:48:04.472173 => 17:48:04.587792
[0m17:48:04.593555 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:48:04.599577 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:48:04.599577 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:48:04.611373 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:48:04.611373 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:48:04.481631 => 17:48:04.611373
[0m17:48:04.611373 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:48:04.613730 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:48:04.617065 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:48:04.619072 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:48:04.619072 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:48:04.619072 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:48:04.619072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:04.619072 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:48:04.619072 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:48:04.625058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:04.625058 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:48:04.625058 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:48:04.625058 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:48:04.625058 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:48:05.088164 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:05.133686 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:48:04.527104 => 17:48:05.133686
[0m17:48:05.135423 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:48:05.135423 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:05.137431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:05.142581 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:48:04.613730 => 17:48:05.137431
[0m17:48:05.146193 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:48:04.487673 => 17:48:05.146193
[0m17:48:05.146193 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:48:05.147698 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:48:05.204237 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:05.214800 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:48:04.599577 => 17:48:05.204237
[0m17:48:05.214800 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:48:05.247928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541D39520>]}
[0m17:48:05.247928 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.81s]
[0m17:48:05.247928 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:48:05.247928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541D015E0>]}
[0m17:48:05.247928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541CEA630>]}
[0m17:48:05.262444 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.82s]
[0m17:48:05.262444 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:48:05.262444 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.80s]
[0m17:48:05.262444 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:48:05.313028 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541CEACF0>]}
[0m17:48:05.313028 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.87s]
[0m17:48:05.313028 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:48:05.328654 [debug] [Thread-2 (]: Began running node model.data_engineering_project.cross_sell
[0m17:48:05.328654 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m17:48:05.330653 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_rank
[0m17:48:05.331653 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m17:48:05.329689 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:48:05.332689 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:48:05.334696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.cross_sell)
[0m17:48:05.332689 [info ] [Thread-4 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:48:05.335696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m17:48:05.336731 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:48:05.333697 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:48:05.337698 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.customer_rank)
[0m17:48:05.338697 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:48:05.345704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m17:48:05.345704 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:48:05.343697 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:48:05.350296 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:48:05.352203 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:48:05.356244 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:48:05.357223 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:48:05.362168 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:48:05.339695 => 17:48:05.357223
[0m17:48:05.364272 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:48:05.366286 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:48:05.366286 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:48:05.348284 => 17:48:05.366286
[0m17:48:05.366286 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:48:05.375287 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:48:05.376284 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:48:05.356244 => 17:48:05.376284
[0m17:48:05.379839 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m17:48:05.387673 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:48:05.387673 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:48:05.387673 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:48:05.352203 => 17:48:05.387673
[0m17:48:05.387673 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name,
  
)
 
SELECT
    *
FROM
   cross_sell_analysis
  );
[0m17:48:05.397067 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:48:05.398085 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:48:05.399064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:05.400061 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:48:05.404105 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:48:05.406074 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:48:05.407063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:05.409062 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:48:05.411064 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:05.415106 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:48:05.416062 [debug] [Thread-4 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:48:05.419064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:05.976845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:05.976845 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:48:05.366286 => 17:48:05.976845
[0m17:48:05.976845 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m17:48:06.008921 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:06.022093 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:48:05.401059 => 17:48:06.022093
[0m17:48:06.022093 [debug] [Thread-4 (]: On model.data_engineering_project.customer_rank: Close
[0m17:48:06.088282 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:06.088282 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:48:05.379839 => 17:48:06.088282
[0m17:48:06.088282 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m17:48:06.088282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265419C85F0>]}
[0m17:48:06.088282 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.75s]
[0m17:48:06.098606 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:48:06.098606 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_churn
[0m17:48:06.098606 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:48:06.098606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_churn)
[0m17:48:06.098606 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:48:06.107702 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:48:06.109574 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:48:06.098606 => 17:48:06.109574
[0m17:48:06.110643 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_churn
[0m17:48:06.113997 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:48:06.113997 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bb0082-0001-429e-0008-4d960002272e
[0m17:48:06.113997 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 0 unexpected ')'.
[0m17:48:06.113997 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:48:05.364272 => 17:48:06.113997
[0m17:48:06.113997 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:48:06.113997 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: Close
[0m17:48:06.113997 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:48:06.113997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:06.142391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541CEA6F0>]}
[0m17:48:06.142391 [info ] [Thread-4 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.80s]
[0m17:48:06.144400 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:48:06.147248 [debug] [Thread-4 (]: Began running node model.data_engineering_project.product_rank
[0m17:48:06.147248 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:48:06.150614 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_rank, now model.data_engineering_project.product_rank)
[0m17:48:06.150614 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:48:06.156593 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:48:06.158603 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:48:06.151614 => 17:48:06.157601
[0m17:48:06.158603 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.product_rank
[0m17:48:06.163641 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:48:06.166602 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:48:06.167603 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:48:06.167603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:06.210708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541CC1340>]}
[0m17:48:06.212904 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.87s]
[0m17:48:06.214318 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m17:48:06.247314 [debug] [Thread-2 (]: Database Error in model cross_sell (models\reporting\cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 0 unexpected ')'.
  compiled Code at target\run\data_engineering_project\models\reporting\cross_sell.sql
[0m17:48:06.249347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653BDA1670>]}
[0m17:48:06.249347 [error] [Thread-2 (]: 5 of 10 ERROR creating sql view model DESCHEMA_reporting.cross_sell ............ [[31mERROR[0m in 0.91s]
[0m17:48:06.249347 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:48:06.609607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:06.609607 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:48:06.110643 => 17:48:06.609607
[0m17:48:06.609607 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: Close
[0m17:48:06.737922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541CD93A0>]}
[0m17:48:06.737922 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.64s]
[0m17:48:06.737922 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_churn
[0m17:48:06.737922 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:06.750052 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:48:06.159602 => 17:48:06.750052
[0m17:48:06.750052 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: Close
[0m17:48:06.850075 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5329e81a-db32-4db0-a1d4-63a62ea0f13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541CEA990>]}
[0m17:48:06.850075 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.70s]
[0m17:48:06.850075 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.product_rank
[0m17:48:06.850075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:06.850075 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:48:06.850075 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:48:06.850075 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:48:06.850075 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:48:06.850075 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:48:06.850075 [debug] [MainThread]: Connection 'model.data_engineering_project.cross_sell' was properly closed.
[0m17:48:06.861173 [debug] [MainThread]: Connection 'model.data_engineering_project.new_logos' was properly closed.
[0m17:48:06.861173 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:48:06.861173 [info ] [MainThread]: 
[0m17:48:06.861173 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m17:48:06.866278 [debug] [MainThread]: Command end result
[0m17:48:06.883341 [info ] [MainThread]: 
[0m17:48:06.885354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:06.885354 [info ] [MainThread]: 
[0m17:48:06.887366 [error] [MainThread]:   Database Error in model cross_sell (models\reporting\cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 0 unexpected ')'.
  compiled Code at target\run\data_engineering_project\models\reporting\cross_sell.sql
[0m17:48:06.888592 [info ] [MainThread]: 
[0m17:48:06.889591 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m17:48:06.893063 [debug] [MainThread]: Command `dbt run` failed at 17:48:06.891050 after 10.03 seconds
[0m17:48:06.893063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653FE72B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653E150170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265416838F0>]}
[0m17:48:06.893063 [debug] [MainThread]: Flushing usage events
[0m17:48:45.053796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B76F5DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B76F5DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B76F5D6D0>]}


============================== 17:48:45.063089 | cb42120d-04c5-41e0-84d9-967ae60bc722 ==============================
[0m17:48:45.063089 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:48:45.063089 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:48:45.596232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B76F94560>]}
[0m17:48:45.717663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B76F94560>]}
[0m17:48:45.717663 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:48:45.733362 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:48:45.867015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:45.867015 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:48:46.055216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B789CAF00>]}
[0m17:48:46.066148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B788BCB90>]}
[0m17:48:46.066148 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:48:46.066148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78681F70>]}
[0m17:48:46.081901 [info ] [MainThread]: 
[0m17:48:46.081901 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:48:46.081901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:48:46.097976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:48:46.106260 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:48:46.106260 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:48:46.111288 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:48:46.111288 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:48:46.111288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:46.111288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:47.133433 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:48:47.133433 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:48:47.133433 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:48:47.133433 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:48:47.229533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:48:47.229533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:48:47.257010 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:48:47.260052 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:48:47.261053 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:48:47.261053 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:48:47.262053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:47.262053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:47.608140 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:48:47.608140 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:48:47.608140 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:48:47.608140 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:48:47.706747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78AFBA40>]}
[0m17:48:47.706747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:47.706747 [info ] [MainThread]: 
[0m17:48:47.715224 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:48:47.715224 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:48:47.717832 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:48:47.717832 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:48:47.715224 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:48:47.719148 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:48:47.722748 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:48:47.719865 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:48:47.723779 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:48:47.724755 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:48:47.720710 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:48:47.724755 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:48:47.724755 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:48:47.739322 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:48:47.741333 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:48:47.741333 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:48:47.745355 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:48:47.745355 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:48:47.749959 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:48:47.756031 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:48:47.758041 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:48:47.728266 => 17:48:47.758041
[0m17:48:47.758041 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:48:47.769398 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:48:47.741333 => 17:48:47.768959
[0m17:48:47.784799 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:48:47.747363 => 17:48:47.784799
[0m17:48:47.803787 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:48:47.809858 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:48:47.810824 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:48:47.862231 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:48:47.750923 => 17:48:47.862231
[0m17:48:47.862231 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:48:47.870644 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:48:47.870644 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:48:47.870644 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:48:47.870644 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:48:47.870644 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:48:47.870644 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:48:47.870644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:47.870644 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:48:47.870644 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:48:47.870644 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:48:47.870644 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:47.884500 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:48:47.884500 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:48:47.884500 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:48:47.884500 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:48:48.322782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:48.328747 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:48.337782 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:48:47.758041 => 17:48:48.337782
[0m17:48:48.353817 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:48:47.870644 => 17:48:48.353817
[0m17:48:48.353817 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:48:48.353817 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:48:48.419873 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:48.429977 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:48:47.862231 => 17:48:48.429977
[0m17:48:48.432000 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:48:48.449682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B787CA720>]}
[0m17:48:48.449682 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.73s]
[0m17:48:48.449682 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78CC2C90>]}
[0m17:48:48.465747 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:48:48.465747 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.71s]
[0m17:48:48.470906 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:48:48.523694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78935850>]}
[0m17:48:48.524695 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.80s]
[0m17:48:48.525693 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:48:48.526733 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m17:48:48.527737 [debug] [Thread-4 (]: Began running node model.data_engineering_project.new_logos
[0m17:48:48.528695 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_churn
[0m17:48:48.527737 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:48:48.529694 [info ] [Thread-4 (]: 6 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:48:48.531696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m17:48:48.532695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.new_logos)
[0m17:48:48.530695 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:48:48.533698 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:48:48.533698 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:48:48.534729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.product_churn)
[0m17:48:48.541403 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:48:48.542981 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:48:48.547326 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:48.549190 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:48:48.553235 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:48:47.810824 => 17:48:48.553235
[0m17:48:48.558655 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:48:48.558655 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:48:48.562056 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:48:48.535695 => 17:48:48.558655
[0m17:48:48.562056 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:48:48.566072 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:48:48.568080 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:48:48.541403 => 17:48:48.568080
[0m17:48:48.568080 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.new_logos
[0m17:48:48.570088 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:48:48.554199 => 17:48:48.568080
[0m17:48:48.571183 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:48:48.571183 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_churn
[0m17:48:48.571183 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:48:48.584829 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:48:48.587430 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:48:48.588187 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:48:48.588187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:48.588187 [debug] [Thread-4 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:48:48.588187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:48.588187 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:48:48.594914 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:48:48.594914 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:48.671290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78AFAF00>]}
[0m17:48:48.671290 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.95s]
[0m17:48:48.671290 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:48:48.671290 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_rank
[0m17:48:48.671290 [info ] [Thread-2 (]: 8 of 10 START sql view model DESCHEMA_reporting.product_rank ................... [RUN]
[0m17:48:48.685111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.product_rank)
[0m17:48:48.686074 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:48:48.689683 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:48:48.691748 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:48:48.686074 => 17:48:48.690783
[0m17:48:48.693703 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_rank
[0m17:48:48.707174 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:48:48.711749 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:48:48.711749 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:48:48.711749 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:49.044296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:49.044296 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:48:48.562056 => 17:48:49.044296
[0m17:48:49.044296 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m17:48:49.071673 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:49.076435 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:48:48.571183 => 17:48:49.076435
[0m17:48:49.076435 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: Close
[0m17:48:49.076435 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:49.076435 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:48:48.571183 => 17:48:49.076435
[0m17:48:49.076435 [debug] [Thread-4 (]: On model.data_engineering_project.new_logos: Close
[0m17:48:49.139117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78CC33B0>]}
[0m17:48:49.139117 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.61s]
[0m17:48:49.139117 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:48:49.139117 [debug] [Thread-1 (]: Began running node model.data_engineering_project.cross_sell
[0m17:48:49.143145 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:48:49.143145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.cross_sell)
[0m17:48:49.143145 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:48:49.143145 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:48:49.143145 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:48:49.143145 => 17:48:49.143145
[0m17:48:49.143145 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:48:49.155219 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:48:49.155219 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:48:49.158191 [debug] [Thread-1 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
  );
[0m17:48:49.158191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:49.169840 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B788BFB60>]}
[0m17:48:49.170838 [info ] [Thread-4 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.64s]
[0m17:48:49.173317 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.new_logos
[0m17:48:49.173317 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_rank
[0m17:48:49.174319 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.customer_rank ................. [RUN]
[0m17:48:49.175320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.customer_rank)
[0m17:48:49.176316 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:48:49.180946 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:48:49.184094 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:48:49.176316 => 17:48:49.184094
[0m17:48:49.185094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78C94470>]}
[0m17:48:49.186129 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:48:49.192095 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:48:49.187128 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.65s]
[0m17:48:49.194094 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_churn
[0m17:48:49.196095 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:48:49.198183 [debug] [Thread-4 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:48:49.198183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:49.261975 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:48:49.265976 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:48:48.702443 => 17:48:49.265976
[0m17:48:49.266974 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: Close
[0m17:48:49.360392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B789B37A0>]}
[0m17:48:49.360392 [info ] [Thread-2 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.product_rank .............. [[32mSUCCESS 1[0m in 0.68s]
[0m17:48:49.366367 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_rank
[0m17:48:49.629048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:49.629048 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:48:49.143145 => 17:48:49.629048
[0m17:48:49.629048 [debug] [Thread-1 (]: On model.data_engineering_project.cross_sell: Close
[0m17:48:49.692575 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:48:49.692575 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:48:49.187128 => 17:48:49.692575
[0m17:48:49.692575 [debug] [Thread-4 (]: On model.data_engineering_project.customer_rank: Close
[0m17:48:49.708719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78CC33B0>]}
[0m17:48:49.708719 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.57s]
[0m17:48:49.708719 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:48:49.790087 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb42120d-04c5-41e0-84d9-967ae60bc722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78908530>]}
[0m17:48:49.791088 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............ [[32mSUCCESS 1[0m in 0.61s]
[0m17:48:49.792053 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:48:49.795096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:49.796097 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:48:49.796097 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:48:49.797096 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:48:49.797096 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:48:49.798096 [debug] [MainThread]: Connection 'model.data_engineering_project.cross_sell' was properly closed.
[0m17:48:49.798096 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:48:49.798096 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:48:49.799096 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m17:48:49.799096 [info ] [MainThread]: 
[0m17:48:49.800095 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m17:48:49.804405 [debug] [MainThread]: Command end result
[0m17:48:49.819313 [info ] [MainThread]: 
[0m17:48:49.820313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:49.821313 [info ] [MainThread]: 
[0m17:48:49.822313 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:48:49.824315 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:49.824315 after 4.85 seconds
[0m17:48:49.825504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B786B8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B789D33B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B78A65820>]}
[0m17:48:49.826502 [debug] [MainThread]: Flushing usage events
[0m17:49:46.128057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188285D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188285D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188285D5B0>]}


============================== 17:49:46.143383 | e56ea09a-e7d5-4959-a787-d9dcb413c9a3 ==============================
[0m17:49:46.143383 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:49:46.143383 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:49:46.678540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218829D81A0>]}
[0m17:49:46.795358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218829D81A0>]}
[0m17:49:46.795358 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:49:46.813443 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:49:46.956895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:46.958645 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:49:47.134069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218833E3AA0>]}
[0m17:49:47.160019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218831BCC80>]}
[0m17:49:47.161019 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:49:47.162017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218831BCA40>]}
[0m17:49:47.164385 [info ] [MainThread]: 
[0m17:49:47.166429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:47.167978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:49:47.186265 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:49:47.187008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:49:47.187008 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:49:47.190919 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:49:47.191962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:47.192839 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:49:47.193386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:48.120750 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:49:48.120750 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:49:48.120750 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:49:48.136705 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:49:48.240506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:49:48.244504 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:49:48.247541 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:49:48.255226 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:49:48.255226 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:49:48.255226 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:49:48.255226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:48.255226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:48.672984 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:49:48.680795 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:49:48.684310 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:49:48.684310 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:49:48.778305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218834642C0>]}
[0m17:49:48.779305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:48.780306 [info ] [MainThread]: 
[0m17:49:48.781303 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:49:48.781303 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:49:48.781303 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:49:48.781303 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:49:48.781303 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:49:48.781303 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:49:48.792255 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:49:48.791246 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:49:48.794896 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:49:48.793290 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:49:48.795948 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:49:48.797476 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:49:48.798639 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:49:48.810089 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:49:48.811092 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:49:48.812088 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:49:48.816578 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:49:48.818592 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:49:48.820602 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:49:48.820602 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:49:48.820602 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:49:48.799903 => 17:49:48.820602
[0m17:49:48.820602 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:49:48.848240 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:49:48.818592 => 17:49:48.847393
[0m17:49:48.848240 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:49:48.812088 => 17:49:48.848240
[0m17:49:48.873554 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:49:48.873554 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:49:48.873554 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:49:48.820602 => 17:49:48.873554
[0m17:49:48.873554 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:49:48.934862 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:49:48.936868 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:49:48.938879 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:49:48.938879 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:49:48.945770 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:49:48.945770 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:49:48.945770 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:48.945770 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:49:48.945770 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:49:48.945770 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:49:48.945770 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:49:48.945770 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:49:48.945770 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:49:48.945770 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:49:48.961718 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:49:48.961718 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:49:49.376507 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:49:49.407640 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:49:48.936868 => 17:49:49.407640
[0m17:49:49.407640 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:49:49.479067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:49:49.497151 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:49:48.829656 => 17:49:49.497151
[0m17:49:49.497151 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:49:49.497151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218834438C0>]}
[0m17:49:49.497151 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.70s]
[0m17:49:49.497151 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:49:49.497151 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:49:49.511257 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:49:48.873554 => 17:49:49.509749
[0m17:49:49.511257 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:49:49.531906 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:49:49.531906 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:49:48.938879 => 17:49:49.531906
[0m17:49:49.531906 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:49:49.590752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218835A9D00>]}
[0m17:49:49.591752 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.80s]
[0m17:49:49.592719 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:49:49.599285 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218835F0BC0>]}
[0m17:49:49.599285 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.80s]
[0m17:49:49.599285 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:49:49.599285 [debug] [Thread-2 (]: Began running node model.data_engineering_project.cross_sell
[0m17:49:49.608063 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m17:49:49.608063 [debug] [Thread-3 (]: Began running node model.data_engineering_project.customer_rank
[0m17:49:49.608063 [info ] [Thread-2 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:49:49.609352 [info ] [Thread-1 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:49:49.611589 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.cross_sell)
[0m17:49:49.610353 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:49:49.612588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m17:49:49.613587 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:49:49.614896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.customer_rank)
[0m17:49:49.614896 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:49:49.614896 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:49:49.614896 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:49:49.614896 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:49:49.632222 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218835CA960>]}
[0m17:49:49.614896 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:49:49.634257 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.83s]
[0m17:49:49.636360 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:49:49.636360 [debug] [Thread-4 (]: Began running node model.data_engineering_project.new_logos
[0m17:49:49.638371 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:49:49.614896 => 17:49:49.638371
[0m17:49:49.640383 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:49:49.614896 => 17:49:49.638371
[0m17:49:49.638371 [info ] [Thread-4 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:49:49.640383 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:49:49.642395 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:49:49.614896 => 17:49:49.640383
[0m17:49:49.642395 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:49:49.643860 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.new_logos)
[0m17:49:49.648948 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:49:49.650241 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:49:49.654240 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:49:49.655241 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:49:49.662664 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:49:49.668627 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:49:49.670630 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:49:49.671631 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:49:49.672606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:49.676128 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:49:49.676128 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:49:49.663666 => 17:49:49.676128
[0m17:49:49.678136 [debug] [Thread-3 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:49:49.678136 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:49:49.680142 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.new_logos
[0m17:49:49.681480 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:49:49.682493 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought
  );
[0m17:49:49.687873 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:49:49.687873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:49:49.687873 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:49:49.687873 [debug] [Thread-4 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:49:49.687873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:49:50.124255 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:49:50.124255 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:49:49.683165 => 17:49:50.124255
[0m17:49:50.124255 [debug] [Thread-4 (]: On model.data_engineering_project.new_logos: Close
[0m17:49:50.140231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:49:50.156111 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:49:49.643860 => 17:49:50.156111
[0m17:49:50.156111 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m17:49:50.187634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:49:50.187634 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:49:49.650241 => 17:49:50.187634
[0m17:49:50.187634 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: Close
[0m17:49:50.205302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188311F770>]}
[0m17:49:50.205302 [info ] [Thread-4 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.56s]
[0m17:49:50.205302 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.new_logos
[0m17:49:50.205302 [debug] [Thread-4 (]: Began running node model.data_engineering_project.product_churn
[0m17:49:50.205302 [info ] [Thread-4 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:49:50.205302 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.product_churn)
[0m17:49:50.205302 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:49:50.218979 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:49:50.220988 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:49:50.215213 => 17:49:50.220988
[0m17:49:50.222277 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.product_churn
[0m17:49:50.226499 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:49:50.229435 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:49:50.232056 [debug] [Thread-4 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:49:50.234072 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:49:50.235066 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:49:50.240073 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:49:49.656206 => 17:49:50.239065
[0m17:49:50.240589 [debug] [Thread-3 (]: On model.data_engineering_project.customer_rank: Close
[0m17:49:50.252346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218833A8E60>]}
[0m17:49:50.254357 [info ] [Thread-1 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.64s]
[0m17:49:50.256368 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:49:50.256368 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_rank
[0m17:49:50.256368 [info ] [Thread-1 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:49:50.256368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_rank)
[0m17:49:50.256368 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:49:50.264728 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:49:50.266448 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:49:50.260706 => 17:49:50.265430
[0m17:49:50.267442 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_rank
[0m17:49:50.272435 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:49:50.273442 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:49:50.274955 [debug] [Thread-1 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:49:50.275963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:50.294714 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883234FE0>]}
[0m17:49:50.294714 [info ] [Thread-2 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.68s]
[0m17:49:50.296721 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:49:50.348205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218835A9070>]}
[0m17:49:50.349208 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.73s]
[0m17:49:50.351207 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:49:50.706656 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:49:50.706656 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:49:50.222277 => 17:49:50.706656
[0m17:49:50.706656 [debug] [Thread-4 (]: On model.data_engineering_project.product_churn: Close
[0m17:49:50.770736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:49:50.777815 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:49:50.267442 => 17:49:50.777815
[0m17:49:50.779823 [debug] [Thread-1 (]: On model.data_engineering_project.product_rank: Close
[0m17:49:50.786768 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188320A120>]}
[0m17:49:50.786768 [info ] [Thread-4 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.58s]
[0m17:49:50.786768 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.product_churn
[0m17:49:50.864780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56ea09a-e7d5-4959-a787-d9dcb413c9a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FE84AA80>]}
[0m17:49:50.864780 [info ] [Thread-1 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.61s]
[0m17:49:50.866780 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_rank
[0m17:49:50.868778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:50.869778 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:49:50.869778 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:49:50.870778 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:49:50.870778 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:49:50.870778 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:49:50.871778 [debug] [MainThread]: Connection 'model.data_engineering_project.cross_sell' was properly closed.
[0m17:49:50.871778 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m17:49:50.872778 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:49:50.872778 [info ] [MainThread]: 
[0m17:49:50.873780 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m17:49:50.877364 [debug] [MainThread]: Command end result
[0m17:49:50.894365 [info ] [MainThread]: 
[0m17:49:50.895368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:50.896367 [info ] [MainThread]: 
[0m17:49:50.897365 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:49:50.899364 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:50.899364 after 4.84 seconds
[0m17:49:50.900367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188278F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FCEF9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218825E6AB0>]}
[0m17:49:50.900932 [debug] [MainThread]: Flushing usage events
[0m17:50:16.728292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212535D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212535D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212535D370>]}


============================== 17:50:16.728292 | 3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0 ==============================
[0m17:50:16.728292 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:50:16.728292 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:50:17.459500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125394B00>]}
[0m17:50:17.576908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221259191F0>]}
[0m17:50:17.576908 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:50:17.593264 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:50:17.740751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:17.740751 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:50:17.949112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125F078C0>]}
[0m17:50:17.963993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125C882C0>]}
[0m17:50:17.963993 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:50:17.963993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125E2D6A0>]}
[0m17:50:17.963993 [info ] [MainThread]: 
[0m17:50:17.963993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:17.973364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:50:17.984731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:50:17.996033 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:50:18.000034 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:50:18.001012 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:50:18.001012 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:50:18.001012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:18.001012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:19.017137 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:50:19.019136 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:50:19.076835 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:50:19.078140 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:50:19.188954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:50:19.200051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:50:19.230017 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:50:19.230017 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:50:19.230017 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:50:19.230017 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:50:19.230017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:19.230017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:19.559830 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:50:19.564398 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:50:19.659138 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:50:19.663137 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:50:19.752700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212707F650>]}
[0m17:50:19.752700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:19.752700 [info ] [MainThread]: 
[0m17:50:19.761523 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:50:19.762208 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:50:19.764232 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:50:19.765431 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:50:19.764232 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:50:19.766429 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:50:19.768853 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:50:19.766822 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:50:19.771112 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:50:19.773123 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:50:19.767855 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:50:19.775130 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:50:19.775130 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:50:19.779199 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:50:19.788586 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:50:19.788586 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:50:19.796827 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:50:19.796827 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:50:19.801840 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:50:19.805837 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:50:19.805837 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:50:19.775130 => 17:50:19.805837
[0m17:50:19.805837 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:50:19.845911 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:50:19.796827 => 17:50:19.845911
[0m17:50:19.846911 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:50:19.847913 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:50:19.802840 => 17:50:19.846911
[0m17:50:19.848328 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:50:19.788586 => 17:50:19.848328
[0m17:50:19.854412 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:50:19.899312 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:50:19.912146 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:50:19.912146 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:50:19.912146 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:50:19.920978 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:50:19.922987 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:50:19.922987 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:50:19.925409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:19.928924 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:50:19.928924 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:50:19.928924 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:50:19.928924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:50:19.928924 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:50:19.928924 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:50:19.928924 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:50:19.937295 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:50:19.937295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:50:20.411078 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:20.414688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:20.496219 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:20.504824 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:50:19.805837 => 17:50:20.504824
[0m17:50:20.512785 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:50:19.912146 => 17:50:20.512785
[0m17:50:20.515541 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:50:19.912146 => 17:50:20.515541
[0m17:50:20.517549 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:50:20.517549 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:50:20.519902 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:20.519902 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:50:20.526312 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:50:19.855412 => 17:50:20.524304
[0m17:50:20.528060 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:50:20.596674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125CDD6A0>]}
[0m17:50:20.596674 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.83s]
[0m17:50:20.596674 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:50:20.613061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125CDCD10>]}
[0m17:50:20.613061 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.84s]
[0m17:50:20.613061 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:50:20.622697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125CDC8C0>]}
[0m17:50:20.622697 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.85s]
[0m17:50:20.624707 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:50:20.626716 [debug] [Thread-1 (]: Began running node model.data_engineering_project.cross_sell
[0m17:50:20.630477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125C8A150>]}
[0m17:50:20.633177 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_churn
[0m17:50:20.626716 [info ] [Thread-1 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:50:20.635188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.cross_sell)
[0m17:50:20.637200 [debug] [Thread-3 (]: Began running node model.data_engineering_project.customer_rank
[0m17:50:20.637200 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:50:20.631159 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.85s]
[0m17:50:20.648216 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:50:20.648216 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:50:20.639208 [info ] [Thread-3 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:50:20.635188 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:50:20.650229 [debug] [Thread-4 (]: Began running node model.data_engineering_project.new_logos
[0m17:50:20.652238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.customer_rank)
[0m17:50:20.654250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_churn)
[0m17:50:20.656259 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:50:20.639208 => 17:50:20.654250
[0m17:50:20.654250 [info ] [Thread-4 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:50:20.656259 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:50:20.658269 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:50:20.658269 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:50:20.658269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.new_logos)
[0m17:50:20.666873 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:50:20.672675 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:50:20.679586 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:50:20.681596 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:50:20.687605 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:50:20.689613 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:50:20.658269 => 17:50:20.689613
[0m17:50:20.689613 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:50:20.668887 => 17:50:20.689613
[0m17:50:20.691624 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:50:20.691624 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:50:20.681596 => 17:50:20.691624
[0m17:50:20.693633 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:50:20.693633 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:50:20.695140 [debug] [Thread-1 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
  );
[0m17:50:20.696525 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.new_logos
[0m17:50:20.704589 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:50:20.712474 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:50:20.714484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:20.720572 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:50:20.724597 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:50:20.726616 [debug] [Thread-2 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:50:20.730529 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:50:20.731527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:50:20.732529 [debug] [Thread-3 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:50:20.735319 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:50:20.737318 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:50:20.739341 [debug] [Thread-4 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:50:20.741314 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:50:21.180406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:21.180406 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:50:20.674683 => 17:50:21.180406
[0m17:50:21.180406 [debug] [Thread-1 (]: On model.data_engineering_project.cross_sell: Close
[0m17:50:21.197431 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:21.197431 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:50:20.704589 => 17:50:21.197431
[0m17:50:21.197431 [debug] [Thread-2 (]: On model.data_engineering_project.customer_churn: Close
[0m17:50:21.231756 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:21.246328 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:50:20.715487 => 17:50:21.231756
[0m17:50:21.247323 [debug] [Thread-4 (]: On model.data_engineering_project.new_logos: Close
[0m17:50:21.247323 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:21.247323 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:50:20.698541 => 17:50:21.247323
[0m17:50:21.247323 [debug] [Thread-3 (]: On model.data_engineering_project.customer_rank: Close
[0m17:50:21.280754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212722C800>]}
[0m17:50:21.280754 [info ] [Thread-1 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.65s]
[0m17:50:21.280754 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:50:21.280754 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_churn
[0m17:50:21.280754 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:50:21.280754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.product_churn)
[0m17:50:21.280754 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:50:21.299310 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:50:21.299310 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:50:21.280754 => 17:50:21.299310
[0m17:50:21.299310 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125F18230>]}
[0m17:50:21.299310 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_churn
[0m17:50:21.299310 [info ] [Thread-2 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.65s]
[0m17:50:21.315755 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:50:21.315755 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:50:21.317764 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_rank
[0m17:50:21.319774 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:50:21.319774 [info ] [Thread-2 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:50:21.319774 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:50:21.319774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_rank)
[0m17:50:21.319774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:21.319774 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:50:21.330205 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:50:21.334227 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:50:21.319774 => 17:50:21.334227
[0m17:50:21.334227 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_rank
[0m17:50:21.334227 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:50:21.334227 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:50:21.334227 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:50:21.334227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:50:21.348837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221270B2C00>]}
[0m17:50:21.348837 [info ] [Thread-4 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.69s]
[0m17:50:21.348837 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.new_logos
[0m17:50:21.362086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212718C770>]}
[0m17:50:21.363530 [info ] [Thread-3 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.71s]
[0m17:50:21.367050 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:50:21.782619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:21.798091 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:50:21.299310 => 17:50:21.782619
[0m17:50:21.798988 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: Close
[0m17:50:21.862976 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:21.876151 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:50:21.334227 => 17:50:21.875218
[0m17:50:21.877305 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: Close
[0m17:50:21.888264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125D57C80>]}
[0m17:50:21.889267 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.61s]
[0m17:50:21.891225 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_churn
[0m17:50:21.968808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c4b03d5-e404-4aa5-bb0e-360a04b4c5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125F18230>]}
[0m17:50:21.968808 [info ] [Thread-2 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.65s]
[0m17:50:21.979717 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_rank
[0m17:50:21.980891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m17:50:21.980891 [debug] [MainThread]: Connection 'model.data_engineering_project.new_logos' was properly closed.
[0m17:50:21.980891 [info ] [MainThread]: 
[0m17:50:21.980891 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m17:50:21.990142 [debug] [MainThread]: Command end result
[0m17:50:22.007231 [info ] [MainThread]: 
[0m17:50:22.007231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:22.007231 [info ] [MainThread]: 
[0m17:50:22.007231 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:50:22.014331 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:22.013724 after 5.37 seconds
[0m17:50:22.014331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221254F0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022125DFA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221257A8560>]}
[0m17:50:22.014331 [debug] [MainThread]: Flushing usage events
[0m17:51:33.235483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91796B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91672390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91796330>]}


============================== 17:51:33.240247 | 435c9198-3a63-4380-9b79-258224a782eb ==============================
[0m17:51:33.240247 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:51:33.240247 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:51:33.837417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91DE5A30>]}
[0m17:51:33.964253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91F23650>]}
[0m17:51:33.965251 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:51:33.977252 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:51:34.135498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:34.136668 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\cross_sell.sql
[0m17:51:34.320810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91FF1D00>]}
[0m17:51:34.339019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D920BC980>]}
[0m17:51:34.339019 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:51:34.342636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D921F7650>]}
[0m17:51:34.344644 [info ] [MainThread]: 
[0m17:51:34.346649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:51:34.348396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:51:34.359287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m17:51:34.379543 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:51:34.381552 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m17:51:34.381552 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:51:34.381552 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m17:51:34.381552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:34.381552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:35.400922 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:51:35.404026 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:51:35.408595 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m17:51:35.410748 [debug] [ThreadPool]: On list_NEWDB: Close
[0m17:51:35.490422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m17:51:35.504434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m17:51:35.517581 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m17:51:35.521914 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m17:51:35.521914 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m17:51:35.523425 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m17:51:35.523425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:35.524434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:35.823078 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:51:35.831098 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m17:51:35.838839 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:51:35.843784 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m17:51:35.954484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D92298890>]}
[0m17:51:35.954484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:35.954484 [info ] [MainThread]: 
[0m17:51:35.954484 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m17:51:35.954484 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m17:51:35.954484 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m17:51:35.954484 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m17:51:35.954484 [info ] [Thread-1 (]: 1 of 10 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m17:51:35.954484 [info ] [Thread-2 (]: 2 of 10 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m17:51:35.973386 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m17:51:35.970583 [info ] [Thread-3 (]: 3 of 10 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m17:51:35.974385 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m17:51:35.975385 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m17:51:35.972375 [info ] [Thread-4 (]: 4 of 10 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m17:51:35.977187 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m17:51:35.977187 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m17:51:35.979892 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m17:51:35.990246 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m17:51:35.991246 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m17:51:35.996262 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m17:51:35.996262 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m17:51:36.000605 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m17:51:36.005062 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m17:51:36.006025 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 17:51:35.978186 => 17:51:36.006025
[0m17:51:36.007032 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m17:51:36.008028 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 17:51:35.991246 => 17:51:36.008028
[0m17:51:36.051506 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m17:51:36.052470 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m17:51:36.052470 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 17:51:35.997596 => 17:51:36.052470
[0m17:51:36.105266 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 17:51:36.001605 => 17:51:36.103257
[0m17:51:36.109276 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m17:51:36.109276 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m17:51:36.109276 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m17:51:36.109276 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m17:51:36.119318 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m17:51:36.119318 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m17:51:36.119318 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m17:51:36.119318 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m17:51:36.123273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:36.123273 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m17:51:36.123273 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m17:51:36.123273 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m17:51:36.123273 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m17:51:36.123273 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:51:36.123273 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:51:36.123273 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m17:51:36.135046 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:51:36.559874 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:36.591146 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 17:51:36.109276 => 17:51:36.591146
[0m17:51:36.591146 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m17:51:36.591146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:36.591146 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 17:51:36.008028 => 17:51:36.591146
[0m17:51:36.591146 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m17:51:36.591146 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:36.606350 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 17:51:36.053506 => 17:51:36.605087
[0m17:51:36.606350 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m17:51:36.690547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924E4800>]}
[0m17:51:36.690547 [info ] [Thread-4 (]: 4 of 10 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.71s]
[0m17:51:36.690547 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m17:51:36.690547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924FF170>]}
[0m17:51:36.690547 [info ] [Thread-2 (]: 2 of 10 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.72s]
[0m17:51:36.690547 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m17:51:36.704116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D9212A750>]}
[0m17:51:36.704775 [info ] [Thread-1 (]: 1 of 10 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.73s]
[0m17:51:36.705892 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m17:51:36.838354 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:51:36.842366 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 17:51:36.109276 => 17:51:36.842366
[0m17:51:36.842366 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m17:51:36.925424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924E7C20>]}
[0m17:51:36.925424 [info ] [Thread-3 (]: 3 of 10 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.95s]
[0m17:51:36.925424 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m17:51:36.925424 [debug] [Thread-4 (]: Began running node model.data_engineering_project.cross_sell
[0m17:51:36.938388 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_rank
[0m17:51:36.925424 [info ] [Thread-4 (]: 5 of 10 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m17:51:36.925424 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_churn
[0m17:51:36.941642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.cross_sell)
[0m17:51:36.941990 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m17:51:36.939050 [info ] [Thread-1 (]: 7 of 10 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m17:51:36.944793 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.cross_sell
[0m17:51:36.941990 [info ] [Thread-2 (]: 6 of 10 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m17:51:36.947105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_rank)
[0m17:51:36.945804 [info ] [Thread-3 (]: 8 of 10 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m17:51:36.951085 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m17:51:36.956044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_churn)
[0m17:51:36.957043 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_rank
[0m17:51:36.958043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m17:51:36.960043 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_churn
[0m17:51:36.966040 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m17:51:36.966454 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m17:51:36.971709 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m17:51:36.973712 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (compile): 17:51:36.948202 => 17:51:36.972711
[0m17:51:36.978709 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m17:51:36.980530 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.cross_sell
[0m17:51:36.988615 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m17:51:36.989616 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (compile): 17:51:36.961044 => 17:51:36.989616
[0m17:51:36.991611 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_rank
[0m17:51:36.992616 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 17:51:36.974711 => 17:51:36.991611
[0m17:51:36.997064 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m17:51:37.002569 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m17:51:37.002569 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m17:51:37.004578 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (compile): 17:51:36.966454 => 17:51:37.002569
[0m17:51:37.005055 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
LIMIT 10
  );
[0m17:51:37.011097 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m17:51:37.012096 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_churn
[0m17:51:37.013057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:51:37.017525 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m17:51:37.019635 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m17:51:37.020637 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m17:51:37.022756 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m17:51:37.023755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:37.025337 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m17:51:37.028380 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m17:51:37.029348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:51:37.030345 [debug] [Thread-2 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m17:51:37.033346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:51:37.501678 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:37.502714 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:37.507804 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (execute): 17:51:36.982558 => 17:51:37.507804
[0m17:51:37.508803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:37.512846 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (execute): 17:51:37.013057 => 17:51:37.512846
[0m17:51:37.513851 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: Close
[0m17:51:37.517846 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (execute): 17:51:36.993613 => 17:51:37.516847
[0m17:51:37.518846 [debug] [Thread-2 (]: On model.data_engineering_project.customer_churn: Close
[0m17:51:37.519846 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: Close
[0m17:51:37.525683 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:37.535024 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 17:51:37.006068 => 17:51:37.535024
[0m17:51:37.535024 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m17:51:37.615622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D8D74FE60>]}
[0m17:51:37.618622 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924C02C0>]}
[0m17:51:37.620619 [info ] [Thread-1 (]: 7 of 10 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.67s]
[0m17:51:37.625918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924C2DB0>]}
[0m17:51:37.622581 [info ] [Thread-4 (]: 5 of 10 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.68s]
[0m17:51:37.625918 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_rank
[0m17:51:37.625918 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924C2210>]}
[0m17:51:37.625918 [info ] [Thread-3 (]: 8 of 10 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.67s]
[0m17:51:37.633841 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.cross_sell
[0m17:51:37.635853 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_churn
[0m17:51:37.639629 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m17:51:37.637613 [info ] [Thread-2 (]: 6 of 10 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.67s]
[0m17:51:37.641642 [debug] [Thread-4 (]: Began running node model.data_engineering_project.product_rank
[0m17:51:37.643653 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_churn
[0m17:51:37.641642 [info ] [Thread-1 (]: 9 of 10 START sql view model DESCHEMA_reporting.product_churn .................. [RUN]
[0m17:51:37.649276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_rank, now model.data_engineering_project.product_churn)
[0m17:51:37.647265 [info ] [Thread-4 (]: 10 of 10 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m17:51:37.651288 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_churn
[0m17:51:37.651288 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.product_rank)
[0m17:51:37.657333 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m17:51:37.661352 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (compile): 17:51:37.653301 => 17:51:37.659343
[0m17:51:37.661352 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_churn
[0m17:51:37.659343 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.product_rank
[0m17:51:37.667381 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m17:51:37.671143 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m17:51:37.679197 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m17:51:37.679197 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m17:51:37.679197 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (compile): 17:51:37.667381 => 17:51:37.679197
[0m17:51:37.679197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:37.679197 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.product_rank
[0m17:51:37.685239 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m17:51:37.691573 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m17:51:37.691573 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m17:51:37.691573 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:51:38.143689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:51:38.147688 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (execute): 17:51:37.661352 => 17:51:38.146688
[0m17:51:38.147688 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: Close
[0m17:51:38.191596 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:51:38.197010 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (execute): 17:51:37.679197 => 17:51:38.197010
[0m17:51:38.197010 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: Close
[0m17:51:38.242587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D9175EE70>]}
[0m17:51:38.244599 [info ] [Thread-1 (]: 9 of 10 OK created sql view model DESCHEMA_reporting.product_churn ............. [[32mSUCCESS 1[0m in 0.59s]
[0m17:51:38.378506 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_churn
[0m17:51:38.465696 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435c9198-3a63-4380-9b79-258224a782eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D924C2210>]}
[0m17:51:38.466698 [info ] [Thread-4 (]: 10 of 10 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.81s]
[0m17:51:38.467698 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.product_rank
[0m17:51:38.469697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:38.470695 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:51:38.470695 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m17:51:38.471697 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m17:51:38.471697 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m17:51:38.472699 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m17:51:38.472699 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_churn' was properly closed.
[0m17:51:38.473699 [debug] [MainThread]: Connection 'model.data_engineering_project.new_logos' was properly closed.
[0m17:51:38.474129 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m17:51:38.474129 [info ] [MainThread]: 
[0m17:51:38.475422 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m17:51:38.478422 [debug] [MainThread]: Command end result
[0m17:51:38.495561 [info ] [MainThread]: 
[0m17:51:38.497222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:38.499222 [info ] [MainThread]: 
[0m17:51:38.500226 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:51:38.503219 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:38.502219 after 5.35 seconds
[0m17:51:38.504032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D9141F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D8FFD2E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D91672390>]}
[0m17:51:38.504032 [debug] [MainThread]: Flushing usage events
[0m18:25:26.576982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6C295C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6C297230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6C294C80>]}


============================== 18:25:26.593061 | 046c8b94-b143-4310-82cb-f5b7a4199960 ==============================
[0m18:25:26.593061 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:25:26.593061 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:25:30.345131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6C5CE240>]}
[0m18:25:30.474250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6C92F7D0>]}
[0m18:25:30.484935 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:25:30.513464 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:25:32.375329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:25:32.375329 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\nrr.sql
[0m18:25:32.572253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CA22030>]}
[0m18:25:32.609580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CB6BB90>]}
[0m18:25:32.610614 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:25:32.611580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6AC77290>]}
[0m18:25:32.614615 [info ] [MainThread]: 
[0m18:25:32.615582 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:25:32.620006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:25:32.629308 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:25:32.643934 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:25:32.648407 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:25:32.649418 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:25:32.650061 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:25:32.652070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:32.652070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:33.968599 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:25:33.968599 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:25:33.968599 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:25:33.984730 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:25:34.080183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m18:25:34.080183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m18:25:34.105532 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m18:25:34.108275 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m18:25:34.108275 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m18:25:34.111782 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m18:25:34.111782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:34.111782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:34.550295 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:25:34.558392 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m18:25:34.568292 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:25:34.568292 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m18:25:34.663368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CDD6B40>]}
[0m18:25:34.663368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:25:34.663368 [info ] [MainThread]: 
[0m18:25:34.663368 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m18:25:34.663368 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m18:25:34.663368 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m18:25:34.663368 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m18:25:34.663368 [info ] [Thread-1 (]: 1 of 11 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m18:25:34.663368 [info ] [Thread-2 (]: 2 of 11 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m18:25:34.680264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m18:25:34.681265 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m18:25:34.663368 [info ] [Thread-3 (]: 3 of 11 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m18:25:34.682261 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m18:25:34.678558 [info ] [Thread-4 (]: 4 of 11 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m18:25:34.683265 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m18:25:34.684938 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m18:25:34.686934 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m18:25:34.688914 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m18:25:34.705387 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m18:25:34.705387 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m18:25:34.705387 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m18:25:34.712145 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m18:25:34.722080 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m18:25:34.723074 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 18:25:34.685934 => 18:25:34.723074
[0m18:25:34.724071 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m18:25:34.725072 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 18:25:34.698650 => 18:25:34.725072
[0m18:25:34.772071 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m18:25:34.773071 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m18:25:34.774073 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 18:25:34.705387 => 18:25:34.773071
[0m18:25:34.774073 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 18:25:34.712145 => 18:25:34.774073
[0m18:25:34.829018 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m18:25:34.832822 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m18:25:34.832822 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m18:25:34.832822 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m18:25:34.832822 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m18:25:34.832822 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m18:25:34.832822 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m18:25:34.848555 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m18:25:34.848555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:34.850566 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m18:25:34.850566 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m18:25:34.850566 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m18:25:34.850566 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m18:25:34.850566 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:25:34.850566 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:25:34.850566 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m18:25:34.850566 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:25:35.311212 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:35.351125 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 18:25:34.832822 => 18:25:35.351125
[0m18:25:35.351125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:25:35.351125 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m18:25:35.351125 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:25:35.351125 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 18:25:34.726075 => 18:25:35.351125
[0m18:25:35.362855 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 18:25:34.775071 => 18:25:35.351125
[0m18:25:35.362855 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m18:25:35.362855 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m18:25:35.411003 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:25:35.411003 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 18:25:34.832822 => 18:25:35.411003
[0m18:25:35.411003 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m18:25:35.442690 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CF9C3E0>]}
[0m18:25:35.442690 [info ] [Thread-4 (]: 4 of 11 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.76s]
[0m18:25:35.442690 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m18:25:35.451417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CF9CD40>]}
[0m18:25:35.451417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CF9FE90>]}
[0m18:25:35.458704 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.77s]
[0m18:25:35.458704 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m18:25:35.458704 [info ] [Thread-2 (]: 2 of 11 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.77s]
[0m18:25:35.461339 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m18:25:35.511639 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CF9E2A0>]}
[0m18:25:35.511639 [info ] [Thread-3 (]: 3 of 11 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.83s]
[0m18:25:35.511639 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m18:25:35.518620 [debug] [Thread-4 (]: Began running node model.data_engineering_project.cross_sell
[0m18:25:35.520641 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m18:25:35.520641 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_rank
[0m18:25:35.520641 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m18:25:35.520641 [info ] [Thread-4 (]: 5 of 11 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m18:25:35.520641 [info ] [Thread-1 (]: 6 of 11 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m18:25:35.527506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.cross_sell)
[0m18:25:35.529339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m18:25:35.526437 [info ] [Thread-2 (]: 7 of 11 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m18:25:35.530622 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.cross_sell
[0m18:25:35.530622 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m18:25:35.526437 [info ] [Thread-3 (]: 8 of 11 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m18:25:35.531930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_rank)
[0m18:25:35.539387 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m18:25:35.543406 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m18:25:35.543406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m18:25:35.545412 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_rank
[0m18:25:35.545412 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m18:25:35.552063 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m18:25:35.556124 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m18:25:35.556124 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 18:25:35.539387 => 18:25:35.556124
[0m18:25:35.556124 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (compile): 18:25:35.531930 => 18:25:35.556124
[0m18:25:35.560288 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m18:25:35.560288 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.cross_sell
[0m18:25:35.560288 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (compile): 18:25:35.545412 => 18:25:35.560288
[0m18:25:35.569249 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 18:25:35.552063 => 18:25:35.568197
[0m18:25:35.572284 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m18:25:35.577246 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m18:25:35.578246 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_rank
[0m18:25:35.579123 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m18:25:35.584562 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m18:25:35.590283 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m18:25:35.590283 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m18:25:35.590283 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m18:25:35.590283 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m18:25:35.590283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:35.590283 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
LIMIT 10
  );
[0m18:25:35.590283 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m18:25:35.590283 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:25:35.602305 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m18:25:35.602305 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m18:25:35.605269 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m18:25:35.608302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:35.609303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:25:36.056607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:36.056607 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 18:25:35.560288 => 18:25:36.056607
[0m18:25:36.056607 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m18:25:36.072735 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:36.072735 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 18:25:35.586264 => 18:25:36.072735
[0m18:25:36.072735 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m18:25:36.104868 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:25:36.104868 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (execute): 18:25:35.573283 => 18:25:36.104868
[0m18:25:36.104868 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: Close
[0m18:25:36.139073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CF9F830>]}
[0m18:25:36.139073 [info ] [Thread-1 (]: 6 of 11 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.61s]
[0m18:25:36.139073 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m18:25:36.139073 [debug] [Thread-1 (]: Began running node model.data_engineering_project.nrr
[0m18:25:36.139073 [info ] [Thread-1 (]: 9 of 11 START sql view model DESCHEMA_reporting.nrr ............................ [RUN]
[0m18:25:36.152460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.nrr)
[0m18:25:36.152460 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.nrr
[0m18:25:36.152460 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.nrr"
[0m18:25:36.152460 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:25:36.152460 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (execute): 18:25:35.579123 => 18:25:36.152460
[0m18:25:36.152460 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: Close
[0m18:25:36.168413 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.nrr (compile): 18:25:36.152460 => 18:25:36.168413
[0m18:25:36.170423 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.nrr
[0m18:25:36.174834 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.nrr"
[0m18:25:36.176930 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CAF1550>]}
[0m18:25:36.177896 [info ] [Thread-3 (]: 8 of 11 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.63s]
[0m18:25:36.178822 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m18:25:36.178822 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_churn
[0m18:25:36.178822 [info ] [Thread-3 (]: 10 of 11 START sql view model DESCHEMA_reporting.product_churn ................. [RUN]
[0m18:25:36.185585 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.nrr"
[0m18:25:36.187599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.product_churn)
[0m18:25:36.188594 [debug] [Thread-1 (]: On model.data_engineering_project.nrr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.nrr"} */
create or replace   view NEWDB.DESCHEMA_reporting.nrr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month >= DATEADD(MONTH, -3, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue + expansion_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:25:36.190582 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_churn
[0m18:25:36.190582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:36.193496 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m18:25:36.199980 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CF9E0C0>]}
[0m18:25:36.201947 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (compile): 18:25:36.191583 => 18:25:36.201947
[0m18:25:36.200946 [info ] [Thread-4 (]: 5 of 11 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.67s]
[0m18:25:36.202950 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_churn
[0m18:25:36.205948 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.cross_sell
[0m18:25:36.210347 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m18:25:36.212480 [debug] [Thread-4 (]: Began running node model.data_engineering_project.product_rank
[0m18:25:36.213224 [info ] [Thread-4 (]: 11 of 11 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m18:25:36.215182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.product_rank)
[0m18:25:36.215182 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.product_rank
[0m18:25:36.220501 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m18:25:36.224497 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m18:25:36.224497 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m18:25:36.225497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:25:36.226498 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (compile): 18:25:36.215182 => 18:25:36.226498
[0m18:25:36.227500 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.product_rank
[0m18:25:36.236265 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m18:25:36.244383 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m18:25:36.245419 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m18:25:36.246418 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:25:36.293768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6E0528D0>]}
[0m18:25:36.295734 [info ] [Thread-2 (]: 7 of 11 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.76s]
[0m18:25:36.296722 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_rank
[0m18:25:36.653119 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:36.658349 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (execute): 18:25:36.206981 => 18:25:36.654870
[0m18:25:36.658349 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: Close
[0m18:25:36.734045 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00a7-0001-429b-0008-4d960002332e
[0m18:25:36.734045 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'TOTAL_REVENUE'
[0m18:25:36.734045 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.nrr (execute): 18:25:36.170423 => 18:25:36.734045
[0m18:25:36.734045 [debug] [Thread-1 (]: On model.data_engineering_project.nrr: Close
[0m18:25:36.740322 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:36.740322 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.product_rank (execute): 18:25:36.227500 => 18:25:36.740322
[0m18:25:36.740322 [debug] [Thread-4 (]: On model.data_engineering_project.product_rank: Close
[0m18:25:36.740322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6E051AC0>]}
[0m18:25:36.740322 [info ] [Thread-3 (]: 10 of 11 OK created sql view model DESCHEMA_reporting.product_churn ............ [[32mSUCCESS 1[0m in 0.55s]
[0m18:25:36.749832 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_churn
[0m18:25:36.833067 [debug] [Thread-1 (]: Database Error in model nrr (models\reporting\nrr.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'TOTAL_REVENUE'
  compiled Code at target\run\data_engineering_project\models\reporting\nrr.sql
[0m18:25:36.834067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CB13B60>]}
[0m18:25:36.835066 [error] [Thread-1 (]: 9 of 11 ERROR creating sql view model DESCHEMA_reporting.nrr ................... [[31mERROR[0m in 0.68s]
[0m18:25:36.837067 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.nrr
[0m18:25:36.840087 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c8b94-b143-4310-82cb-f5b7a4199960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6E053A10>]}
[0m18:25:36.841111 [info ] [Thread-4 (]: 11 of 11 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.62s]
[0m18:25:36.843052 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.product_rank
[0m18:25:36.846083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:36.846998 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:25:36.848107 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:25:36.848107 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m18:25:36.849107 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m18:25:36.849107 [debug] [MainThread]: Connection 'model.data_engineering_project.nrr' was properly closed.
[0m18:25:36.849107 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m18:25:36.850142 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m18:25:36.850142 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m18:25:36.851142 [info ] [MainThread]: 
[0m18:25:36.853158 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m18:25:36.856170 [debug] [MainThread]: Command end result
[0m18:25:36.871168 [info ] [MainThread]: 
[0m18:25:36.873171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:36.875169 [info ] [MainThread]: 
[0m18:25:36.876173 [error] [MainThread]:   Database Error in model nrr (models\reporting\nrr.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'TOTAL_REVENUE'
  compiled Code at target\run\data_engineering_project\models\reporting\nrr.sql
[0m18:25:36.877169 [info ] [MainThread]: 
[0m18:25:36.878167 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m18:25:36.880171 [debug] [MainThread]: Command `dbt run` failed at 18:25:36.880171 after 10.43 seconds
[0m18:25:36.881206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6ABF2E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6CC26270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B6AC46A20>]}
[0m18:25:36.882203 [debug] [MainThread]: Flushing usage events
[0m18:26:52.443185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4061DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4061AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B40617C0>]}


============================== 18:26:52.460893 | f2a8898d-3077-4bf7-9678-fdc9818dfb3f ==============================
[0m18:26:52.460893 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:26:52.460893 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:26:53.006109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B473D0D0>]}
[0m18:26:53.121623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B46A7050>]}
[0m18:26:53.121623 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:26:53.121623 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:26:53.281199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:53.281199 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\nrr.sql
[0m18:26:53.477313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4BEBDA0>]}
[0m18:26:53.492293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4968200>]}
[0m18:26:53.492293 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:26:53.492293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B44FDFA0>]}
[0m18:26:53.496980 [info ] [MainThread]: 
[0m18:26:53.498747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:26:53.500780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:26:53.513359 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:26:53.525848 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:26:53.526848 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:26:53.526848 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:26:53.527848 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:26:53.529850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:53.527848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:54.552549 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:26:54.567306 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:26:54.569314 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:26:54.571324 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:26:54.670298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m18:26:54.674325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m18:26:54.685486 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m18:26:54.699927 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m18:26:54.699927 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m18:26:54.699927 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m18:26:54.699927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:54.699927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:55.015495 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:26:55.015495 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m18:26:55.160521 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:26:55.160521 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m18:26:55.259650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4BA1730>]}
[0m18:26:55.260684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:55.261651 [info ] [MainThread]: 
[0m18:26:55.267252 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m18:26:55.268250 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m18:26:55.269249 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m18:26:55.269249 [info ] [Thread-1 (]: 1 of 11 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m18:26:55.270250 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m18:26:55.271258 [info ] [Thread-2 (]: 2 of 11 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m18:26:55.273259 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m18:26:55.272258 [info ] [Thread-3 (]: 3 of 11 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m18:26:55.275259 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m18:26:55.276259 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m18:26:55.274260 [info ] [Thread-4 (]: 4 of 11 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m18:26:55.277260 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m18:26:55.278260 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m18:26:55.281260 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m18:26:55.289778 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m18:26:55.293779 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m18:26:55.299780 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m18:26:55.300778 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m18:26:55.307781 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m18:26:55.314474 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m18:26:55.316468 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 18:26:55.294784 => 18:26:55.316468
[0m18:26:55.317469 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m18:26:55.340360 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 18:26:55.279258 => 18:26:55.340360
[0m18:26:55.341325 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 18:26:55.309420 => 18:26:55.341325
[0m18:26:55.421005 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m18:26:55.440963 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 18:26:55.300778 => 18:26:55.440963
[0m18:26:55.447455 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m18:26:55.446107 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m18:26:55.453344 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m18:26:55.454345 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m18:26:55.460104 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m18:26:55.466943 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m18:26:55.468940 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m18:26:55.469943 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m18:26:55.471952 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m18:26:55.474185 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m18:26:55.482400 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m18:26:55.483430 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m18:26:55.484430 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m18:26:55.484430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:26:55.479182 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m18:26:55.485941 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:26:55.485941 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:26:55.486951 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:55.916575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:26:55.982930 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:26:56.033069 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 18:26:55.455343 => 18:26:56.033069
[0m18:26:56.049139 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m18:26:56.056707 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 18:26:55.449158 => 18:26:56.049139
[0m18:26:56.056707 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m18:26:56.056707 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:56.064879 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:56.066433 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 18:26:55.318468 => 18:26:56.066433
[0m18:26:56.083210 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 18:26:55.461099 => 18:26:56.083210
[0m18:26:56.083210 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m18:26:56.086517 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m18:26:56.186611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DD0470>]}
[0m18:26:56.186611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DD2E40>]}
[0m18:26:56.186611 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DD2E10>]}
[0m18:26:56.186611 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DD0260>]}
[0m18:26:56.186611 [info ] [Thread-2 (]: 2 of 11 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.91s]
[0m18:26:56.186611 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.91s]
[0m18:26:56.200865 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m18:26:56.198854 [info ] [Thread-3 (]: 3 of 11 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.91s]
[0m18:26:56.200865 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m18:26:56.198854 [info ] [Thread-4 (]: 4 of 11 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.91s]
[0m18:26:56.200865 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m18:26:56.200865 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m18:26:56.208419 [debug] [Thread-4 (]: Began running node model.data_engineering_project.cross_sell
[0m18:26:56.208419 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_churn
[0m18:26:56.208419 [info ] [Thread-4 (]: 5 of 11 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m18:26:56.211547 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_rank
[0m18:26:56.213559 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m18:26:56.214587 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.cross_sell)
[0m18:26:56.212559 [info ] [Thread-2 (]: 6 of 11 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m18:26:56.217562 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.cross_sell
[0m18:26:56.219563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_churn)
[0m18:26:56.216562 [info ] [Thread-1 (]: 7 of 11 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m18:26:56.224564 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m18:26:56.225402 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_churn
[0m18:26:56.227427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_rank)
[0m18:26:56.234519 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m18:26:56.235519 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_rank
[0m18:26:56.216562 [info ] [Thread-3 (]: 8 of 11 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m18:26:56.240522 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m18:26:56.241519 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (compile): 18:26:56.219563 => 18:26:56.241519
[0m18:26:56.243519 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m18:26:56.244341 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.cross_sell
[0m18:26:56.244341 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m18:26:56.246368 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (compile): 18:26:56.229439 => 18:26:56.246368
[0m18:26:56.255195 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m18:26:56.259876 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m18:26:56.259876 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (compile): 18:26:56.235519 => 18:26:56.259876
[0m18:26:56.262368 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_churn
[0m18:26:56.262368 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_rank
[0m18:26:56.268380 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m18:26:56.273385 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m18:26:56.275535 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 18:26:56.255195 => 18:26:56.275535
[0m18:26:56.277544 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m18:26:56.277544 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m18:26:56.284523 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m18:26:56.285525 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
LIMIT 10
  );
[0m18:26:56.286673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:26:56.288690 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m18:26:56.288690 [debug] [Thread-2 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m18:26:56.292346 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m18:26:56.292346 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m18:26:56.294354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:56.296362 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m18:26:56.296362 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m18:26:56.298210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:26:56.299223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:56.761075 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:26:56.761075 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 18:26:56.279553 => 18:26:56.761075
[0m18:26:56.761075 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m18:26:56.792525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:26:56.796542 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (execute): 18:26:56.269379 => 18:26:56.796542
[0m18:26:56.796542 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: Close
[0m18:26:56.802571 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:56.802571 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (execute): 18:26:56.263377 => 18:26:56.802571
[0m18:26:56.802571 [debug] [Thread-2 (]: On model.data_engineering_project.customer_churn: Close
[0m18:26:56.840395 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:56.850041 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (execute): 18:26:56.246368 => 18:26:56.850041
[0m18:26:56.851053 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: Close
[0m18:26:56.857052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DD2E40>]}
[0m18:26:56.858048 [info ] [Thread-3 (]: 8 of 11 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.61s]
[0m18:26:56.860049 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m18:26:56.861050 [debug] [Thread-3 (]: Began running node model.data_engineering_project.nrr
[0m18:26:56.861050 [info ] [Thread-3 (]: 9 of 11 START sql view model DESCHEMA_reporting.nrr ............................ [RUN]
[0m18:26:56.863051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.nrr)
[0m18:26:56.863051 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.nrr
[0m18:26:56.867896 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.nrr"
[0m18:26:56.868899 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.nrr (compile): 18:26:56.864048 => 18:26:56.868899
[0m18:26:56.869895 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.nrr
[0m18:26:56.874909 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.nrr"
[0m18:26:56.877906 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.nrr"
[0m18:26:56.878903 [debug] [Thread-3 (]: On model.data_engineering_project.nrr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.nrr"} */
create or replace   view NEWDB.DESCHEMA_reporting.nrr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month >= DATEADD(MONTH, -3, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue + expansion_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:26:56.879903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:26:56.884322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DF9070>]}
[0m18:26:56.886331 [info ] [Thread-1 (]: 7 of 11 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.66s]
[0m18:26:56.887339 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_rank
[0m18:26:56.887339 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_churn
[0m18:26:56.889350 [info ] [Thread-1 (]: 10 of 11 START sql view model DESCHEMA_reporting.product_churn ................. [RUN]
[0m18:26:56.890710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_rank, now model.data_engineering_project.product_churn)
[0m18:26:56.891718 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_churn
[0m18:26:56.895717 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m18:26:56.899825 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (compile): 18:26:56.892719 => 18:26:56.898810
[0m18:26:56.900819 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_churn
[0m18:26:56.905820 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m18:26:56.910975 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m18:26:56.910975 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m18:26:56.912984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:56.915170 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4DD2E70>]}
[0m18:26:56.917200 [info ] [Thread-2 (]: 6 of 11 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.70s]
[0m18:26:56.920172 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_churn
[0m18:26:56.920172 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_rank
[0m18:26:56.921168 [info ] [Thread-2 (]: 11 of 11 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m18:26:56.927181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_rank)
[0m18:26:56.928180 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_rank
[0m18:26:56.935163 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m18:26:56.939987 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (compile): 18:26:56.929181 => 18:26:56.937976
[0m18:26:56.939987 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_rank
[0m18:26:56.944623 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m18:26:56.947625 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m18:26:56.947625 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m18:26:56.948820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:56.957243 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4E09BE0>]}
[0m18:26:56.957243 [info ] [Thread-4 (]: 5 of 11 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.74s]
[0m18:26:56.959251 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.cross_sell
[0m18:26:57.479564 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:57.482872 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (execute): 18:26:56.939987 => 18:26:57.482872
[0m18:26:57.482872 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: Close
[0m18:26:57.502358 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:57.502358 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.nrr (execute): 18:26:56.869895 => 18:26:57.502358
[0m18:26:57.502358 [debug] [Thread-3 (]: On model.data_engineering_project.nrr: Close
[0m18:26:57.542948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:26:57.542948 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_churn (execute): 18:26:56.900819 => 18:26:57.542948
[0m18:26:57.542948 [debug] [Thread-1 (]: On model.data_engineering_project.product_churn: Close
[0m18:26:57.558746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B2240770>]}
[0m18:26:57.558746 [info ] [Thread-2 (]: 11 of 11 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.63s]
[0m18:26:57.558746 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_rank
[0m18:26:57.602560 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4ACC500>]}
[0m18:26:57.602560 [info ] [Thread-3 (]: 9 of 11 OK created sql view model DESCHEMA_reporting.nrr ....................... [[32mSUCCESS 1[0m in 0.74s]
[0m18:26:57.604560 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.nrr
[0m18:26:57.641366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a8898d-3077-4bf7-9678-fdc9818dfb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4ACCFE0>]}
[0m18:26:57.650888 [info ] [Thread-1 (]: 10 of 11 OK created sql view model DESCHEMA_reporting.product_churn ............ [[32mSUCCESS 1[0m in 0.75s]
[0m18:26:57.652832 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_churn
[0m18:26:57.652832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'model.data_engineering_project.nrr' was properly closed.
[0m18:26:57.652832 [debug] [MainThread]: Connection 'model.data_engineering_project.cross_sell' was properly closed.
[0m18:26:57.666362 [info ] [MainThread]: 
[0m18:26:57.668374 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m18:26:57.673427 [debug] [MainThread]: Command end result
[0m18:26:57.688754 [info ] [MainThread]: 
[0m18:26:57.688754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:57.688754 [info ] [MainThread]: 
[0m18:26:57.688754 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:26:57.695537 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:57.695537 after 5.32 seconds
[0m18:26:57.695537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4060230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4061AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4061DC0>]}
[0m18:26:57.696537 [debug] [MainThread]: Flushing usage events
[0m18:28:48.032766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594895460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594896240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594894E30>]}


============================== 18:28:48.040997 | 20981e0a-722f-4952-8243-35ab8159841d ==============================
[0m18:28:48.040997 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:28:48.042790 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:28:48.631077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594FBE870>]}
[0m18:28:48.758537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001959448A270>]}
[0m18:28:48.760594 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:28:48.771581 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:28:48.924288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:48.925288 [debug] [MainThread]: Partial parsing: updated file: data_engineering_project://models\reporting\nrr.sql
[0m18:28:49.120635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195952CE840>]}
[0m18:28:49.135851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195951141D0>]}
[0m18:28:49.136852 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:28:49.137854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594F82F60>]}
[0m18:28:49.140883 [info ] [MainThread]: 
[0m18:28:49.142435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:28:49.145638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:28:49.162559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:28:49.169244 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:28:49.175368 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:28:49.176335 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:28:49.177335 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:28:49.177335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:49.178338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:50.266788 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:28:50.268793 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:28:50.280592 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:28:50.300287 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:28:50.409749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m18:28:50.425839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m18:28:50.425839 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m18:28:50.425839 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m18:28:50.425839 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m18:28:50.425839 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m18:28:50.425839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:50.425839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:50.762099 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m18:28:50.765108 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m18:28:50.878403 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:28:50.880413 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m18:28:50.975668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594F2F470>]}
[0m18:28:50.975668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:28:50.975668 [info ] [MainThread]: 
[0m18:28:50.975668 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m18:28:50.975668 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m18:28:50.975668 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m18:28:50.975668 [info ] [Thread-1 (]: 1 of 11 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m18:28:50.975668 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m18:28:50.975668 [info ] [Thread-2 (]: 2 of 11 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m18:28:50.991926 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m18:28:50.975668 [info ] [Thread-3 (]: 3 of 11 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m18:28:50.993926 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m18:28:50.992927 [info ] [Thread-4 (]: 4 of 11 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m18:28:50.994969 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m18:28:50.995835 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m18:28:50.995835 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m18:28:50.999053 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m18:28:51.009565 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m18:28:51.009565 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m18:28:51.015105 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m18:28:51.017114 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m18:28:51.020261 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m18:28:51.020261 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m18:28:51.020261 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 18:28:50.999053 => 18:28:51.020261
[0m18:28:51.020261 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m18:28:51.129089 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m18:28:51.130097 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 18:28:51.010565 => 18:28:51.130097
[0m18:28:51.130097 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 18:28:51.020261 => 18:28:51.130097
[0m18:28:51.130097 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m18:28:51.130097 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m18:28:51.130097 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 18:28:51.017114 => 18:28:51.130097
[0m18:28:51.130097 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m18:28:51.130097 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m18:28:51.130097 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m18:28:51.130097 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m18:28:51.130097 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m18:28:51.145868 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m18:28:51.145868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:51.145868 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m18:28:51.145868 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m18:28:51.145868 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m18:28:51.145868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:28:51.145868 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m18:28:51.145868 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m18:28:51.145868 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:28:51.145868 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m18:28:51.161670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:28:51.580850 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:51.596750 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 18:28:51.130097 => 18:28:51.596750
[0m18:28:51.612791 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m18:28:51.612791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:51.612791 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 18:28:51.020261 => 18:28:51.612791
[0m18:28:51.612791 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m18:28:51.612791 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:51.628833 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 18:28:51.130097 => 18:28:51.628833
[0m18:28:51.628833 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m18:28:51.693022 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955F5130>]}
[0m18:28:51.693022 [info ] [Thread-2 (]: 2 of 11 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.70s]
[0m18:28:51.693022 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m18:28:51.708757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195954AB3B0>]}
[0m18:28:51.708757 [info ] [Thread-1 (]: 1 of 11 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.72s]
[0m18:28:51.708757 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m18:28:51.717293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019595602870>]}
[0m18:28:51.718391 [info ] [Thread-4 (]: 4 of 11 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.72s]
[0m18:28:51.720355 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m18:28:51.721010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:28:51.721010 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 18:28:51.144861 => 18:28:51.721010
[0m18:28:51.721010 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m18:28:51.822216 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955F6600>]}
[0m18:28:51.823217 [info ] [Thread-3 (]: 3 of 11 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.83s]
[0m18:28:51.824219 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m18:28:51.825218 [debug] [Thread-2 (]: Began running node model.data_engineering_project.cross_sell
[0m18:28:51.827219 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m18:28:51.826219 [info ] [Thread-2 (]: 5 of 11 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m18:28:51.828215 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_rank
[0m18:28:51.829216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.cross_sell)
[0m18:28:51.830145 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m18:28:51.827219 [info ] [Thread-1 (]: 6 of 11 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m18:28:51.831208 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.cross_sell
[0m18:28:51.831208 [info ] [Thread-4 (]: 7 of 11 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m18:28:51.833573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m18:28:51.838575 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m18:28:51.832573 [info ] [Thread-3 (]: 8 of 11 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m18:28:51.839604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.customer_rank)
[0m18:28:51.840575 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m18:28:51.841574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.new_logos)
[0m18:28:51.842576 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_rank
[0m18:28:51.846827 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m18:28:51.847839 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m18:28:51.852124 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m18:28:51.854732 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (compile): 18:28:51.834574 => 18:28:51.854009
[0m18:28:51.863299 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m18:28:51.865327 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.cross_sell
[0m18:28:51.871308 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m18:28:51.872307 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 18:28:51.842576 => 18:28:51.871308
[0m18:28:51.873311 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m18:28:51.883307 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m18:28:51.884308 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (compile): 18:28:51.847839 => 18:28:51.884308
[0m18:28:51.885307 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_rank
[0m18:28:51.886307 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 18:28:51.854732 => 18:28:51.885307
[0m18:28:51.888310 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m18:28:51.893308 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m18:28:51.895308 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m18:28:51.895308 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m18:28:51.896309 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
LIMIT 10
  );
[0m18:28:51.897308 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m18:28:51.899248 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m18:28:51.899248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:28:51.899248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:51.899248 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m18:28:51.899248 [debug] [Thread-4 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m18:28:51.899248 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:28:51.913347 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m18:28:51.914611 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m18:28:51.915601 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:28:52.335782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:52.350209 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 18:28:51.874311 => 18:28:52.349212
[0m18:28:52.350209 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m18:28:52.355208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:52.359208 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 18:28:51.898342 => 18:28:52.358208
[0m18:28:52.359208 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m18:28:52.378402 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:52.381396 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (execute): 18:28:51.866311 => 18:28:52.381396
[0m18:28:52.382396 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: Close
[0m18:28:52.387397 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:52.391399 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (execute): 18:28:51.889307 => 18:28:52.391399
[0m18:28:52.392396 [debug] [Thread-4 (]: On model.data_engineering_project.customer_rank: Close
[0m18:28:52.445746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955D3170>]}
[0m18:28:52.447252 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955DC710>]}
[0m18:28:52.448261 [info ] [Thread-1 (]: 6 of 11 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.61s]
[0m18:28:52.448261 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m18:28:52.448261 [info ] [Thread-3 (]: 8 of 11 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.61s]
[0m18:28:52.448261 [debug] [Thread-1 (]: Began running node model.data_engineering_project.nrr
[0m18:28:52.448261 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m18:28:52.448261 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_churn
[0m18:28:52.448261 [info ] [Thread-1 (]: 9 of 11 START sql view model DESCHEMA_reporting.nrr ............................ [RUN]
[0m18:28:52.448261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.nrr)
[0m18:28:52.448261 [info ] [Thread-3 (]: 10 of 11 START sql view model DESCHEMA_reporting.product_churn ................. [RUN]
[0m18:28:52.448261 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.nrr
[0m18:28:52.457606 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.product_churn)
[0m18:28:52.461049 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.nrr"
[0m18:28:52.462050 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_churn
[0m18:28:52.466600 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m18:28:52.470772 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (compile): 18:28:52.462553 => 18:28:52.470772
[0m18:28:52.472785 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955F79B0>]}
[0m18:28:52.474076 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.nrr (compile): 18:28:52.458041 => 18:28:52.474076
[0m18:28:52.475074 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_churn
[0m18:28:52.476072 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.nrr
[0m18:28:52.475074 [info ] [Thread-2 (]: 5 of 11 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.64s]
[0m18:28:52.483104 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m18:28:52.488820 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.nrr"
[0m18:28:52.489830 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.cross_sell
[0m18:28:52.490832 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195953A37D0>]}
[0m18:28:52.491832 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_rank
[0m18:28:52.492830 [info ] [Thread-4 (]: 7 of 11 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.65s]
[0m18:28:52.497246 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m18:28:52.498113 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_rank
[0m18:28:52.493830 [info ] [Thread-2 (]: 11 of 11 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m18:28:52.500123 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m18:28:52.504147 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.nrr"
[0m18:28:52.504147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.product_rank)
[0m18:28:52.506156 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:28:52.506156 [debug] [Thread-1 (]: On model.data_engineering_project.nrr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.nrr"} */
create or replace   view NEWDB.DESCHEMA_reporting.nrr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month <= DATEADD(MONTH, -12, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue + expansion_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:28:52.507920 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_rank
[0m18:28:52.508929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:52.512938 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m18:28:52.518570 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (compile): 18:28:52.508929 => 18:28:52.518570
[0m18:28:52.521570 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_rank
[0m18:28:52.521570 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m18:28:52.530590 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m18:28:52.531228 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m18:28:52.533240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:28:52.976650 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:52.986749 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (execute): 18:28:52.477076 => 18:28:52.986749
[0m18:28:52.988769 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: Close
[0m18:28:52.996568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:52.996568 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.nrr (execute): 18:28:52.483104 => 18:28:52.996568
[0m18:28:52.996568 [debug] [Thread-1 (]: On model.data_engineering_project.nrr: Close
[0m18:28:53.016902 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:28:53.022386 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (execute): 18:28:52.521570 => 18:28:53.022386
[0m18:28:53.024396 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: Close
[0m18:28:53.065628 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955DC710>]}
[0m18:28:53.065628 [info ] [Thread-3 (]: 10 of 11 OK created sql view model DESCHEMA_reporting.product_churn ............ [[32mSUCCESS 1[0m in 0.62s]
[0m18:28:53.065628 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_churn
[0m18:28:53.099560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195955DDAC0>]}
[0m18:28:53.100950 [info ] [Thread-1 (]: 9 of 11 OK created sql view model DESCHEMA_reporting.nrr ....................... [[32mSUCCESS 1[0m in 0.65s]
[0m18:28:53.102200 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.nrr
[0m18:28:53.105004 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20981e0a-722f-4952-8243-35ab8159841d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195952B3890>]}
[0m18:28:53.106115 [info ] [Thread-2 (]: 11 of 11 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.60s]
[0m18:28:53.106115 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_rank
[0m18:28:53.110322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:53.111365 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:28:53.111365 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:28:53.112365 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m18:28:53.112365 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m18:28:53.113366 [debug] [MainThread]: Connection 'model.data_engineering_project.nrr' was properly closed.
[0m18:28:53.113366 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m18:28:53.113366 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m18:28:53.114365 [debug] [MainThread]: Connection 'model.data_engineering_project.customer_rank' was properly closed.
[0m18:28:53.115338 [info ] [MainThread]: 
[0m18:28:53.116330 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m18:28:53.120531 [debug] [MainThread]: Command end result
[0m18:28:53.135989 [info ] [MainThread]: 
[0m18:28:53.137999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:53.137999 [info ] [MainThread]: 
[0m18:28:53.140009 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:28:53.141669 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:53.141669 after 5.19 seconds
[0m18:28:53.142677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019595236360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594FF79E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019594592B70>]}
[0m18:28:53.142677 [debug] [MainThread]: Flushing usage events
[0m18:30:36.117041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E845D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E845D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E845F6B0>]}


============================== 18:30:36.137010 | cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa ==============================
[0m18:30:36.137010 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:30:36.137010 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:30:38.123788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8BF7950>]}
[0m18:30:38.250825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8494B30>]}
[0m18:30:38.250825 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:30:38.287411 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:30:39.915129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:30:39.915129 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\grr.sql
[0m18:30:40.114587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8C55C10>]}
[0m18:30:40.133546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8DB8AD0>]}
[0m18:30:40.133546 [info ] [MainThread]: Found 12 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:30:40.133546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E84BDFA0>]}
[0m18:30:40.133546 [info ] [MainThread]: 
[0m18:30:40.133546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:40.149690 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:30:40.165546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:30:40.174709 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:30:40.181298 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:30:40.181298 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:30:40.181298 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:30:40.181298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:40.181298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:41.282894 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:30:41.282894 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:30:41.298586 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:30:41.298586 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:30:41.412214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m18:30:41.412214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m18:30:41.436001 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m18:30:41.440015 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m18:30:41.440015 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m18:30:41.441763 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m18:30:41.441763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:41.441763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:41.754566 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:30:41.760637 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m18:30:41.895357 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m18:30:41.899150 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m18:30:41.993334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E6D1A9C0>]}
[0m18:30:41.993334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:41.993334 [info ] [MainThread]: 
[0m18:30:41.993334 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m18:30:41.993334 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m18:30:41.993334 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m18:30:42.009270 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m18:30:41.993334 [info ] [Thread-1 (]: 1 of 12 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m18:30:42.009270 [info ] [Thread-2 (]: 2 of 12 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m18:30:42.013065 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m18:30:42.009270 [info ] [Thread-3 (]: 3 of 12 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m18:30:42.014110 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m18:30:42.014110 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m18:30:42.009270 [info ] [Thread-4 (]: 4 of 12 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m18:30:42.014110 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m18:30:42.014110 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m18:30:42.025390 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m18:30:42.025390 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m18:30:42.025390 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m18:30:42.035346 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m18:30:42.035346 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m18:30:42.045195 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m18:30:42.047239 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m18:30:42.047239 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 18:30:42.014110 => 18:30:42.047239
[0m18:30:42.047239 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m18:30:42.056856 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 18:30:42.025390 => 18:30:42.056856
[0m18:30:42.140972 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m18:30:42.156973 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m18:30:42.156973 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m18:30:42.156973 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 18:30:42.035346 => 18:30:42.156973
[0m18:30:42.156973 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 18:30:42.047239 => 18:30:42.156973
[0m18:30:42.156973 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m18:30:42.156973 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m18:30:42.172726 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m18:30:42.172726 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m18:30:42.172726 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m18:30:42.172726 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m18:30:42.172726 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m18:30:42.172726 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m18:30:42.172726 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:30:42.172726 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:30:42.172726 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m18:30:42.172726 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m18:30:42.188627 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m18:30:42.188627 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m18:30:42.188627 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:30:42.188627 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:30:42.573557 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:42.605411 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 18:30:42.156973 => 18:30:42.605411
[0m18:30:42.605411 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m18:30:42.615947 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:42.622093 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 18:30:42.172726 => 18:30:42.622093
[0m18:30:42.624242 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m18:30:42.626130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:42.631176 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 18:30:42.047239 => 18:30:42.631176
[0m18:30:42.632137 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m18:30:42.716079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E91A9A30>]}
[0m18:30:42.716079 [info ] [Thread-2 (]: 2 of 12 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.70s]
[0m18:30:42.720972 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m18:30:42.725063 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E919DEE0>]}
[0m18:30:42.725063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E91AA570>]}
[0m18:30:42.725063 [info ] [Thread-4 (]: 4 of 12 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.70s]
[0m18:30:42.725063 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m18:30:42.732421 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:30:42.725063 [info ] [Thread-1 (]: 1 of 12 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.72s]
[0m18:30:42.736981 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 18:30:42.156973 => 18:30:42.736981
[0m18:30:42.736981 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m18:30:42.736981 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m18:30:42.832283 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E91AB020>]}
[0m18:30:42.832283 [info ] [Thread-3 (]: 3 of 12 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.82s]
[0m18:30:42.832283 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m18:30:42.832283 [debug] [Thread-2 (]: Began running node model.data_engineering_project.cross_sell
[0m18:30:42.832283 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_churn
[0m18:30:42.832283 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_rank
[0m18:30:42.832283 [info ] [Thread-2 (]: 5 of 12 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m18:30:42.832283 [debug] [Thread-3 (]: Began running node model.data_engineering_project.grr
[0m18:30:42.832283 [info ] [Thread-4 (]: 6 of 12 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m18:30:42.832283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.cross_sell)
[0m18:30:42.832283 [info ] [Thread-1 (]: 7 of 12 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m18:30:42.832283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.customer_churn)
[0m18:30:42.832283 [info ] [Thread-3 (]: 8 of 12 START sql view model DESCHEMA_reporting.grr ............................ [RUN]
[0m18:30:42.832283 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.cross_sell
[0m18:30:42.848048 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_churn
[0m18:30:42.848048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_rank)
[0m18:30:42.848048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.grr)
[0m18:30:42.854126 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m18:30:42.858611 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m18:30:42.858611 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_rank
[0m18:30:42.863842 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.grr
[0m18:30:42.863842 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m18:30:42.875691 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.grr"
[0m18:30:42.879493 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (compile): 18:30:42.848048 => 18:30:42.879493
[0m18:30:42.881503 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_churn (compile): 18:30:42.856141 => 18:30:42.881503
[0m18:30:42.881503 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.cross_sell
[0m18:30:42.881503 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_churn
[0m18:30:42.884651 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.grr (compile): 18:30:42.871290 => 18:30:42.884651
[0m18:30:42.884651 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (compile): 18:30:42.863842 => 18:30:42.884651
[0m18:30:42.884651 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m18:30:42.895726 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m18:30:42.895726 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.grr
[0m18:30:42.895726 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_rank
[0m18:30:42.895726 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.grr"
[0m18:30:42.913899 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m18:30:42.918419 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m18:30:42.918419 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m18:30:42.918419 [debug] [Thread-4 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m18:30:42.918419 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
LIMIT 10
  );
[0m18:30:42.922355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:42.922355 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:42.924367 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.grr"
[0m18:30:42.927755 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m18:30:42.927755 [debug] [Thread-3 (]: On model.data_engineering_project.grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.grr"} */
create or replace   view NEWDB.DESCHEMA_reporting.grr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month <= DATEADD(MONTH, -12, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:30:42.927755 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m18:30:42.927755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:42.927755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:43.398355 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:43.398355 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_churn (execute): 18:30:42.895726 => 18:30:43.398355
[0m18:30:43.398355 [debug] [Thread-4 (]: On model.data_engineering_project.customer_churn: Close
[0m18:30:43.398355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:43.414260 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.cross_sell (execute): 18:30:42.884651 => 18:30:43.414260
[0m18:30:43.414260 [debug] [Thread-2 (]: On model.data_engineering_project.cross_sell: Close
[0m18:30:43.416771 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:43.416771 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.grr (execute): 18:30:42.895726 => 18:30:43.416771
[0m18:30:43.416771 [debug] [Thread-3 (]: On model.data_engineering_project.grr: Close
[0m18:30:43.430623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:30:43.430623 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_rank (execute): 18:30:42.895726 => 18:30:43.430623
[0m18:30:43.430623 [debug] [Thread-1 (]: On model.data_engineering_project.customer_rank: Close
[0m18:30:43.509918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8FB3D10>]}
[0m18:30:43.510934 [info ] [Thread-3 (]: 8 of 12 OK created sql view model DESCHEMA_reporting.grr ....................... [[32mSUCCESS 1[0m in 0.66s]
[0m18:30:43.516716 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.grr
[0m18:30:43.516716 [debug] [Thread-3 (]: Began running node model.data_engineering_project.new_logos
[0m18:30:43.516716 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8D18170>]}
[0m18:30:43.526681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8D1A690>]}
[0m18:30:43.516716 [info ] [Thread-3 (]: 9 of 12 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m18:30:43.526681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.grr, now model.data_engineering_project.new_logos)
[0m18:30:43.516716 [info ] [Thread-4 (]: 6 of 12 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.68s]
[0m18:30:43.526681 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.new_logos
[0m18:30:43.526681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8FB1010>]}
[0m18:30:43.526681 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_churn
[0m18:30:43.526681 [info ] [Thread-2 (]: 5 of 12 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.69s]
[0m18:30:43.547430 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m18:30:43.547430 [debug] [Thread-4 (]: Began running node model.data_engineering_project.nrr
[0m18:30:43.542638 [info ] [Thread-1 (]: 7 of 12 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.69s]
[0m18:30:43.547430 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.cross_sell
[0m18:30:43.547430 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_rank
[0m18:30:43.552863 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_churn
[0m18:30:43.547430 [info ] [Thread-4 (]: 10 of 12 START sql view model DESCHEMA_reporting.nrr ........................... [RUN]
[0m18:30:43.552863 [debug] [Thread-1 (]: Began running node model.data_engineering_project.product_rank
[0m18:30:43.554878 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (compile): 18:30:43.526681 => 18:30:43.554878
[0m18:30:43.556881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.nrr)
[0m18:30:43.556881 [info ] [Thread-2 (]: 11 of 12 START sql view model DESCHEMA_reporting.product_churn ................. [RUN]
[0m18:30:43.558655 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.new_logos
[0m18:30:43.558655 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.nrr
[0m18:30:43.558655 [info ] [Thread-1 (]: 12 of 12 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m18:30:43.558655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.product_churn)
[0m18:30:43.558655 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m18:30:43.576473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_rank, now model.data_engineering_project.product_rank)
[0m18:30:43.576473 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.nrr"
[0m18:30:43.576473 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_churn
[0m18:30:43.576473 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.product_rank
[0m18:30:43.585722 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m18:30:43.590277 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m18:30:43.597338 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m18:30:43.597338 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.nrr (compile): 18:30:43.558655 => 18:30:43.597338
[0m18:30:43.597338 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m18:30:43.597338 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.nrr
[0m18:30:43.597338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:43.597338 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_rank (compile): 18:30:43.587731 => 18:30:43.597338
[0m18:30:43.608252 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.nrr"
[0m18:30:43.608252 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_churn (compile): 18:30:43.576473 => 18:30:43.608252
[0m18:30:43.608252 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.product_rank
[0m18:30:43.616664 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_churn
[0m18:30:43.622250 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m18:30:43.622250 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.nrr"
[0m18:30:43.629225 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m18:30:43.629225 [debug] [Thread-4 (]: On model.data_engineering_project.nrr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.nrr"} */
create or replace   view NEWDB.DESCHEMA_reporting.nrr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month <= DATEADD(MONTH, -12, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue + expansion_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:30:43.629225 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:43.638027 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m18:30:43.638027 [debug] [Thread-1 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m18:30:43.640036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:43.640036 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m18:30:43.645809 [debug] [Thread-2 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m18:30:43.645809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:44.084798 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:44.088822 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.new_logos (execute): 18:30:43.558655 => 18:30:44.088822
[0m18:30:44.088822 [debug] [Thread-3 (]: On model.data_engineering_project.new_logos: Close
[0m18:30:44.092377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:30:44.092377 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_churn (execute): 18:30:43.622250 => 18:30:44.092377
[0m18:30:44.092377 [debug] [Thread-2 (]: On model.data_engineering_project.product_churn: Close
[0m18:30:44.140322 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:30:44.140322 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.nrr (execute): 18:30:43.597338 => 18:30:44.140322
[0m18:30:44.140322 [debug] [Thread-4 (]: On model.data_engineering_project.nrr: Close
[0m18:30:44.533937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:30:44.549827 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.product_rank (execute): 18:30:43.616664 => 18:30:44.549827
[0m18:30:44.549827 [debug] [Thread-1 (]: On model.data_engineering_project.product_rank: Close
[0m18:30:44.565536 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8E45F40>]}
[0m18:30:44.565536 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E906B950>]}
[0m18:30:44.565536 [info ] [Thread-3 (]: 9 of 12 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 1.04s]
[0m18:30:44.565536 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.new_logos
[0m18:30:44.565536 [info ] [Thread-4 (]: 10 of 12 OK created sql view model DESCHEMA_reporting.nrr ...................... [[32mSUCCESS 1[0m in 1.01s]
[0m18:30:44.565536 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.nrr
[0m18:30:44.620955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8FB5AC0>]}
[0m18:30:44.620955 [info ] [Thread-2 (]: 11 of 12 OK created sql view model DESCHEMA_reporting.product_churn ............ [[32mSUCCESS 1[0m in 1.06s]
[0m18:30:44.620955 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_churn
[0m18:30:44.644331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4f7c04-ef6f-4ab1-a17b-5759b2f2b6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E8C91820>]}
[0m18:30:44.644331 [info ] [Thread-1 (]: 12 of 12 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 1.07s]
[0m18:30:44.660416 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.product_rank
[0m18:30:44.660416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'model.data_engineering_project.new_logos' was properly closed.
[0m18:30:44.660416 [debug] [MainThread]: Connection 'model.data_engineering_project.nrr' was properly closed.
[0m18:30:44.660416 [info ] [MainThread]: 
[0m18:30:44.660416 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m18:30:44.676105 [debug] [MainThread]: Command end result
[0m18:30:44.701921 [info ] [MainThread]: 
[0m18:30:44.706181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:44.706181 [info ] [MainThread]: 
[0m18:30:44.707694 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m18:30:44.713746 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:44.711729 after 8.66 seconds
[0m18:30:44.715804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E845F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E845F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292E845D580>]}
[0m18:30:44.715804 [debug] [MainThread]: Flushing usage events
[0m18:41:23.707952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE115D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE115D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE115FE90>]}


============================== 18:41:23.724042 | 08de97ec-2b52-44c1-9282-f60a8faae2e4 ==============================
[0m18:41:23.724042 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:41:23.724042 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:41:26.170672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE193A000>]}
[0m18:41:26.280106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE159A4B0>]}
[0m18:41:26.290853 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:41:26.301781 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:41:26.478205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:41:26.478205 [debug] [MainThread]: Partial parsing: added file: data_engineering_project://models\reporting\revenueloss.sql
[0m18:41:26.665173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1996A80>]}
[0m18:41:26.673204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1A7B6B0>]}
[0m18:41:26.673204 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:41:26.673204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1BDF290>]}
[0m18:41:26.687044 [info ] [MainThread]: 
[0m18:41:26.687044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:26.687044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:41:26.707835 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:41:26.708836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB'
[0m18:41:26.708836 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:41:26.711930 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB"
[0m18:41:26.713402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:26.713402 [debug] [ThreadPool]: On list_NEWDB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB"} */
show terse schemas in database NEWDB
    limit 10000
[0m18:41:26.714745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:27.662414 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:41:27.662414 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:41:27.699066 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m18:41:27.699066 [debug] [ThreadPool]: On list_NEWDB: Close
[0m18:41:27.793856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m18:41:27.801346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m18:41:27.810345 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m18:41:27.813346 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m18:41:27.814348 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m18:41:27.815347 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m18:41:27.816159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:27.816159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:28.131168 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m18:41:28.131168 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m18:41:28.241573 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:41:28.241573 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m18:41:28.337215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD8DC28A0>]}
[0m18:41:28.338249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:28.339215 [info ] [MainThread]: 
[0m18:41:28.346217 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m18:41:28.347215 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m18:41:28.348215 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m18:41:28.348215 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m18:41:28.347215 [info ] [Thread-1 (]: 1 of 13 START sql view model DESCHEMA_staging.stg_country ...................... [RUN]
[0m18:41:28.349983 [info ] [Thread-2 (]: 2 of 13 START sql view model DESCHEMA_staging.stg_cust ......................... [RUN]
[0m18:41:28.353166 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m18:41:28.354167 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m18:41:28.351166 [info ] [Thread-3 (]: 3 of 13 START sql view model DESCHEMA_staging.stg_hotelbook .................... [RUN]
[0m18:41:28.355165 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m18:41:28.356164 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m18:41:28.351166 [info ] [Thread-4 (]: 4 of 13 START sql view model DESCHEMA_staging.stg_prod ......................... [RUN]
[0m18:41:28.357168 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m18:41:28.362167 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m18:41:28.373166 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m18:41:28.374166 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m18:41:28.375166 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m18:41:28.376165 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m18:41:28.378550 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m18:41:28.385994 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m18:41:28.386995 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 18:41:28.358166 => 18:41:28.385994
[0m18:41:28.388032 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 18:41:28.358166 => 18:41:28.386995
[0m18:41:28.388032 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m18:41:28.389000 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m18:41:28.481825 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.stg_cust"
[0m18:41:28.494401 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.stg_country"
[0m18:41:28.497920 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 18:41:28.376165 => 18:41:28.494401
[0m18:41:28.497920 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 18:41:28.381989 => 18:41:28.497920
[0m18:41:28.497920 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m18:41:28.497920 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m18:41:28.497920 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.stg_hotelbook"
[0m18:41:28.497920 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.stg_cust"
[0m18:41:28.497920 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.stg_prod"
[0m18:41:28.497920 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.stg_country"
[0m18:41:28.497920 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_cust"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_cust
  
   as (
    with customer as (
    select distinct
    customer_id::INTEGER as customer_id,
    customername::VARCHAR as customer_name,
    company::VARCHAR as company_name,
    from newdb.deschema.cust
    where customer_id is not null
    order by customer_id
)
select * from customer
  );
[0m18:41:28.497920 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_country"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_country
  
   as (
    with country as (
    select distinct
    customer_id::INTEGER as customer_id,
    country,
    region
    from newdb.deschema.country
    order by customer_id,country,region
)
select * from country
  );
[0m18:41:28.497920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:41:28.514005 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:28.514005 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.stg_hotelbook"
[0m18:41:28.514005 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_hotelbook"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_hotelbook
  
   as (
    with hotelbook as (
    select distinct
    customer_id,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies as company,
    dimension_1,
    dimension_2,
    dimension_3,
    dimension_4,
    dimension_5,
    dimension_6,
    dimension_7,
    dimension_8,
    dimension_9,
    dimension_10
    from newdb.deschema.hotelbook
    where customer_id is not null
    order by customer_id,payment_month,revenue 
)
select * from hotelbook
  );
[0m18:41:28.518648 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.stg_prod"
[0m18:41:28.520654 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:41:28.522659 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.stg_prod"} */
create or replace   view NEWDB.DESCHEMA_staging.stg_prod
  
   as (
    with product as (
    select distinct *
    from newdb.deschema.prod
    where product_id is not null
    order by product_id
)
select * from product
  );
[0m18:41:28.522659 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:41:28.964613 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:28.996101 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 18:41:28.497920 => 18:41:28.996101
[0m18:41:28.996101 [debug] [Thread-4 (]: On model.data_engineering_project.stg_prod: Close
[0m18:41:28.996101 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:28.996101 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 18:41:28.389000 => 18:41:28.996101
[0m18:41:28.996101 [debug] [Thread-2 (]: On model.data_engineering_project.stg_cust: Close
[0m18:41:29.011890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:29.011890 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 18:41:28.465670 => 18:41:29.011890
[0m18:41:29.011890 [debug] [Thread-1 (]: On model.data_engineering_project.stg_country: Close
[0m18:41:29.075977 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:29.091825 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 18:41:28.497920 => 18:41:29.075977
[0m18:41:29.091825 [debug] [Thread-3 (]: On model.data_engineering_project.stg_hotelbook: Close
[0m18:41:29.096474 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1F1E780>]}
[0m18:41:29.096474 [info ] [Thread-4 (]: 4 of 13 OK created sql view model DESCHEMA_staging.stg_prod .................... [[32mSUCCESS 1[0m in 0.72s]
[0m18:41:29.107664 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m18:41:29.107664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1F1EE10>]}
[0m18:41:29.107664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1F1D9A0>]}
[0m18:41:29.107664 [info ] [Thread-1 (]: 1 of 13 OK created sql view model DESCHEMA_staging.stg_country ................. [[32mSUCCESS 1[0m in 0.76s]
[0m18:41:29.107664 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m18:41:29.107664 [info ] [Thread-2 (]: 2 of 13 OK created sql view model DESCHEMA_staging.stg_cust .................... [[32mSUCCESS 1[0m in 0.75s]
[0m18:41:29.118296 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m18:41:29.196541 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1B4E840>]}
[0m18:41:29.197085 [info ] [Thread-3 (]: 3 of 13 OK created sql view model DESCHEMA_staging.stg_hotelbook ............... [[32mSUCCESS 1[0m in 0.84s]
[0m18:41:29.197975 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m18:41:29.199983 [debug] [Thread-4 (]: Began running node model.data_engineering_project.cross_sell
[0m18:41:29.200984 [debug] [Thread-1 (]: Began running node model.data_engineering_project.customer_churn
[0m18:41:29.200984 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_rank
[0m18:41:29.199983 [info ] [Thread-4 (]: 5 of 13 START sql view model DESCHEMA_reporting.cross_sell ..................... [RUN]
[0m18:41:29.200984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.cross_sell)
[0m18:41:29.200984 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.cross_sell
[0m18:41:29.209402 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m18:41:29.209402 [debug] [Thread-3 (]: Began running node model.data_engineering_project.grr
[0m18:41:29.200984 [info ] [Thread-1 (]: 6 of 13 START sql view model DESCHEMA_reporting.customer_churn ................. [RUN]
[0m18:41:29.209402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.customer_churn)
[0m18:41:29.209402 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.customer_churn
[0m18:41:29.216948 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m18:41:29.200984 [info ] [Thread-2 (]: 7 of 13 START sql view model DESCHEMA_reporting.customer_rank .................. [RUN]
[0m18:41:29.209402 [info ] [Thread-3 (]: 8 of 13 START sql view model DESCHEMA_reporting.grr ............................ [RUN]
[0m18:41:29.219099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_rank)
[0m18:41:29.220098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.grr)
[0m18:41:29.221097 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_rank
[0m18:41:29.222096 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (compile): 18:41:29.205386 => 18:41:29.222096
[0m18:41:29.222876 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.grr
[0m18:41:29.228981 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m18:41:29.228981 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (compile): 18:41:29.209402 => 18:41:29.228981
[0m18:41:29.230706 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.cross_sell
[0m18:41:29.234714 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.grr"
[0m18:41:29.236935 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.customer_churn
[0m18:41:29.242964 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.cross_sell"
[0m18:41:29.248128 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.customer_churn"
[0m18:41:29.250093 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (compile): 18:41:29.222876 => 18:41:29.249128
[0m18:41:29.251335 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.grr (compile): 18:41:29.230706 => 18:41:29.251335
[0m18:41:29.253345 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_rank
[0m18:41:29.253345 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.grr
[0m18:41:29.253345 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.customer_rank"
[0m18:41:29.253345 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.customer_churn"
[0m18:41:29.267364 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.cross_sell"
[0m18:41:29.253345 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.grr"
[0m18:41:29.268139 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_churn
  
   as (
    WITH individual_month AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', PAYMENT_MONTH) AS transaction_month
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
),
 
max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM individual_month
),
 
customer_churn_status AS (
    SELECT
        i.customer_id,
        MAX(i.transaction_month) AS max_month,
        CASE
            WHEN MAX(i.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            WHEN MIN(i.transaction_month) >= DATEADD('month', -3, m.latest_month) THEN 'New'
            ELSE 'Active'
        END AS churn_status
    FROM individual_month i
    CROSS JOIN max_month m
    GROUP BY i.customer_id, m.latest_month
)
 
SELECT
    churn_status,
    COUNT(*) AS customer_count
FROM customer_churn_status
GROUP BY churn_status
  );
[0m18:41:29.268139 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.cross_sell"} */
create or replace   view NEWDB.DESCHEMA_reporting.cross_sell
  
   as (
    WITH cross_sell_analysis AS (
    SELECT
        c.customer_id,
        c.customer_name,
        COUNT( distinct h.product_id) AS num_products_bought
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook h JOIN
        NEWDB.DESCHEMA_staging.stg_cust c on h.customer_id = c.customer_id
    
    WHERE h.revenue_type=1
    
    GROUP BY
        c.customer_id,
        c.customer_name 
        )
 
SELECT
    *
FROM
   cross_sell_analysis
ORDER BY
    num_products_bought desc
LIMIT 10
  );
[0m18:41:29.268139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:29.268139 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.customer_rank"
[0m18:41:29.268139 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:41:29.268139 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.customer_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.customer_rank
  
   as (
    WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_cust c
        ON t.customer_id = c.customer_id
    GROUP BY t.customer_id, c.customer_name
)
SELECT
    customer_id,
    customer_name,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
  );
[0m18:41:29.277800 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.grr"
[0m18:41:29.277800 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:29.277800 [debug] [Thread-3 (]: On model.data_engineering_project.grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.grr"} */
create or replace   view NEWDB.DESCHEMA_reporting.grr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month <= DATEADD(MONTH, -12, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:41:29.283180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:29.716017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:29.732109 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.customer_churn (execute): 18:41:29.244972 => 18:41:29.732109
[0m18:41:29.732109 [debug] [Thread-1 (]: On model.data_engineering_project.customer_churn: Close
[0m18:41:29.747917 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:29.753958 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.cross_sell (execute): 18:41:29.236935 => 18:41:29.751945
[0m18:41:29.753958 [debug] [Thread-4 (]: On model.data_engineering_project.cross_sell: Close
[0m18:41:29.779482 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:29.779482 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.grr (execute): 18:41:29.253345 => 18:41:29.779482
[0m18:41:29.779482 [debug] [Thread-3 (]: On model.data_engineering_project.grr: Close
[0m18:41:29.779482 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:29.795295 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_rank (execute): 18:41:29.253345 => 18:41:29.779482
[0m18:41:29.797303 [debug] [Thread-2 (]: On model.data_engineering_project.customer_rank: Close
[0m18:41:29.811421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1BDC1D0>]}
[0m18:41:29.827366 [info ] [Thread-1 (]: 6 of 13 OK created sql view model DESCHEMA_reporting.customer_churn ............ [[32mSUCCESS 1[0m in 0.60s]
[0m18:41:29.827366 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.customer_churn
[0m18:41:29.827366 [debug] [Thread-1 (]: Began running node model.data_engineering_project.new_logos
[0m18:41:29.827366 [info ] [Thread-1 (]: 9 of 13 START sql view model DESCHEMA_reporting.new_logos ...................... [RUN]
[0m18:41:29.827366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.new_logos)
[0m18:41:29.827366 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.new_logos
[0m18:41:29.827366 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m18:41:29.827366 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.new_logos (compile): 18:41:29.827366 => 18:41:29.827366
[0m18:41:29.827366 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.new_logos
[0m18:41:29.843034 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.new_logos"
[0m18:41:29.851449 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.new_logos"
[0m18:41:29.852084 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1F4A540>]}
[0m18:41:29.853261 [debug] [Thread-1 (]: On model.data_engineering_project.new_logos: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.new_logos"} */
create or replace   view NEWDB.DESCHEMA_reporting.new_logos
  
   as (
    WITH newlogo AS  (
    SELECT
       customer_id,
       DATE_TRUNC('YEAR', MIN(PAYMENT_MONTH)) AS FISCAL_YEAR_START
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY customer_id
)
SELECT
    COUNT(DISTINCT customer_id) AS customer_count,
    FISCAL_YEAR_START
FROM newlogo
GROUP BY FISCAL_YEAR_START
ORDER BY FISCAL_YEAR_START
  );
[0m18:41:29.855271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:29.854914 [info ] [Thread-4 (]: 5 of 13 OK created sql view model DESCHEMA_reporting.cross_sell ................ [[32mSUCCESS 1[0m in 0.65s]
[0m18:41:29.857447 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.cross_sell
[0m18:41:29.857447 [debug] [Thread-4 (]: Began running node model.data_engineering_project.nrr
[0m18:41:29.861034 [info ] [Thread-4 (]: 10 of 13 START sql view model DESCHEMA_reporting.nrr ........................... [RUN]
[0m18:41:29.862044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.nrr)
[0m18:41:29.862044 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.nrr
[0m18:41:29.868133 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.nrr"
[0m18:41:29.871181 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.nrr (compile): 18:41:29.862044 => 18:41:29.871181
[0m18:41:29.873196 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.nrr
[0m18:41:29.877223 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_engineering_project.nrr"
[0m18:41:29.881243 [debug] [Thread-4 (]: Using snowflake connection "model.data_engineering_project.nrr"
[0m18:41:29.881243 [debug] [Thread-4 (]: On model.data_engineering_project.nrr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.nrr"} */
create or replace   view NEWDB.DESCHEMA_reporting.nrr
  
   as (
    WITH customer_transactions AS (
    SELECT
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE payment_month <= DATEADD(MONTH, -12, (SELECT MAX(payment_month) FROM NEWDB.DESCHEMA_staging.stg_hotelbook))
    GROUP BY 1, 2
),
 
previous_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue
    FROM customer_transactions
),
 
expansion_contraction AS (
    SELECT
        customer_id,
        payment_month,
        prev_revenue,
        total_revenue,
        CASE
            WHEN total_revenue > prev_revenue THEN total_revenue - prev_revenue
            ELSE 0
        END AS expansion_revenue,
        CASE
            WHEN total_revenue < prev_revenue THEN prev_revenue - total_revenue
            ELSE 0
        END AS contraction_revenue
    FROM previous_revenue
)
 
SELECT
    customer_id,
    payment_month,
    total_revenue AS current_revenue,
    prev_revenue AS previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN prev_revenue = 0 THEN NULL  
        ELSE (total_revenue + expansion_revenue - contraction_revenue) / prev_revenue
    END AS nrr
FROM expansion_contraction
  );
[0m18:41:29.883252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:41:29.891893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1DE8C80>]}
[0m18:41:29.892889 [info ] [Thread-3 (]: 8 of 13 OK created sql view model DESCHEMA_reporting.grr ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m18:41:29.894890 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.grr
[0m18:41:29.894890 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_churn
[0m18:41:29.895890 [info ] [Thread-3 (]: 11 of 13 START sql view model DESCHEMA_reporting.product_churn ................. [RUN]
[0m18:41:29.897488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.grr, now model.data_engineering_project.product_churn)
[0m18:41:29.897488 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_churn
[0m18:41:29.902422 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m18:41:29.906160 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (compile): 18:41:29.899490 => 18:41:29.906160
[0m18:41:29.908227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1C44F20>]}
[0m18:41:29.908227 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_churn
[0m18:41:29.923981 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_engineering_project.product_churn"
[0m18:41:29.912289 [info ] [Thread-2 (]: 7 of 13 OK created sql view model DESCHEMA_reporting.customer_rank ............. [[32mSUCCESS 1[0m in 0.69s]
[0m18:41:29.925983 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_rank
[0m18:41:29.926981 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_rank
[0m18:41:29.927980 [info ] [Thread-2 (]: 12 of 13 START sql view model DESCHEMA_reporting.product_rank .................. [RUN]
[0m18:41:29.928984 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_rank, now model.data_engineering_project.product_rank)
[0m18:41:29.929988 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_rank
[0m18:41:29.933979 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m18:41:29.937989 [debug] [Thread-3 (]: Using snowflake connection "model.data_engineering_project.product_churn"
[0m18:41:29.939989 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_churn"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_churn
  
   as (
    WITH product_churn AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        MAX(payment_month) OVER(PARTITION BY customer_id) AS max_payment_date_of_customer
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    WHERE
        payment_month IS NOT NULL
    GROUP BY
        customer_id, payment_month, product_id
),
churned_or_not AS (
    SELECT
        customer_id,
        payment_month,
        product_id,
        (CASE
            WHEN
                payment_month IS NOT NULL
                AND
                DATEDIFF(MONTH, MAX(payment_month),max_payment_date_of_customer) > 12
            THEN 1
            ELSE 0
        END) AS churned
    FROM
        product_churn
    GROUP BY
        customer_id,
        payment_month,
        product_id,
        max_payment_date_of_customer
 
),
highest_product_churn AS (
    SELECT
        PRODUCT_ID,
        COUNT(churned) AS num_products_churned
    FROM
        churned_or_not
    WHERE
        churned = 1
    GROUP BY
        PRODUCT_ID
)
 
SELECT
    *
FROM
    highest_product_churn
ORDER BY
    num_products_churned
DESC
  );
[0m18:41:29.940981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:41:29.941982 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (compile): 18:41:29.929988 => 18:41:29.940981
[0m18:41:29.943980 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_rank
[0m18:41:29.947979 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_engineering_project.product_rank"
[0m18:41:29.950981 [debug] [Thread-2 (]: Using snowflake connection "model.data_engineering_project.product_rank"
[0m18:41:29.951983 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.product_rank"} */
create or replace   view NEWDB.DESCHEMA_reporting.product_rank
  
   as (
    WITH product_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        p.product_family,
        p.product_sub_family
    FROM NEWDB.DESCHEMA_staging.stg_hotelbook t
    JOIN NEWDB.DESCHEMA_staging.stg_prod p
        ON t.product_id = p.product_id
    GROUP BY t.product_id, p.product_family, p.product_sub_family
)
SELECT
    product_id,
    total_revenue,
    DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank,
    product_family,
    product_sub_family
FROM product_revenue
  );
[0m18:41:29.954074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:30.298228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:30.298228 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.new_logos (execute): 18:41:29.827366 => 18:41:30.298228
[0m18:41:30.298228 [debug] [Thread-1 (]: On model.data_engineering_project.new_logos: Close
[0m18:41:30.360269 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:30.360269 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (execute): 18:41:29.912289 => 18:41:30.360269
[0m18:41:30.360269 [debug] [Thread-3 (]: On model.data_engineering_project.product_churn: Close
[0m18:41:30.392881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1BDCCB0>]}
[0m18:41:30.392881 [info ] [Thread-1 (]: 9 of 13 OK created sql view model DESCHEMA_reporting.new_logos ................. [[32mSUCCESS 1[0m in 0.57s]
[0m18:41:30.392881 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.new_logos
[0m18:41:30.398269 [debug] [Thread-1 (]: Began running node model.data_engineering_project.revenueloss
[0m18:41:30.398269 [info ] [Thread-1 (]: 13 of 13 START sql view model DESCHEMA_reporting.revenueloss ................... [RUN]
[0m18:41:30.398269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.revenueloss)
[0m18:41:30.398269 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.revenueloss
[0m18:41:30.398269 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.revenueloss"
[0m18:41:30.398269 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:30.412442 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.nrr (execute): 18:41:29.873196 => 18:41:30.411399
[0m18:41:30.412442 [debug] [Thread-4 (]: On model.data_engineering_project.nrr: Close
[0m18:41:30.414073 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.revenueloss (compile): 18:41:30.398269 => 18:41:30.413406
[0m18:41:30.415093 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.revenueloss
[0m18:41:30.423099 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:41:30.422559 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_engineering_project.revenueloss"
[0m18:41:30.423099 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (execute): 18:41:29.943980 => 18:41:30.423099
[0m18:41:30.423099 [debug] [Thread-2 (]: On model.data_engineering_project.product_rank: Close
[0m18:41:30.423099 [debug] [Thread-1 (]: Using snowflake connection "model.data_engineering_project.revenueloss"
[0m18:41:30.423099 [debug] [Thread-1 (]: On model.data_engineering_project.revenueloss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "node_id": "model.data_engineering_project.revenueloss"} */
create or replace   view NEWDB.DESCHEMA_reporting.revenueloss
  
   as (
    WITH monthly_revenue AS (
    SELECT
        product_id,
        YEAR(payment_month) AS year,
        MONTH(payment_month) AS month,
        ROUND(SUM(revenue), 2) AS current_revenue
    FROM
        NEWDB.DESCHEMA_staging.stg_hotelbook
    GROUP BY
        product_id, year, month
    ORDER BY
        product_id, year, month
),
 
revenue_comparison AS (
    SELECT
        *,
        LAG(current_revenue, 1) OVER (PARTITION BY product_id ORDER BY year, month) AS previous_revenue
    FROM
        monthly_revenue
)
SELECT
    *,
    CASE
        WHEN previous_revenue > current_revenue THEN 'contraction'
        ELSE 'expansion'
    END AS revenue_trend,
    CASE
        WHEN previous_revenue > current_revenue THEN 'LOSS'
        ELSE 'PROFIT'
    END AS profit_or_loss,
    CASE
        WHEN previous_revenue > current_revenue THEN previous_revenue - current_revenue
        ELSE current_revenue - previous_revenue
    END AS amount
FROM
    revenue_comparison
  );
[0m18:41:30.435138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:30.455242 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE3065130>]}
[0m18:41:30.456241 [info ] [Thread-3 (]: 11 of 13 OK created sql view model DESCHEMA_reporting.product_churn ............ [[32mSUCCESS 1[0m in 0.56s]
[0m18:41:30.457209 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_churn
[0m18:41:30.503911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDE243260>]}
[0m18:41:30.503911 [info ] [Thread-4 (]: 10 of 13 OK created sql view model DESCHEMA_reporting.nrr ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m18:41:30.503911 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.nrr
[0m18:41:30.520854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE3064350>]}
[0m18:41:30.521858 [info ] [Thread-2 (]: 12 of 13 OK created sql view model DESCHEMA_reporting.product_rank ............. [[32mSUCCESS 1[0m in 0.59s]
[0m18:41:30.522828 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_rank
[0m18:41:30.942929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:41:30.946464 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.revenueloss (execute): 18:41:30.415093 => 18:41:30.946464
[0m18:41:30.946464 [debug] [Thread-1 (]: On model.data_engineering_project.revenueloss: Close
[0m18:41:31.040125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08de97ec-2b52-44c1-9282-f60a8faae2e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1CC52E0>]}
[0m18:41:31.042149 [info ] [Thread-1 (]: 13 of 13 OK created sql view model DESCHEMA_reporting.revenueloss .............. [[32mSUCCESS 1[0m in 0.64s]
[0m18:41:31.044173 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.revenueloss
[0m18:41:31.049915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:31.049915 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:41:31.049915 [debug] [MainThread]: Connection 'list_NEWDB' was properly closed.
[0m18:41:31.049915 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m18:41:31.049915 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m18:41:31.049915 [debug] [MainThread]: Connection 'model.data_engineering_project.revenueloss' was properly closed.
[0m18:41:31.059609 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m18:41:31.059609 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m18:41:31.059609 [debug] [MainThread]: Connection 'model.data_engineering_project.nrr' was properly closed.
[0m18:41:31.059609 [info ] [MainThread]: 
[0m18:41:31.061617 [info ] [MainThread]: Finished running 13 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m18:41:31.065683 [debug] [MainThread]: Command end result
[0m18:41:31.080654 [info ] [MainThread]: 
[0m18:41:31.080654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:31.080654 [info ] [MainThread]: 
[0m18:41:31.080654 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m18:41:31.087737 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:31.086773 after 7.48 seconds
[0m18:41:31.087737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1196540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FE1D08C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDFC31490>]}
[0m18:41:31.087737 [debug] [MainThread]: Flushing usage events
[0m18:43:29.167847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FAC96FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FAC96D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FAC95400>]}


============================== 18:43:29.173889 | 45e3a54a-5a40-4c5d-b16a-280aaa088b0c ==============================
[0m18:43:29.173889 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:43:29.174855 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:43:29.722771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45e3a54a-5a40-4c5d-b16a-280aaa088b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB34F590>]}
[0m18:43:29.832657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45e3a54a-5a40-4c5d-b16a-280aaa088b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB28ECC0>]}
[0m18:43:29.832657 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:43:29.852369 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:43:29.987740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:29.987740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:30.003309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45e3a54a-5a40-4c5d-b16a-280aaa088b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB34DD30>]}
[0m18:43:30.003309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45e3a54a-5a40-4c5d-b16a-280aaa088b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB564A10>]}
[0m18:43:30.003309 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:43:30.003309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e3a54a-5a40-4c5d-b16a-280aaa088b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB564920>]}
[0m18:43:30.003309 [info ] [MainThread]: 
[0m18:43:30.003309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:43:30.014980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_reporting'
[0m18:43:30.020861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NEWDB_DESCHEMA_staging'
[0m18:43:30.038253 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_staging"
[0m18:43:30.042898 [debug] [ThreadPool]: Using snowflake connection "list_NEWDB_DESCHEMA_reporting"
[0m18:43:30.043940 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_staging"} */
show terse objects in NEWDB.DESCHEMA_staging limit 10000
[0m18:43:30.043940 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "list_NEWDB_DESCHEMA_reporting"} */
show terse objects in NEWDB.DESCHEMA_reporting limit 10000
[0m18:43:30.044943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:30.044943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:31.049413 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:43:31.051422 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_reporting: Close
[0m18:43:31.054939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:43:31.054939 [debug] [ThreadPool]: On list_NEWDB_DESCHEMA_staging: Close
[0m18:43:31.148758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45e3a54a-5a40-4c5d-b16a-280aaa088b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB7984D0>]}
[0m18:43:31.148758 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:31.148758 [info ] [MainThread]: 
[0m18:43:31.148758 [debug] [Thread-1 (]: Began running node model.data_engineering_project.stg_country
[0m18:43:31.148758 [debug] [Thread-2 (]: Began running node model.data_engineering_project.stg_cust
[0m18:43:31.148758 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_country'
[0m18:43:31.161708 [debug] [Thread-3 (]: Began running node model.data_engineering_project.stg_hotelbook
[0m18:43:31.161708 [debug] [Thread-4 (]: Began running node model.data_engineering_project.stg_prod
[0m18:43:31.163716 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_cust'
[0m18:43:31.163716 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.stg_country
[0m18:43:31.164724 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_hotelbook'
[0m18:43:31.166733 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_engineering_project.stg_prod'
[0m18:43:31.173099 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.stg_cust
[0m18:43:31.185965 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.stg_country"
[0m18:43:31.208046 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (compile): 18:43:31.175263 => 18:43:31.206032
[0m18:43:31.208046 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.stg_country
[0m18:43:31.210059 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.stg_country (execute): 18:43:31.210059 => 18:43:31.210059
[0m18:43:31.200308 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.stg_hotelbook
[0m18:43:31.212071 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.stg_country
[0m18:43:31.200308 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.stg_prod
[0m18:43:31.206032 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.stg_cust"
[0m18:43:31.234703 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.stg_hotelbook"
[0m18:43:31.241356 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.stg_prod"
[0m18:43:31.243369 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (compile): 18:43:31.200308 => 18:43:31.243369
[0m18:43:31.245378 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (compile): 18:43:31.232695 => 18:43:31.243369
[0m18:43:31.245378 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.stg_cust
[0m18:43:31.245378 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (compile): 18:43:31.236711 => 18:43:31.245378
[0m18:43:31.247385 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.stg_hotelbook
[0m18:43:31.247385 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.stg_cust (execute): 18:43:31.247385 => 18:43:31.247385
[0m18:43:31.247385 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.stg_prod
[0m18:43:31.249394 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.stg_hotelbook (execute): 18:43:31.249394 => 18:43:31.249394
[0m18:43:31.249394 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.stg_cust
[0m18:43:31.251405 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.stg_prod (execute): 18:43:31.251405 => 18:43:31.251405
[0m18:43:31.255413 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.stg_prod
[0m18:43:31.253414 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.stg_hotelbook
[0m18:43:31.257422 [debug] [Thread-1 (]: Began running node model.data_engineering_project.cross_sell
[0m18:43:31.258421 [debug] [Thread-2 (]: Began running node model.data_engineering_project.customer_churn
[0m18:43:31.258421 [debug] [Thread-4 (]: Began running node model.data_engineering_project.customer_rank
[0m18:43:31.259422 [debug] [Thread-3 (]: Began running node model.data_engineering_project.grr
[0m18:43:31.260422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_country, now model.data_engineering_project.cross_sell)
[0m18:43:31.261423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_cust, now model.data_engineering_project.customer_churn)
[0m18:43:31.262423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_prod, now model.data_engineering_project.customer_rank)
[0m18:43:31.264422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.stg_hotelbook, now model.data_engineering_project.grr)
[0m18:43:31.264422 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.cross_sell
[0m18:43:31.265423 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.customer_churn
[0m18:43:31.266423 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.customer_rank
[0m18:43:31.266423 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.grr
[0m18:43:31.271423 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.cross_sell"
[0m18:43:31.287543 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.customer_churn"
[0m18:43:31.292057 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.customer_rank"
[0m18:43:31.296057 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.grr"
[0m18:43:31.298024 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (compile): 18:43:31.267456 => 18:43:31.297060
[0m18:43:31.298024 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.cross_sell
[0m18:43:31.299057 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.cross_sell (execute): 18:43:31.299057 => 18:43:31.299057
[0m18:43:31.301057 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.cross_sell
[0m18:43:31.301057 [debug] [Thread-1 (]: Began running node model.data_engineering_project.new_logos
[0m18:43:31.302058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.cross_sell, now model.data_engineering_project.new_logos)
[0m18:43:31.303060 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.new_logos
[0m18:43:31.305516 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.new_logos"
[0m18:43:31.305516 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (compile): 18:43:31.288548 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.grr (compile): 18:43:31.293057 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.customer_rank
[0m18:43:31.305516 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (compile): 18:43:31.283545 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.grr
[0m18:43:31.305516 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.customer_rank (execute): 18:43:31.305516 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.new_logos (compile): 18:43:31.304023 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.customer_churn
[0m18:43:31.305516 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.grr (execute): 18:43:31.305516 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.customer_rank
[0m18:43:31.305516 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.new_logos
[0m18:43:31.305516 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.customer_churn (execute): 18:43:31.305516 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.grr
[0m18:43:31.305516 [debug] [Thread-4 (]: Began running node model.data_engineering_project.nrr
[0m18:43:31.305516 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.new_logos (execute): 18:43:31.305516 => 18:43:31.305516
[0m18:43:31.305516 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.customer_churn
[0m18:43:31.320828 [debug] [Thread-3 (]: Began running node model.data_engineering_project.product_churn
[0m18:43:31.320828 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_rank, now model.data_engineering_project.nrr)
[0m18:43:31.320828 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.new_logos
[0m18:43:31.320828 [debug] [Thread-2 (]: Began running node model.data_engineering_project.product_rank
[0m18:43:31.320828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.grr, now model.data_engineering_project.product_churn)
[0m18:43:31.320828 [debug] [Thread-4 (]: Began compiling node model.data_engineering_project.nrr
[0m18:43:31.320828 [debug] [Thread-1 (]: Began running node model.data_engineering_project.revenueloss
[0m18:43:31.320828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.customer_churn, now model.data_engineering_project.product_rank)
[0m18:43:31.320828 [debug] [Thread-3 (]: Began compiling node model.data_engineering_project.product_churn
[0m18:43:31.329995 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_engineering_project.nrr"
[0m18:43:31.332003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_engineering_project.new_logos, now model.data_engineering_project.revenueloss)
[0m18:43:31.332003 [debug] [Thread-2 (]: Began compiling node model.data_engineering_project.product_rank
[0m18:43:31.332003 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_engineering_project.product_churn"
[0m18:43:31.336884 [debug] [Thread-1 (]: Began compiling node model.data_engineering_project.revenueloss
[0m18:43:31.339687 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_engineering_project.product_rank"
[0m18:43:31.341696 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_engineering_project.revenueloss"
[0m18:43:31.341696 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.nrr (compile): 18:43:31.320828 => 18:43:31.341696
[0m18:43:31.341696 [debug] [Thread-4 (]: Began executing node model.data_engineering_project.nrr
[0m18:43:31.341696 [debug] [Thread-4 (]: Timing info for model.data_engineering_project.nrr (execute): 18:43:31.341696 => 18:43:31.341696
[0m18:43:31.341696 [debug] [Thread-4 (]: Finished running node model.data_engineering_project.nrr
[0m18:43:31.349296 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (compile): 18:43:31.336884 => 18:43:31.349296
[0m18:43:31.349296 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.revenueloss (compile): 18:43:31.341696 => 18:43:31.349296
[0m18:43:31.349296 [debug] [Thread-2 (]: Began executing node model.data_engineering_project.product_rank
[0m18:43:31.349296 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (compile): 18:43:31.332003 => 18:43:31.349296
[0m18:43:31.352680 [debug] [Thread-1 (]: Began executing node model.data_engineering_project.revenueloss
[0m18:43:31.352680 [debug] [Thread-2 (]: Timing info for model.data_engineering_project.product_rank (execute): 18:43:31.352680 => 18:43:31.352680
[0m18:43:31.352680 [debug] [Thread-3 (]: Began executing node model.data_engineering_project.product_churn
[0m18:43:31.352680 [debug] [Thread-1 (]: Timing info for model.data_engineering_project.revenueloss (execute): 18:43:31.352680 => 18:43:31.352680
[0m18:43:31.352680 [debug] [Thread-2 (]: Finished running node model.data_engineering_project.product_rank
[0m18:43:31.352680 [debug] [Thread-3 (]: Timing info for model.data_engineering_project.product_churn (execute): 18:43:31.352680 => 18:43:31.352680
[0m18:43:31.352680 [debug] [Thread-1 (]: Finished running node model.data_engineering_project.revenueloss
[0m18:43:31.352680 [debug] [Thread-3 (]: Finished running node model.data_engineering_project.product_churn
[0m18:43:31.352680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_reporting' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Connection 'list_NEWDB_DESCHEMA_staging' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Connection 'model.data_engineering_project.revenueloss' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Connection 'model.data_engineering_project.product_rank' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Connection 'model.data_engineering_project.product_churn' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Connection 'model.data_engineering_project.nrr' was properly closed.
[0m18:43:31.352680 [debug] [MainThread]: Command end result
[0m18:43:31.744309 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:43:31.744309 [info ] [MainThread]: Building catalog
[0m18:43:31.760102 [debug] [ThreadPool]: Acquiring new snowflake connection 'newdb.information_schema'
[0m18:43:31.775957 [debug] [ThreadPool]: Acquiring new snowflake connection 'NEWDB.information_schema'
[0m18:43:31.780988 [debug] [ThreadPool]: Using snowflake connection "newdb.information_schema"
[0m18:43:31.791617 [debug] [ThreadPool]: Using snowflake connection "NEWDB.information_schema"
[0m18:43:31.791617 [debug] [ThreadPool]: On newdb.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "newdb.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from newdb.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('country')
                )
             or 
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('cust')
                )
             or 
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('hotelbook')
                )
             or 
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('prod')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from newdb.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('country')
                )
             or 
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('cust')
                )
             or 
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('hotelbook')
                )
             or 
                (
                    upper("table_schema") = upper('deschema')
                    and upper("table_name") = upper('prod')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:43:31.791617 [debug] [ThreadPool]: On NEWDB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "data_engineering_project", "target_name": "dev", "connection_name": "NEWDB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from NEWDB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('grr')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('customer_churn')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('nrr')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('product_rank')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('cross_sell')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('new_logos')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_cust')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_hotelbook')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('customer_rank')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_prod')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('product_churn')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_country')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('revenueloss')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from NEWDB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('grr')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('customer_churn')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('nrr')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('product_rank')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('cross_sell')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('new_logos')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_cust')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_hotelbook')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('customer_rank')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_prod')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('product_churn')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_staging')
                    and upper("table_name") = upper('stg_country')
                )
             or 
                (
                    upper("table_schema") = upper('DESCHEMA_reporting')
                    and upper("table_name") = upper('revenueloss')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:43:31.791617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:31.791617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:35.074843 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 3.0 seconds
[0m18:43:35.102878 [debug] [ThreadPool]: On newdb.information_schema: Close
[0m18:43:36.015571 [debug] [ThreadPool]: SQL status: SUCCESS 66 in 4.0 seconds
[0m18:43:36.031309 [debug] [ThreadPool]: On NEWDB.information_schema: Close
[0m18:43:36.213386 [info ] [MainThread]: Catalog written to C:\Users\ChandravelMK\Desktop\dbt_training\data_engineering_project\target\catalog.json
[0m18:43:36.213386 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:43:36.213386 after 7.13 seconds
[0m18:43:36.213386 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:43:36.213386 [debug] [MainThread]: Connection 'newdb.information_schema' was properly closed.
[0m18:43:36.213386 [debug] [MainThread]: Connection 'NEWDB.information_schema' was properly closed.
[0m18:43:36.213386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FA943620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FB81C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136FA973860>]}
[0m18:43:36.213386 [debug] [MainThread]: Flushing usage events
[0m18:43:55.379522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA1B05DC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA1B05DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA1B05E030>]}


============================== 18:43:55.390573 | 9977975c-8173-4a2d-9b20-17f95d8e7156 ==============================
[0m18:43:55.390573 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:43:55.390573 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\ChandravelMK\\Desktop\\dbt_training\\data_engineering_project\\logs', 'profiles_dir': 'C:\\Users\\ChandravelMK\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:43:55.923157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9977975c-8173-4a2d-9b20-17f95d8e7156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA1B73CB00>]}
[0m18:43:56.050088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9977975c-8173-4a2d-9b20-17f95d8e7156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA1B0D8560>]}
[0m19:03:31.999310 [error] [MainThread]: Encountered an error:

[0m19:03:32.409827 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "c:\Users\ChandravelMK\Desktop\dbt_training\.venv\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:03:32.434813 [debug] [MainThread]: Command `dbt docs serve` failed at 19:03:32.434813 after 1177.13 seconds
[0m19:03:32.445165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA19B73AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA19E2B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA1B05DDC0>]}
[0m19:03:32.445165 [debug] [MainThread]: Flushing usage events
